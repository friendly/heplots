<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Box's M-test — boxM • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Box's M-test — boxM"><meta property="og:description" content="boxM performs the Box's (1949) M-test for homogeneity of covariance matrices
obtained from multivariate normal data according to one or more classification
factors. The test compares the product of the log determinants of the
separate covariance matrices to the log determinant of the pooled
covariance matrix, analogous to a likelihood ratio test.
The test statistic uses a chi-square approximation."><meta property="og:image" content="http://friendly.github.io/heplots/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">heplots</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/friendly/heplots/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Box's M-test</h1>
    
    <div class="hidden name"><code>boxM.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>boxM</code> performs the Box's (1949) M-test for homogeneity of covariance matrices
obtained from multivariate normal data according to one or more classification
factors. The test compares the product of the log determinants of the
separate covariance matrices to the log determinant of the pooled
covariance matrix, analogous to a likelihood ratio test.
The test statistic uses a chi-square approximation.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for formula</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lm</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for default</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">group</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for boxM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">object</span>, </span>
<span>     digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span>,</span>
<span>     cov<span class="op">=</span><span class="cn">FALSE</span>, quiet<span class="op">=</span><span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>Y</dt>
<dd><p>The response variable matrix for the default method, or a <code>"mlm"</code> or <code>"formula"</code> object
  for a multivariate linear model.
  If <code>Y</code> is a linear-model object or a formula, the variables on the right-hand-side of the model must all be factors 
  and must be completely crossed, e.g., <code>A:B</code></p></dd>

  <dt>data</dt>
<dd><p>a numeric data.frame or matrix containing <em>n</em> observations of <em>p</em> variables;
	it is expected that <em>n &gt; p</em>.</p></dd>

  <dt>group</dt>
<dd><p>a factor defining groups, or a vector of length <em>n</em> doing the same.</p></dd>

  <dt>object</dt>
<dd><p>a <code>"boxM"</code> object for the <code>summary</code> method</p></dd>

  <dt>digits</dt>
<dd><p>number of digits to print for the <code>summary</code> method</p></dd>

  <dt>cov</dt>
<dd><p>logical; if <code>TRUE</code> the covariance matrices are printed.</p></dd>

  <dt>quiet</dt>
<dd><p>logical; if <code>TRUE</code> printing from the <code>summary</code> is suppressed</p></dd>

  <dt>...</dt>
<dd><p>Arguments passed down to methods.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list with class <code>c("htest", "boxM")</code> containing the following components:</p>
<dl><dt>statistic </dt>
<dd><p>an approximated value of the chi-square distribution.</p></dd>

  <dt>parameter </dt>
<dd><p>the degrees of freedom related of the test statistic in this case that it follows a Chi-square distribution.</p></dd>

  <dt>p.value </dt>
<dd><p>the p-value of the test.</p></dd>

  <dt>cov </dt>
<dd><p>a list containing the within covariance matrix for each level of <code>grouping</code>.</p></dd>

  <dt>pooled </dt>
<dd><p>the pooled covariance matrix.</p></dd>

  <dt>logDet </dt>
<dd><p>a vector containing the natural logarithm of each matrix in <code>cov</code>, followed by the value for the pooled 
  covariance matrix</p></dd>

  <dt>means</dt>
<dd><p>a matrix of the means for all groups, followed by the grand means</p></dd>

  <dt>df</dt>
<dd><p>a vector of the degrees of freedom for all groups, followed by that for the pooled covariance matrix</p></dd>

  <dt>data.name </dt>
<dd><p>a character string giving the names of the data.</p></dd>

  <dt>method </dt>
<dd><p>the character string "Box's M-test for Homogeneity of Covariance Matrices".</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>As an object of class <code>"htest"</code>, the statistical test is printed normally by default.
As an object of class <code>"boxM"</code>, a few methods are available.</p>
<p>There is no general provision as yet for handling missing data.  Missing data are simply
removed, with a warning.</p>
<p>As well, the computation assumes that the covariance matrix for each group is non-singular,
so that \(log det(S_i)\) can be calculated for each group.
At the minimum, this requires that \(n &gt; p\) for each group.</p>
<p>Box's M test for a multivariate linear model highly sensitive to departures from multivariate normality,
just as the analogous univariate test.  It is also affected adversely by 
unbalanced designs.  Some people recommend to ignore the result unless it is very highly significant,
e.g., p &lt; .0001 or worse.</p>
<p>The <code>summary</code> method prints a variety of additional statistics based on the eigenvalues of
the covariance matrices.  These are returned invisibly, as a list containing the following
components:</p><ul><li><p><code>logDet</code> - log determinants</p></li>
<li><p><code>eigs</code> - eigenvalues of the covariance matrices</p></li>
<li><p><code>eigstats</code> - statistics computed on the eigenvalues for each covariance matrix:<br><code>product</code>:  the product of eigenvalues, \(\prod{\lambda_i}\);<br><code>sum</code>:  the sum of eigenvalues, \(\sum{\lambda_i}\);<br><code>precision</code>: the average precision of eigenvalues, \(1/\sum(1/\lambda_i)\);<br><code>max</code>: the maximum eigenvalue, \(\lambda_1\)</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Box, G. E. P. (1949). A general distribution theory for a class of likelihood criteria. <em>Biometrika</em>, 36, 317-346.</p>
<p>Morrison, D.F. (1976) <em>Multivariate Statistical Methods</em>.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>The default method was taken from the <span class="pkg">biotools</span> package, 
Anderson Rodrigo da Silva <a href="mailto:anderson.agro@hotmail.com">anderson.agro@hotmail.com</a></p>
<p>Generalized by Michael Friendly and John Fox</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/car/man/leveneTest.html" class="external-link">leveneTest</a></code> carries out homogeneity of variance tests for
univariate models with better statistical properties.</p>
<p><code><a href="plot.boxM.html">plot.boxM</a></code>, a simple plot of the log determinants</p>
<p><code><a href="covEllipses.html">covEllipses</a></code> plots covariance ellipses in variable space for several groups.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default method</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">boxM</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">[</span>, <span class="st">"Species"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box's M-test for Homogeneity of Covariance Matrices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  iris[, 1:4]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 140.94, df = 20, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary for Box's M-test of Equality of Covariance Matrices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq:	 140.943 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df:	 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value: &lt; 2.2e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log of Covariance determinants:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     setosa versicolor  virginica     pooled </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -13.067360 -10.874325  -8.927058  -9.958539 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        setosa  versicolor  virginica     pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.236455690 0.487873944 0.69525484 0.44356592</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.036918732 0.072384096 0.10655123 0.08618331</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.026796399 0.054776085 0.05229543 0.05535235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.009033261 0.009790365 0.03426585 0.02236372</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistics based on eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 setosa   versicolor    virginica       pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> product   2.113088e-06 1.893828e-05 0.0001327479 4.732183e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum       3.092041e-01 6.248245e-01 0.8883673469 6.074653e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> precision 5.576122e-03 7.338788e-03 0.0169121236 1.304819e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max       2.364557e-01 4.878739e-01 0.6952548382 4.435659e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize (what is done in the plot method) </span></span></span>
<span class="r-in"><span><span class="va">dets</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">logDet</span></span></span>
<span class="r-in"><span><span class="va">ng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">logDet</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html" class="external-link">dotchart</a></span><span class="op">(</span><span class="va">dets</span>, xlab <span class="op">=</span> <span class="st">"log determinant"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dets</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,  </span></span>
<span class="r-in"><span>  cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="va">ng</span><span class="op">)</span>, <span class="fl">2.5</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>  pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">16</span>, <span class="va">ng</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="va">ng</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="boxM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula method</span></span></span>
<span class="r-in"><span><span class="fu">boxM</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="va">Species</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box's M-test for Homogeneity of Covariance Matrices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 140.94, df = 20, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Skulls dat</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># lm method</span></span></span>
<span class="r-in"><span><span class="va">skulls.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mb</span>, <span class="va">bh</span>, <span class="va">bl</span>, <span class="va">nh</span><span class="op">)</span> <span class="op">~</span> <span class="va">epoch</span>, data<span class="op">=</span><span class="va">Skulls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">boxM</span><span class="op">(</span><span class="va">skulls.mod</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	Box's M-test for Homogeneity of Covariance Matrices</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 45.667, df = 40, p-value = 0.2483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

