<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Box's M-test for Homogeneity of Covariance Matrices — boxM • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Box's M-test for Homogeneity of Covariance Matrices — boxM"><meta name="description" content="boxM() performs the Box's (1949) M-test for homogeneity of covariance
matrices obtained from multivariate normal data according to one or more
classification factors. The test compares the product of the log
determinants of the separate covariance matrices to the log determinant of
the pooled covariance matrix, analogous to a likelihood ratio test. The test
statistic uses a chi-square approximation."><meta property="og:description" content="boxM() performs the Box's (1949) M-test for homogeneity of covariance
matrices obtained from multivariate normal data according to one or more
classification factors. The test compares the product of the log
determinants of the separate covariance matrices to the log determinant of
the pooled covariance matrix, analogous to a likelihood ratio test. The test
statistic uses a chi-square approximation."><meta property="og:image" content="https://friendly.github.io/heplots/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Data sets in the heplots package</a></li>
    <li><a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Robust.html">Robust Multivariate Linear Models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Box's M-test for Homogeneity of Covariance Matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/R/boxM.R" class="external-link"><code>R/boxM.R</code></a></small>
      <div class="d-none name"><code>boxM.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>boxM()</code> performs the Box's (1949) M-test for homogeneity of covariance
matrices obtained from multivariate normal data according to one or more
classification factors. The test compares the product of the log
determinants of the separate covariance matrices to the log determinant of
the pooled covariance matrix, analogous to a likelihood ratio test. The test
statistic uses a chi-square approximation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'formula'</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">data</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'lm'</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">boxM</span><span class="op">(</span><span class="va">Y</span>, <span class="va">group</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'boxM'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'boxM'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"digits"</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span>,</span>
<span>  cov <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>The response variable matrix for the default method, or a <code>"mlm"</code>
or <code>"formula"</code> object for a multivariate linear model. If <code>Y</code> is a
linear-model object or a formula, the variables on the right-hand-side of the
model must all be factors and must be completely crossed, e.g., <code>A:B</code></p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed down</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables in the model. Used only for
the formula method.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>A vector specifying the groups. Used only for the default method.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a class <code>"boxM"</code> object, for the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>"boxM"</code> object, result of a call to <code>boxM</code></p></dd>


<dt id="arg-digits">digits<a class="anchor" aria-label="anchor" href="#arg-digits"></a></dt>
<dd><p>Number of digits in printed output</p></dd>


<dt id="arg-cov">cov<a class="anchor" aria-label="anchor" href="#arg-cov"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the covariance matrices for each group and
the pooled covariance matrix are printed</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, suppress printed output</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with class <code>c("boxM", "htest")</code> containing the following
components:</p>
<dl><dt>statistic</dt>
<dd><p>the chi-square (approximate) statistic for Box's M test, where large values
imply the covariance matrices differ.</p></dd>

<dt>parameter</dt>
<dd><p>the degrees of freedom for the test statistic.</p></dd>

<dt>p.value</dt>
<dd><p>the p-value of the test</p></dd>

<dt>ngroups</dt>
<dd><p>the number of levels of the <code>group</code> variable</p></dd>

<dt>cov</dt>
<dd><p>a list of the group covariance matrices, of length <code>ngroups</code></p></dd>

<dt>pooled</dt>
<dd><p>the pooled covariance matrix</p></dd>

<dt>means</dt>
<dd><p>a matrix whose <code>ngroups+1</code> rows are the means of the variables, followed by those for pooled data.</p></dd>

<dt>logDet</dt>
<dd><p>a vector of length <code>ngroups+1</code> containing the natural logarithm of each matrix in
<code>cov</code>, followed by that for the pooled covariance matrix</p></dd>

<dt>df</dt>
<dd><p>a vector of the degrees of freedom for all groups, followed by
that for the pooled covariance matrix</p></dd>

<dt>data.name</dt>
<dd><p>a character string giving the names of the data, as extracted from the call</p></dd>

<dt>method</dt>
<dd><p>the character string <code>"Box's M-test for Homogeneity of
    Covariance Matrices"</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>As an object of class <code>"boxM"</code>, a few methods are
available:  <code>print.boxM()</code>, <code>summary.boxM()</code> and <code><a href="plot.boxM.html">plot.boxM()</a></code>.</p>
<p>There is no general provision as yet for handling missing data.  Missing
data are simply removed, with a warning.</p>
<p>As well, the computation assumes that the covariance matrix for each group
is non-singular, so that \(\log det(S_i)\) can be calculated for each
group. At the minimum, this requires that \(n &gt; p\) for each group.</p>
<p>Box's M test for a multivariate linear model highly sensitive to departures
from multivariate normality, just as the analogous univariate test.  It is
also affected adversely by unbalanced designs.  Some people recommend to
ignore the result unless it is very highly significant, e.g., p &lt; .0001 or
worse.</p>
<p>In general, heterogeneity of covariance matrices can be more easily seen and understood by plotting
the covariance ellipses using <code><a href="covEllipses.html">covEllipses</a></code>.</p>
<p>The <code>summary</code> method prints a variety of additional statistics based on
the eigenvalues of the covariance matrices. These are returned invisibly, as
a list containing the following components:</p><dl><dt>logDet</dt>
<dd><p>the vector of log determinants</p></dd>

<dt>eigs</dt>
<dd><p>eigenvalues of the covariance matrices</p></dd>

<dt>eigstats</dt>
<dd><p>statistics computed on the eigenvalues for each covariance
matrix:</p><dl><dt>product</dt>
<dd><p>the product of eigenvalues, \(\prod{\lambda_i}\)</p></dd>

<dt>sum</dt>
<dd><p>the sum of eigenvalues, \(\sum{\lambda_i}\)</p></dd>

<dt>precision</dt>
<dd><p>the average precision of eigenvalues,
\(1/\sum(1/\lambda_i)\)</p></dd>

<dt>max</dt>
<dd><p>the maximum eigenvalue, \(\lambda_1\)</p></dd>


</dl></dd>


</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Box, G. E. P. (1949). A general distribution theory for a class
of likelihood criteria. <em>Biometrika</em>, 36, 317-346.</p>
<p>Morrison, D.F. (1976) <em>Multivariate Statistical Methods</em>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/car/man/leveneTest.html" class="external-link">leveneTest</a></code> carries out homogeneity of variance
tests for univariate models with better statistical properties.</p>
<p><code><a href="plot.boxM.html">plot.boxM</a></code>, a simple dot plot of the log determinants compared with that of the pooled covariance matrix, and also of other quantities computed from their eigenvalues</p>
<p><code><a href="covEllipses.html">covEllipses</a></code> plots covariance ellipses in variable space for
several groups.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>The default method was taken from the <span class="pkg">biotools</span> package,
Anderson Rodrigo da Silva <a href="mailto:anderson.agro@hotmail.com">anderson.agro@hotmail.com</a></p>
<p>Generalized by Michael Friendly and John Fox</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default method, using `Y`, `group` </span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu">boxM</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">[</span>, <span class="st">"Species"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Box's M-test for Homogeneity of Covariance Matrices </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  iris[, 1:4] by iris[, "Species"] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 140.943, df = 20, p-value = &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># summary method gives details</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Box's M-test for Homogeneity of Covariance Matrices </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  iris[, 1:4] by iris[, "Species"] </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) =  140.943 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df:	 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value: &lt;2e-16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log of Covariance determinants:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     setosa versicolor  virginica     pooled </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -13.0674   -10.8743    -8.9271    -9.9585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      setosa versicolor virginica   pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.2364557  0.4878739  0.695255 0.443566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.0369187  0.0723841  0.106551 0.086183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.0267964  0.0547761  0.052295 0.055352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.0090333  0.0097904  0.034266 0.022364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistics based on eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               setosa versicolor  virginica     pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> product   2.1131e-06 1.8938e-05 0.00013275 4.7322e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum       3.0920e-01 6.2482e-01 0.88836735 6.0747e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> precision 5.5761e-03 7.3388e-03 0.01691212 1.3048e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max       2.3646e-01 4.8787e-01 0.69525484 4.4357e-01</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># visualize (this is what is done in the plot method)</span></span></span>
<span class="r-in"><span><span class="va">dets</span> <span class="op">&lt;-</span> <span class="va">res</span><span class="op">$</span><span class="va">logDet</span></span></span>
<span class="r-in"><span><span class="va">ng</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">logDet</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/dotchart.html" class="external-link">dotchart</a></span><span class="op">(</span><span class="va">dets</span>, xlab <span class="op">=</span> <span class="st">"log determinant"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">dets</span> , <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="va">ng</span><span class="op">)</span>, <span class="fl">2.5</span><span class="op">)</span>, pch<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">16</span>, <span class="va">ng</span><span class="op">)</span>, <span class="fl">15</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       col<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="va">ng</span><span class="op">)</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="boxM-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot method gives confidence intervals for logDet</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">res</span>, gplabel<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="boxM-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># formula method</span></span></span>
<span class="r-in"><span><span class="fu">boxM</span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> <span class="va">Species</span>,</span></span>
<span class="r-in"><span>      data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Box's M-test for Homogeneity of Covariance Matrices </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  iris </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 140.943, df = 20, p-value = &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Skulls data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># lm method</span></span></span>
<span class="r-in"><span><span class="va">skulls.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mb</span>, <span class="va">bh</span>, <span class="va">bl</span>, <span class="va">nh</span><span class="op">)</span> <span class="op">~</span> <span class="va">epoch</span>, data<span class="op">=</span><span class="va">Skulls</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">skulls.boxM</span> <span class="op">&lt;-</span> <span class="fu">boxM</span><span class="op">(</span><span class="va">skulls.mod</span><span class="op">)</span> <span class="op">|&gt;</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Box's M-test for Homogeneity of Covariance Matrices </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Y by group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) = 45.6672, df = 40, p-value = 0.2483</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">skulls.boxM</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Box's M-test for Homogeneity of Covariance Matrices </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  Y by group </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chi-Sq (approx.) =  45.66723 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> df:	 40 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> p-value: 0.25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> log of Covariance determinants:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> c1850BC  c200BC c3300BC c4000BC  cAD150  pooled </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11.222  10.469  11.032  11.477  12.153  11.605 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   c1850BC  c200BC c3300BC c4000BC cAD150 pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  26.931 35.9064 28.3992 34.8234 37.332 29.462</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  19.075 16.9560 22.0306 30.3339 28.600 21.441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  13.207 13.6751 15.5959 18.4358 14.800 18.779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  11.014  4.2292  6.3364  4.9517 12.003  9.246</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Statistics based on eigenvalues:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              c1850BC     c200BC    c3300BC    c4000BC     cAD150     pooled</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> product   74729.0725 35211.6576 61827.9462 96431.2960 189666.582 1.0968e+05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum          70.2276    70.7667    72.3621    88.5448     92.734 7.8927e+01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> precision     3.9053     2.5227     3.3053     3.1459      4.703 4.1324e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> max          26.9311    35.9064    28.3992    34.8234     37.332 2.9462e+01</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

