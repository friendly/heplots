<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bootstrap Confidence Intervals for Eigenvalue Statistics — eigstatCI • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap Confidence Intervals for Eigenvalue Statistics — eigstatCI"><meta name="description" content='Computes bootstrap confidence intervals for statistics based on eigenvalues
of grouped covariance matrices. This is intended for use with plot.boxM()
to provide confidence intervals for measures beyond the default "logDet".
This is a convenience wrapper that extracts the necessary information
from a boxM object, but still requires the original data and grouping
variable since these are not stored in the boxM object.'><meta property="og:description" content='Computes bootstrap confidence intervals for statistics based on eigenvalues
of grouped covariance matrices. This is intended for use with plot.boxM()
to provide confidence intervals for measures beyond the default "logDet".
This is a convenience wrapper that extracts the necessary information
from a boxM object, but still requires the original data and grouping
variable since these are not stored in the boxM object.'><meta property="og:image" content="https://friendly.github.io/heplots/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Data sets in the heplots package</a></li>
    <li><a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Robust.html">Robust Multivariate Linear Models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bootstrap Confidence Intervals for Eigenvalue Statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/R/eigstatCI.R" class="external-link"><code>R/eigstatCI.R</code></a></small>
      <div class="d-none name"><code>eigstatCI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes bootstrap confidence intervals for statistics based on eigenvalues
of grouped covariance matrices. This is intended for use with <code><a href="plot.boxM.html">plot.boxM()</a></code>
to provide confidence intervals for measures beyond the default "logDet".</p>
<p>This is a convenience wrapper that extracts the necessary information
from a boxM object, but still requires the original data and grouping
variable since these are not stored in the boxM object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eigstatCI</span><span class="op">(</span></span>
<span>  <span class="va">Y</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"product"</span>, <span class="st">"sum"</span>, <span class="st">"precision"</span>, <span class="st">"max"</span><span class="op">)</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"perc"</span>, <span class="st">"bca"</span>, <span class="st">"norm"</span>, <span class="st">"basic"</span><span class="op">)</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ncpus <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eigstatCI_boxM</span><span class="op">(</span><span class="va">boxm</span>, <span class="va">Y</span>, <span class="va">group</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Original data matrix used in <code><a href="boxM.html">boxM()</a></code></p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Original grouping variable used in <code><a href="boxM.html">boxM()</a></code></p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>The eigenvalue-based statistic to compute. One of:</p><dl><dt>product</dt>
<dd><p>Product of eigenvalues (= determinant)</p></dd>

<dt>sum</dt>
<dd><p>Sum of eigenvalues (= trace)</p></dd>

<dt>precision</dt>
<dd><p>Harmonic mean of eigenvalues</p></dd>

<dt>max</dt>
<dd><p>Maximum eigenvalue</p></dd>


</dl></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Number of bootstrap replicates. Default is 1000.</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>Confidence level for intervals (0 &lt; conf &lt; 1). Default is 0.95.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Type of bootstrap confidence interval. Options:</p><dl><dt>perc</dt>
<dd><p>Percentile method (default, most robust)</p></dd>

<dt>bca</dt>
<dd><p>Bias-corrected and accelerated</p></dd>

<dt>norm</dt>
<dd><p>Normal approximation</p></dd>

<dt>basic</dt>
<dd><p>Basic bootstrap</p></dd>


</dl></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical or character string. If TRUE, use parallel processing
via the boot package. Can also be "multicore" or "snow". Default is FALSE.</p></dd>


<dt id="arg-ncpus">ncpus<a class="anchor" aria-label="anchor" href="#arg-ncpus"></a></dt>
<dd><p>Number of CPUs to use if parallel=TRUE. Default is 2.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Random seed for reproducibility. If NULL, no seed is set.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments passed to <code>eigstatCI()</code></p></dd>


<dt id="arg-boxm">boxm<a class="anchor" aria-label="anchor" href="#arg-boxm"></a></dt>
<dd><p>A "boxM" object from <code><a href="boxM.html">boxM()</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with one row for each group plus the pooled data.
Columns include:</p><dl><dt>group</dt>
<dd><p>Group name (factor level)</p></dd>

<dt>statistic</dt>
<dd><p>Observed value of the statistic</p></dd>

<dt>lower</dt>
<dd><p>Lower confidence limit</p></dd>

<dt>upper</dt>
<dd><p>Upper confidence limit</p></dd>

<dt>bias</dt>
<dd><p>Bootstrap estimate of bias (if available)</p></dd>

<dt>se</dt>
<dd><p>Bootstrap standard error (if available)</p></dd>


</dl><p>A data frame with bootstrap confidence intervals</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For each group (and the pooled data), this function performs nonparametric
bootstrap resampling to estimate the sampling distribution of the specified
eigenvalue-based statistic. Confidence intervals are computed using the
percentile method or bias-corrected and accelerated (BCa) method.</p>
<p>Unlike <code><a href="logdetCI.html">logdetCI()</a></code> which uses analytic approximations based on asymptotic
theory, this function makes no distributional assumptions and can handle
small to moderate sample sizes, though computational cost increases with
the number of bootstrap replicates.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Efron, B., &amp; Tibshirani, R. J. (1994).
<em>An Introduction to the Bootstrap</em>. CRC Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="boxM.html">boxM</a></code>, <code><a href="plot.boxM.html">plot.boxM</a></code>, <code><a href="logdetCI.html">logdetCI</a></code></p>
<p>Other diagnostic plots:
<code><a href="cqplot.html">cqplot()</a></code>,
<code><a href="distancePlot.html">distancePlot()</a></code>,
<code><a href="plot.boxM.html">plot.boxM()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bootstrap CI for product of eigenvalues</span></span></span>
<span class="r-in"><span><span class="va">CI_prod</span> <span class="op">&lt;-</span> <span class="fu">eigstatCI</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, which<span class="op">=</span><span class="st">"product"</span>, R<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI_prod</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Bootstrap CI for sum of eigenvalues (= trace)</span></span></span>
<span class="r-in"><span><span class="va">CI_sum</span> <span class="op">&lt;-</span> <span class="fu">eigstatCI</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, which<span class="op">=</span><span class="st">"sum"</span>, R<span class="op">=</span><span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI_sum</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use with parallel processing for speed</span></span></span>
<span class="r-in"><span><span class="va">CI_max</span> <span class="op">&lt;-</span> <span class="fu">eigstatCI</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, which<span class="op">=</span><span class="st">"max"</span>,</span></span>
<span class="r-in"><span>                    R<span class="op">=</span><span class="fl">1000</span>, parallel<span class="op">=</span><span class="cn">TRUE</span>, ncpus<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">boot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit boxM</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="boxM.html">boxM</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get bootstrap CIs (must provide original data again)</span></span></span>
<span class="r-in"><span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu">eigstatCI_boxM</span><span class="op">(</span><span class="va">res</span>, Y <span class="op">=</span> <span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, group <span class="op">=</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>,</span></span>
<span class="r-in"><span>                     which <span class="op">=</span> <span class="st">"sum"</span>, R <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

