<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate confidence interval for log determinant of covariance matrices — logdetCI • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate confidence interval for log determinant of covariance matrices — logdetCI"><meta name="description" content="This function uses asymptotic results described by Cai et. al (2016),
Theorem 1, to calculate approximate, normal theory confidence intervals
(CIs) for the log determinant of one or more sample covariance matrices."><meta property="og:description" content="This function uses asymptotic results described by Cai et. al (2016),
Theorem 1, to calculate approximate, normal theory confidence intervals
(CIs) for the log determinant of one or more sample covariance matrices."><meta property="og:image" content="https://friendly.github.io/heplots/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Data sets in the heplots package</a></li>
    <li><a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Robust.html">Robust Multivariate Linear Models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate confidence interval for log determinant of covariance matrices</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/R/logdetCI.R" class="external-link"><code>R/logdetCI.R</code></a></small>
      <div class="d-none name"><code>logdetCI.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function uses asymptotic results described by Cai et. al (2016),
Theorem 1, to calculate approximate, normal theory confidence intervals
(CIs) for the log determinant of one or more sample covariance matrices.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">logdetCI</span><span class="op">(</span><span class="va">cov</span>, <span class="va">n</span>, conf <span class="op">=</span> <span class="fl">0.95</span>, method <span class="op">=</span> <span class="fl">1</span>, bias.adj <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cov">cov<a class="anchor" aria-label="anchor" href="#arg-cov"></a></dt>
<dd><p>a covariance matrix or a (named) list of covariance matrices, all the same size</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>sample size, or vector of sample sizes, one for each covariance matrix</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>confidence level</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Three methods are provided, based on Cai et. al Theorem 1
(<code>method=1</code>), Corollary 1 (<code>method=2</code>) and Corollary 2
(<code>method=3</code>), each with different bias and SE values.</p></dd>


<dt id="arg-bias-adj">bias.adj<a class="anchor" aria-label="anchor" href="#arg-bias-adj"></a></dt>
<dd><p>logical; set <code>FALSE</code> to exclude the bias correction term.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with one row for each covariance matrix. <code>lower</code>
       and <code>upper</code> are the boundaries of the confidence intervals. Other
       columns are <code>logdet, bias, se</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Their results are translated into a CI via the approximation
$$ \log det( \widehat{\Sigma} ) - bias \pm z_{1 - \alpha/2} \times SE $$
where \(\widehat{\Sigma}\)
is the sample estimate of a population covariance matrix,
\(bias\) is a bias correction constant and \(SE\) is a width factor for
the confidence interval.  Both \(bias\) and \(SE\) are functions of the
sample size, \(n\) and number of variables, \(p\).</p>
<p>This function is included here only to provide an approximation to
<em>graphical accuracy</em> for use with Box's M test for equality of
covariance matrices, <code><a href="boxM.html">boxM</a></code> and its associated
<code><a href="plot.boxM.html">plot.boxM</a></code> method.</p>

<p>Cai et. al (2015) claim that their Theorem 1 holds with either \(p\) fixed
or \(p(n)\) growing with \(n\), as long as \(p(n) \le n\). Their
Corollary 1 (<code>method=2</code>) is the special case when \(p\) is fixed.
Their Corollary 2 (<code>method=3</code>) is the special case when \(0 \le p/n
&lt; 1\) is fixed.</p>
<p>The properties of this CI estimator are unknown in small to moderate sample
sizes, but it seems to be the only one available.  It is therefore
experimental in this version of the package and is subject to change in the
future.</p>
<p>The \(bias\) term offsets the confidence interval from the sample estimate
of \( \log det( \widehat{\Sigma} ) \). When \(p\) is large relative to
\(n\), the confidence interval may not overlap the sample estimate.</p>
<p>Strictly speaking, this estimator applies to the MLE of the covariance
matrix \( \widehat{\Sigma}\), i.e., using \(n\) rather than \(n-1\) in
as the divisor.  The factor \((n-1 / n)\) has not yet been taken into
account here.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cai, T. T.; Liang, T. &amp; Zhou, H. H. (2015) Law of log determinant of sample
covariance matrix and optimal estimation of differential entropy for
high-dimensional Gaussian distributions. <em>Journal of Multivariate
Analysis</em>, 137, 161-172.
<a href="https://doi.org/10.1016/j.jmva.2015.02.003" class="external-link">doi:10.1016/j.jmva.2015.02.003</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="boxM.html">boxM</a></code>, <code><a href="plot.boxM.html">plot.boxM</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">iris.boxm</span> <span class="op">&lt;-</span> <span class="fu"><a href="boxM.html">boxM</a></span><span class="op">(</span><span class="va">iris.mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cov</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">iris.boxm</span><span class="op">$</span><span class="va">cov</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>pooled<span class="op">=</span><span class="va">iris.boxm</span><span class="op">$</span><span class="va">pooled</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fl">150</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu">logdetCI</span><span class="op">(</span> <span class="va">cov</span>, n<span class="op">=</span><span class="va">n</span>, conf<span class="op">=</span><span class="fl">.95</span>, method<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                logdet        bias        se      lower      upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setosa     -13.067360 -0.20598584 0.4062465 -13.657603 -12.065146</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> versicolor -10.874325 -0.20598584 0.4062465 -11.464568  -9.872111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> virginica   -8.927058 -0.20598584 0.4062465  -9.517301  -7.924844</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled      -9.958539 -0.06731274 0.2321101 -10.346154  -9.436299</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">iris.boxm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">8</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Iris data, Box's M test"</span>, gplabel<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">CI</span><span class="op">$</span><span class="va">lower</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">CI</span><span class="op">$</span><span class="va">upper</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, len<span class="op">=</span><span class="fl">.1</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="logdetCI-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">CI</span> <span class="op">&lt;-</span> <span class="fu">logdetCI</span><span class="op">(</span> <span class="va">cov</span>, n<span class="op">=</span><span class="va">n</span>, conf<span class="op">=</span><span class="fl">.95</span>, method<span class="op">=</span><span class="fl">1</span>, bias.adj<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CI</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                logdet bias        se      lower      upper</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> setosa     -13.067360    0 0.4062465 -13.863589 -12.271132</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> versicolor -10.874325    0 0.4062465 -11.670553 -10.078097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> virginica   -8.927058    0 0.4062465  -9.723287  -8.130830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> pooled      -9.958539    0 0.2321101 -10.413466  -9.503611</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">iris.boxm</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">14</span>, <span class="op">-</span><span class="fl">8</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Iris data, Box's M test"</span>, gplabel<span class="op">=</span><span class="st">"Species"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/arrows.html" class="external-link">arrows</a></span><span class="op">(</span><span class="va">CI</span><span class="op">$</span><span class="va">lower</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">CI</span><span class="op">$</span><span class="va">upper</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, lwd<span class="op">=</span><span class="fl">3</span>, angle<span class="op">=</span><span class="fl">90</span>, len<span class="op">=</span><span class="fl">.1</span>, code<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="logdetCI-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

