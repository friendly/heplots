<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Chi Square Quantile-Quantile plots — cqplot • heplots</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Chi Square Quantile-Quantile plots — cqplot"><meta name="description" content='A chi square quantile-quantile plots show the relationship between
data-based values which should be distributed as \(\chi^2\) and
corresponding quantiles from the \(\chi^2\) distribution.  In multivariate
analyses, this is often used both to assess multivariate normality and check
for or identify outliers.
For a data frame of numeric variables or a matrix supplied as the argument x,
it uses the Mahalanobis squared distances (\(D^2\)) of
observations \(\mathbf{x}\) from the centroid \(\bar{\mathbf{x}}\)
taking the sample covariance matrix \(\mathbf{S}\) into account,
$$
D^2 = (\mathbf{x} - \bar{\mathbf{x}})^\prime \; \mathbf{S}^{-1} \; (\mathbf{x} - \bar{\mathbf{x}}) \; .
$$
The method for "mlm" objects fit using lm for a multivariate response
applies this to the residuals from the model.'><meta property="og:description" content='A chi square quantile-quantile plots show the relationship between
data-based values which should be distributed as \(\chi^2\) and
corresponding quantiles from the \(\chi^2\) distribution.  In multivariate
analyses, this is often used both to assess multivariate normality and check
for or identify outliers.
For a data frame of numeric variables or a matrix supplied as the argument x,
it uses the Mahalanobis squared distances (\(D^2\)) of
observations \(\mathbf{x}\) from the centroid \(\bar{\mathbf{x}}\)
taking the sample covariance matrix \(\mathbf{S}\) into account,
$$
D^2 = (\mathbf{x} - \bar{\mathbf{x}})^\prime \; \mathbf{S}^{-1} \; (\mathbf{x} - \bar{\mathbf{x}}) \; .
$$
The method for "mlm" objects fit using lm for a multivariate response
applies this to the residuals from the model.'><meta property="og:image" content="https://friendly.github.io/heplots/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/datasets.html">Data sets in the heplots package</a></li>
    <li><a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Robust.html">Robust Multivariate Linear Models</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Chi Square Quantile-Quantile plots</h1>
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/R/cqplot.R" class="external-link"><code>R/cqplot.R</code></a></small>
      <div class="d-none name"><code>cqplot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A chi square quantile-quantile plots show the relationship between
data-based values which should be distributed as \(\chi^2\) and
corresponding quantiles from the \(\chi^2\) distribution.  In multivariate
analyses, this is often used both to assess multivariate normality and check
for or identify outliers.</p>
<p>For a data frame of numeric variables or a matrix supplied as the argument <code>x</code>,
it uses the Mahalanobis squared distances (\(D^2\)) of
observations \(\mathbf{x}\) from the centroid \(\bar{\mathbf{x}}\)
taking the sample covariance matrix \(\mathbf{S}\) into account,
$$
D^2 = (\mathbf{x} - \bar{\mathbf{x}})^\prime \; \mathbf{S}^{-1} \; (\mathbf{x} - \bar{\mathbf{x}}) \; .
$$</p>
<p>The method for <code>"mlm"</code> objects fit using <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code> for a multivariate response
applies this to the residuals from the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'mlm'</span></span>
<span><span class="fu">cqplot</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Default S3 method</span></span>
<span><span class="fu">cqplot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classical"</span>, <span class="st">"mcd"</span>, <span class="st">"mve"</span><span class="op">)</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  pch <span class="op">=</span> <span class="fl">19</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>,</span>
<span>  ref.col <span class="op">=</span> <span class="st">"red"</span>,</span>
<span>  ref.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  conf <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  env.col <span class="op">=</span> <span class="st">"gray"</span>,</span>
<span>  env.lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  env.lty <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  env.fill <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  fill.alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  fill.color <span class="op">=</span> <span class="fu"><a href="trans.colors.html">trans.colors</a></span><span class="op">(</span><span class="va">ref.col</span>, <span class="va">fill.alpha</span><span class="op">)</span>,</span>
<span>  labels <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="kw">else</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  <span class="va">id.n</span>,</span>
<span>  id.method <span class="op">=</span> <span class="st">"r"</span>,</span>
<span>  id.cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  id.col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></span><span class="op">(</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">xlab</span>,</span>
<span>  <span class="va">ylab</span>,</span>
<span>  <span class="va">main</span>,</span>
<span>  what <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>either a numeric data frame or matrix for the default method, or an
object of class <code>"mlm"</code> representing a multivariate linear model.  In
the latter case, residuals from the model are plotted.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Other arguments passed to methods</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>estimation method used for center and covariance, one of:
<code>"classical"</code> (product-moment), <code>"mcd"</code> (minimum covariance
determinant), or <code>"mve"</code> (minimum volume ellipsoid).</p></dd>


<dt id="arg-detrend">detrend<a class="anchor" aria-label="anchor" href="#arg-detrend"></a></dt>
<dd><p>logical; if <code>FALSE</code>, the plot shows values of \(D^2\)
vs. \(\chi^2\). if <code>TRUE</code>, the ordinate shows values of \(D^2 -
\chi^2\)</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>plot symbol for points. Can be a vector of length equal to the
number of rows in <code>x</code>.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>color for points. Can be a vector of length equal to the
number of rows in <code>x</code>.
The default is the <em>first</em> entry in the
current color palette (see <code><a href="https://rdrr.io/r/grDevices/palette.html" class="external-link">palette</a></code> and
<code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></code>).</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>character symbol size for points.  Can be a vector of length
equal to the number of rows in <code>x</code>.</p></dd>


<dt id="arg-ref-col">ref.col<a class="anchor" aria-label="anchor" href="#arg-ref-col"></a></dt>
<dd><p>Color for the reference line</p></dd>


<dt id="arg-ref-lwd">ref.lwd<a class="anchor" aria-label="anchor" href="#arg-ref-lwd"></a></dt>
<dd><p>Line width for the reference line</p></dd>


<dt id="arg-conf">conf<a class="anchor" aria-label="anchor" href="#arg-conf"></a></dt>
<dd><p>confidence coverage for the approximate confidence envelope</p></dd>


<dt id="arg-env-col">env.col<a class="anchor" aria-label="anchor" href="#arg-env-col"></a></dt>
<dd><p>line color for the boundary of the confidence envelope</p></dd>


<dt id="arg-env-lwd">env.lwd<a class="anchor" aria-label="anchor" href="#arg-env-lwd"></a></dt>
<dd><p>line width for the confidence envelope</p></dd>


<dt id="arg-env-lty">env.lty<a class="anchor" aria-label="anchor" href="#arg-env-lty"></a></dt>
<dd><p>line type for the confidence envelope</p></dd>


<dt id="arg-env-fill">env.fill<a class="anchor" aria-label="anchor" href="#arg-env-fill"></a></dt>
<dd><p>logical; should the confidence envelope be filled?</p></dd>


<dt id="arg-fill-alpha">fill.alpha<a class="anchor" aria-label="anchor" href="#arg-fill-alpha"></a></dt>
<dd><p>transparency value for <code>fill.color</code></p></dd>


<dt id="arg-fill-color">fill.color<a class="anchor" aria-label="anchor" href="#arg-fill-color"></a></dt>
<dd><p>color used to fill the confidence envelope</p></dd>


<dt id="arg-labels">labels<a class="anchor" aria-label="anchor" href="#arg-labels"></a></dt>
<dd><p>vector of text strings to be used to identify points, defaults
to <code>rownames(x)</code> or observation numbers if <code>rownames(x)</code> is
<code>NULL</code></p></dd>


<dt id="arg-id-n">id.n<a class="anchor" aria-label="anchor" href="#arg-id-n"></a></dt>
<dd><p>number of points labeled. If <code>id.n=0</code>, the default, no
point identification occurs.</p></dd>


<dt id="arg-id-method">id.method<a class="anchor" aria-label="anchor" href="#arg-id-method"></a></dt>
<dd><p>point identification method. The default
<code>id.method="r"</code> will identify the <code>id.n</code> points with the largest
value of abs(y), i.e., the largest Mahalanobis DSQ. See <code><a href="https://rdrr.io/pkg/car/man/showLabels.html" class="external-link">showLabels</a></code> for other
options.</p></dd>


<dt id="arg-id-cex">id.cex<a class="anchor" aria-label="anchor" href="#arg-id-cex"></a></dt>
<dd><p>size of text for point labels</p></dd>


<dt id="arg-id-col">id.col<a class="anchor" aria-label="anchor" href="#arg-id-col"></a></dt>
<dd><p>color for point labels</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>label for horizontal (theoretical quantiles) axis</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>label for vertical (empirical quantiles) axis</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>plot title</p></dd>


<dt id="arg-what">what<a class="anchor" aria-label="anchor" href="#arg-what"></a></dt>
<dd><p>the name of the object plotted; used in the construction of
<code>main</code> when that is not specified.</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>limits for vertical axis.  If not specified, the range of the
confidence envelope is used.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns invisibly a data.frame containing squared Mahalanobis distances (<code>DSQ</code>),
their <code>quantile</code>s and <code>p</code>-values
corresponding to the rows of <code>x</code> or the residuals of the model for the identified points,
else <code>NULL</code> if no points are identified.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>cqplot</code> is a more general version of similar functions in other
packages that produce chi square QQ plots. It allows for classical
Mahalanobis squared distances as well as robust estimates based on the MVE
and MCD; it provides an approximate confidence (concentration) envelope
around the line of unit slope, a detrended version, where the reference line
is horizontal, the ability to identify or label unusual points, and other
graphical features.</p>
<p>Cases with any missing values are excluded from the calculation and graph with a warning.</p>
<div class="section">
<h3 id="confidence-envelope">Confidence envelope<a class="anchor" aria-label="anchor" href="#confidence-envelope"></a></h3>
<p>In the typical use of QQ plots, it essential to have something in the nature of a confidence band
around the points to be able to appreciate whether, and to what degree the observed data points
differ from the reference distribution. For <code>cqplot</code>, this helps to assess whether the
data are reasonably distributed as multivariate normal and also to flag potential outliers.</p>
<p>The calculation of the confidence envelope here follows that used in the SAS
program, <a href="http://www.datavis.ca/sasmac/cqplot.html" class="external-link">http://www.datavis.ca/sasmac/cqplot.html</a> which comes from
Chambers et al. (1983), Section 6.8.</p>
<p>The essential formula computes the standard errors as:
$$ \text{se} ( D^2_{(i)} ) = \frac{\hat{b}} {d ( q_i)} \times \sqrt{  p_i (1-p_i) / n } $$
where \(D^2_{(i)}\) is the i-th
ordered value of \(D^2\), \(\hat{b}\) is an estimate of the slope of
the reference line obtained from the ratio of the interquartile range of the
\(D^2\) values to that of the \(\chi^2_p\) distribution and
\(d(q_i)\) is the density of the chi square distribution at the quantile
\(q_i\).</p>
<p>The pointwise confidence envelope of coverage <code>conf</code> = \(1-\alpha\) is then calculated as
\(D^2_{(i)} \pm z_{1-\alpha/2} \text{se} ( D^2_{(i)} )\)</p>
<p>Note that this confidence envelope applies only to the \(D^2\) computed
using the classical estimates of location (\(\bar{\mathbf{x}}\)) and scatter (\(\mathbf{S}\)). The
<code><a href="https://rdrr.io/pkg/car/man/qqPlot.html" class="external-link">qqPlot</a></code>
function provides for simulated envelopes, but only for
a univariate measure. Oldford (2016) provides a general theory and methods
for QQ plots.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>J. Chambers, W. S. Cleveland, B. Kleiner, P. A. Tukey (1983).
<em>Graphical methods for data analysis</em>, Wadsworth.</p>
<p>R. W. Oldford (2016), "Self calibrating quantile-quantile plots",
<em>The American Statistician</em>, 70, 74-90.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="Mahalanobis.html">Mahalanobis</a></code> for calculation of Mahalanobis squared distance;</p>
<p><code><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqplot</a></code>; <code><a href="https://rdrr.io/pkg/car/man/qqPlot.html" class="external-link">qqPlot</a></code> can give a similar
result for Mahalanobis squared distances of data or residuals;
<code><a href="https://rwoldford.github.io/qqtest/reference/qqtest.html" class="external-link">qqtest</a></code> has many features for all types of QQ plots.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Michael Friendly</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">iris.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">~</span> <span class="va">Species</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">cqplot</span><span class="op">(</span><span class="va">iris.mod</span>, id.n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># show return value</span></span></span>
<span class="r-in"><span><span class="va">out</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          DSQ quantile           p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 119 17.41948 15.77709 0.003333333</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 135 16.04843 13.27670 0.010000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 42  16.01501 12.09388 0.016666667</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compare with car::qqPlot</span></span></span>
<span class="r-in"><span><span class="fu">car</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/qqPlot.html" class="external-link">qqPlot</a></span><span class="op">(</span><span class="fu"><a href="Mahalanobis.html">Mahalanobis</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>, dist<span class="op">=</span><span class="st">"chisq"</span>, df<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 132 135</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adopted data</span></span></span>
<span class="r-in"><span><span class="va">Adopted.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Age2IQ</span>, <span class="va">Age4IQ</span>, <span class="va">Age8IQ</span>, <span class="va">Age13IQ</span><span class="op">)</span> <span class="op">~</span> <span class="va">AMED</span> <span class="op">+</span> <span class="va">BMIQ</span>, </span></span>
<span class="r-in"><span>                  data<span class="op">=</span><span class="va">Adopted</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">Adopted.mod</span>, id.n<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">Adopted.mod</span>, id.n<span class="op">=</span><span class="fl">3</span>, method<span class="op">=</span><span class="st">"mve"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Sake data</span></span></span>
<span class="r-in"><span><span class="va">Sake.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">taste</span>, <span class="va">smell</span><span class="op">)</span> <span class="op">~</span> <span class="va">.</span>, data<span class="op">=</span><span class="va">Sake</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">Sake.mod</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">Sake.mod</span>, method<span class="op">=</span><span class="st">"mve"</span>, id.n<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SocialCog data -- one extreme outlier</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SocialCog</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">SC.mlm</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">MgeEmotions</span>,<span class="va">ToM</span>, <span class="va">ExtBias</span>, <span class="va">PersBias</span><span class="op">)</span> <span class="op">~</span> <span class="va">Dx</span>,</span></span>
<span class="r-in"><span>               data<span class="op">=</span><span class="va">SocialCog</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">SC.mlm</span>, id.n<span class="op">=</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># data frame example: stackloss data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">stackloss</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">stackloss</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, id.n<span class="op">=</span><span class="fl">4</span><span class="op">)</span>                <span class="co"># very strange</span></span></span>
<span class="r-plt img"><img src="cqplot-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">stackloss</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, id.n<span class="op">=</span><span class="fl">4</span>, detrend<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">stackloss</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, id.n<span class="op">=</span><span class="fl">4</span>, method<span class="op">=</span><span class="st">"mve"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="cqplot-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu">cqplot</span><span class="op">(</span><span class="va">stackloss</span><span class="op">[</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, id.n<span class="op">=</span><span class="fl">4</span>, method<span class="op">=</span><span class="st">"mcd"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

