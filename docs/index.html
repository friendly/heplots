<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Provides HE plot and other functions for visualizing hypothesis
    tests in multivariate linear models. HE plots represent sums-of-squares-and-products 
    matrices for linear hypotheses and for error using ellipses (in two
    dimensions) and ellipsoids (in three dimensions). The related candisc package
    provides visualizations in a reduced-rank canonical discriminant space when
    there are more than a few response variables.">
<title>Visualizing Hypothesis Tests in Multivariate Linear Models â€¢ heplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Visualizing Hypothesis Tests in Multivariate Linear Models">
<meta property="og:description" content="Provides HE plot and other functions for visualizing hypothesis
    tests in multivariate linear models. HE plots represent sums-of-squares-and-products 
    matrices for linear hypotheses and for error using ellipses (in two
    dimensions) and ellipsoids (in three dimensions). The related candisc package
    provides visualizations in a reduced-rank canonical discriminant space when
    there are more than a few response variables.">
<meta property="og:image" content="https://friendly.github.io/heplots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/datasets.html">Data sets in the heplots package</a>
    <a class="dropdown-item" href="articles/HE_manova.html">HE plot MANOVA Examples</a>
    <a class="dropdown-item" href="articles/HE_mmra.html">HE plot MMRA Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="heplots-">heplots <a class="anchor" aria-label="anchor" href="#heplots-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="visualizing-hypothesis-tests-in-multivariate-linear-models">
<strong>Visualizing Hypothesis Tests in Multivariate Linear Models</strong><a class="anchor" aria-label="anchor" href="#visualizing-hypothesis-tests-in-multivariate-linear-models"></a>
</h2>
<p>Version 1.7.1</p>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>The <code>heplots</code> package provides functions for visualizing hypothesis tests in multivariate linear models (MANOVA, multivariate multiple regression, MANCOVA, and repeated measures designs).</p>
<p>HE plots represent sums-of-squares-and-products matrices for linear hypotheses (<strong>H</strong>) and for error (<strong>E</strong>) using ellipses (in two dimensions), ellipsoids (in three dimensions), or by line segments in one dimension. For the theory and applications, see:</p>
<ul>
<li>
<a href="http://datavis.ca/papers/jcgs-heplots.pdf" class="external-link">Friendly (2007)</a> for the basic theory on which this is based.</li>
<li>
<a href="(http://datavis.ca/palers/FoxFriendlyMonette-2009.pdf)" class="external-link">Fox, Friendly and Monette (2009)</a> for a brief introduction,</li>
<li>
<a href="http://www.jstatsoft.org/v37/i04/paper" class="external-link">Friendly (2010)</a> for the application of these ideas to repeated measure designs,</li>
<li>
<a href="http://datavis.ca/palers/ellipses-STS402.pdf" class="external-link">Friendly, Monette and Fox (2013)</a> for a general discussion of the role of elliptical geometry in statistical understanding,</li>
<li>
<a href="https://doi.org/10.20982/tqmp.13.1.p020" class="external-link">Friendly &amp; Sigal (2017)</a> for an applied R tutorial,</li>
<li>
<a href="https://www.datavis.ca/papers/EqCov-TAS.pdf" class="external-link">Friendly &amp; Sigal (2018)</a> for theory and examples of visualizing equality of covariance matrices.</li>
</ul>
<p>If you use this work in teaching or research, please cite it as given by <code>citation("heplots")</code> or see <a href="authors.html#citation">Citation</a>.</p>
<p>Other topics now addressed here include:</p>
<ul>
<li>robust MLMs, using iteratively re-weighted least squared to down-weight observations with large multivariate residuals, <code><a href="reference/robmlm.html">robmlm()</a></code>.</li>
<li>
<code><a href="reference/Mahalanobis.html">Mahalanobis()</a></code> calculates classical and robust Mahalanobis squared distances using MCD and MVE estimators of center and covariance.</li>
<li>visualizing tests for equality of covariance matrices in MLMs (Boxâ€™s M test), <code><a href="reference/boxM.html">boxM()</a></code> and <code><a href="reference/plot.boxM.html">plot.boxM()</a></code>.</li>
<li>
<span class="math inline"><em>Ï‡</em><sup>2</sup></span> Q-Q plots for MLMs (<code><a href="reference/cqplot.html">cqplot()</a></code>) to detect outliers and assess multivariate normality of residuals.</li>
<li>bivariate coefficient plots showing elliptical confidence regions (<code><a href="reference/coefplot.html">coefplot()</a></code>).</li>
</ul>
<p>In this respect, the <code>heplots</code> package now aims to provide a wide range of tools for analyzing and visualizing multivariate response linear models, together with other packages:</p>
<p><a href="http://github.com/friendly/candisc" class="external-link"><img src="https://raw.githubusercontent.com/friendly/candisc/master/candisc-logo.png" height="80" style="float:right; height:80px;"></a></p>
<ul>
<li>The related <a href="https://github.com/friendly/candisc/" class="external-link"><code>candisc</code></a> package provides HE plots in <strong>canonical discriminant</strong> space, the space of linear combinations of the responses that show the maximum possible effects and for canonical correlation in multivariate regression designs.</li>
</ul>
<p><a href="https://friendly.github.io/mvinfluence/" class="external-link"><img src="https://raw.githubusercontent.com/friendly/mvinfluence/master/man/figures/logo.png" height="80" style="float:right; height:80px;"></a></p>
<ul>
<li>Another package, <a href="https://friendly.github.io/mvinfluence/" class="external-link"><code>mvinfluence</code></a>, provides diagnostic measures and plots for <strong>influential observations</strong> in MLM designs. See the <a href="https://friendly.github.io/mvinfluence/" class="external-link">package documentation</a> for details.</li>
</ul>
<p>Several tutorial vignettes are also included. See <code>vignette(package="heplots")</code>.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<table class="table"><tbody>
<tr class="odd">
<td>CRAN version</td>
<td><code>install.packages("heplots")</code></td>
</tr>
<tr class="even">
<td>Development version</td>
<td><code>remotes::install_github("friendly/heplots")</code></td>
</tr>
</tbody></table>
</div>
<div class="section level2">
<h2 id="he-plot-functions">HE plot functions<a class="anchor" aria-label="anchor" href="#he-plot-functions"></a>
</h2>
<p>The graphical functions contained here all display multivariate model effects in variable (<strong>data</strong>) space, for one or more response variables (or contrasts among response variables in repeated measures designs).</p>
<ul>
<li><p><code><a href="reference/heplot.html">heplot()</a></code> constructs two-dimensional HE plots for model terms and linear hypotheses for pairs of response variables in multivariate linear models.</p></li>
<li><p><code><a href="reference/heplot3d.html">heplot3d()</a></code> constructs analogous 3D plots for triples of response variables.</p></li>
<li><p>The <code>pairs</code> method, <code><a href="reference/pairs.mlm.html">pairs.mlm()</a></code> constructs a scatterplot matrix of pairwise HE plots.</p></li>
<li><p><code><a href="reference/heplot1d.html">heplot1d()</a></code> constructs 1-dimensional analogs of HE plots for model terms and linear hypotheses for single response variables.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="other-functions">Other functions<a class="anchor" aria-label="anchor" href="#other-functions"></a>
</h2>
<ul>
<li><p><code><a href="reference/glance.mlm.html">glance.mlm()</a></code> extends <code><a href="https://broom.tidymodels.org/reference/glance.lm.html" class="external-link">broom::glance.lm()</a></code> to multivariate response models, giving a one-line statistical summary for each response variable.</p></li>
<li><p><code><a href="reference/boxM.html">boxM()</a></code> Calculates Boxâ€™s <em>M</em> test for homogeneity of covariance matrices in a MANOVA design. A <code>plot</code> method displays a visual representation of the components of the test. Associated with this, <code>bartletTests()</code> and <code>levineTests()</code> give the univariate tests of homogeneity of variance for each response measure in a MLM.</p></li>
<li><p><code><a href="reference/covEllipses.html">covEllipses()</a></code> draw covariance (data) ellipses for one or more group, optionally including the ellipse for the pooled within-group covariance.</p></li>
</ul>
<div class="section level3">
<h3 id="repeated-measure-designs">Repeated measure designs<a class="anchor" aria-label="anchor" href="#repeated-measure-designs"></a>
</h3>
<p>For repeated measure designs, between-subject effects and within-subject effects must be plotted separately, because the error terms (<strong>E</strong> matrices) differ. For terms involving within-subject effects, these functions carry out a linear transformation of the matrix <strong>Y</strong> of responses to a matrix <strong>Y M</strong>, where <strong>M</strong> is the model matrix for a term in the intra-subject design and produce plots of the H and E matrices in this transformed space. The vignette <code>"repeated"</code> describes these graphical methods for repeated measures designs. (At present, this vignette is only available at <a href="http://www.jstatsoft.org/v37/i04/paper" class="external-link">HE plots for repeated measures designs</a>.)</p>
</div>
</div>
<div class="section level2">
<h2 id="datasets">Datasets<a class="anchor" aria-label="anchor" href="#datasets"></a>
</h2>
<p>The package also provides a large collection of data sets illustrating a variety of multivariate linear models of the types listed above, together with graphical displays. The table below classifies these with method tags. Their names are linked to their documentation with graphical output on the <code>pkgdown</code> website, [<a href="http://friendly.github.io/heplots" class="external-link uri">http://friendly.github.io/heplots</a>].</p>
<table class="table">
<colgroup>
<col width="47%">
<col width="3%">
<col width="3%">
<col width="36%">
<col width="9%">
</colgroup>
<thead><tr class="header">
<th>dataset</th>
<th>rows</th>
<th>cols</th>
<th>title</th>
<th>tags</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/AddHealth.html" class="external-link">AddHealth</a></td>
<td>4344</td>
<td>3</td>
<td>Adolescent Health Data</td>
<td>MANOVA ordered</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Adopted.html" class="external-link">Adopted</a></td>
<td>62</td>
<td>6</td>
<td>Adopted Children</td>
<td>MMRA repeated</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Bees.html" class="external-link">Bees</a></td>
<td>246</td>
<td>6</td>
<td>Captive and maltreated bees</td>
<td>MANOVA</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Diabetes.html" class="external-link">Diabetes</a></td>
<td>145</td>
<td>6</td>
<td>Diabetes Dataset</td>
<td>MANOVA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/FootHead.html" class="external-link">FootHead</a></td>
<td>90</td>
<td>7</td>
<td>Head measurements of football players</td>
<td>MANOVA contrasts</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Headache.html" class="external-link">Headache</a></td>
<td>98</td>
<td>6</td>
<td>Treatment of Headache Sufferers for Sensitivity to Noise</td>
<td>MANOVA repeated</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Hernior.html" class="external-link">Hernior</a></td>
<td>32</td>
<td>9</td>
<td>Recovery from Elective Herniorrhaphy</td>
<td>MMRA candisc</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Iwasaki_Big_Five.html" class="external-link">Iwasaki_Big_Five</a></td>
<td>203</td>
<td>7</td>
<td>Personality Traits of Cultural Groups</td>
<td>MANOVA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/mathscore.html" class="external-link">mathscore</a></td>
<td>12</td>
<td>3</td>
<td>Math scores for basic math and word problems</td>
<td>MANOVA</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/MockJury.html" class="external-link">MockJury</a></td>
<td>114</td>
<td>17</td>
<td>Effects Of Physical Attractiveness Upon Mock Jury Decisions</td>
<td>MANOVA candisc</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/NeuroCog.html" class="external-link">NeuroCog</a></td>
<td>242</td>
<td>10</td>
<td>Neurocognitive Measures in Psychiatric Groups</td>
<td>MANOVA candisc</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/NLSY.html" class="external-link">NLSY</a></td>
<td>243</td>
<td>6</td>
<td>National Longitudinal Survey of Youth Data</td>
<td>MMRA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Oslo.html" class="external-link">Oslo</a></td>
<td>332</td>
<td>14</td>
<td>Oslo Transect Subset Data</td>
<td>MANOVA candisc</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Overdose.html" class="external-link">Overdose</a></td>
<td>17</td>
<td>7</td>
<td>Overdose of Amitriptyline</td>
<td>MMRA cancor</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Parenting.html" class="external-link">Parenting</a></td>
<td>60</td>
<td>4</td>
<td>Father Parenting Competence</td>
<td>MANOVA contrasts</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/peng.html" class="external-link">peng</a></td>
<td>333</td>
<td>8</td>
<td>Size measurements for adult foraging penguins near Palmer Station</td>
<td>MANOVA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Plastic.html" class="external-link">Plastic</a></td>
<td>20</td>
<td>5</td>
<td>Plastic Film Data</td>
<td>MANOVA</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Pottery2.html" class="external-link">Pottery2</a></td>
<td>48</td>
<td>12</td>
<td>Chemical Analysis of Romano-British Pottery</td>
<td>MANOVA candisc</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/Probe.html" class="external-link">Probe</a></td>
<td>11</td>
<td>5</td>
<td>Response Speed in a Probe Experiment</td>
<td>MANOVA repeated</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/RatWeight.html" class="external-link">RatWeight</a></td>
<td>27</td>
<td>6</td>
<td>Weight Gain in Rats Exposed to Thiouracil and Thyroxin</td>
<td>MANOVA repeated</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/ReactTime.html" class="external-link">ReactTime</a></td>
<td>10</td>
<td>6</td>
<td>Reaction Time Data</td>
<td>repeated</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Rohwer.html" class="external-link">Rohwer</a></td>
<td>69</td>
<td>10</td>
<td>Rohwer Data Set</td>
<td>MMRA MANCOVA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/RootStock.html" class="external-link">RootStock</a></td>
<td>48</td>
<td>5</td>
<td>Growth of Apple Trees from Different Root Stocks</td>
<td>MANOVA contrasts</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Sake.html" class="external-link">Sake</a></td>
<td>30</td>
<td>10</td>
<td>Taste Ratings of Japanese Rice Wine (Sake)</td>
<td>MMRA</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/schooldata.html" class="external-link">schooldata</a></td>
<td>70</td>
<td>8</td>
<td>School Data</td>
<td>MMRA robust</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/Skulls.html" class="external-link">Skulls</a></td>
<td>150</td>
<td>5</td>
<td>Egyptian Skulls</td>
<td>MANOVA contrasts</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/SocGrades.html" class="external-link">SocGrades</a></td>
<td>40</td>
<td>10</td>
<td>Grades in a Sociology Course</td>
<td>MANOVA candisc</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/SocialCog.html" class="external-link">SocialCog</a></td>
<td>139</td>
<td>5</td>
<td>Social Cognitive Measures in Psychiatric Groups</td>
<td>MANOVA candisc</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/TIPI.html" class="external-link">TIPI</a></td>
<td>1799</td>
<td>16</td>
<td>Data on the Ten Item Personality Inventory</td>
<td>MANOVA candisc</td>
</tr>
<tr class="even">
<td><a href="http://friendly.github.io/heplots/reference/VocabGrowth.html" class="external-link">VocabGrowth</a></td>
<td>64</td>
<td>4</td>
<td>Vocabulary growth data</td>
<td>repeated</td>
</tr>
<tr class="odd">
<td><a href="http://friendly.github.io/heplots/reference/WeightLoss.html" class="external-link">WeightLoss</a></td>
<td>34</td>
<td>7</td>
<td>Weight Loss Data</td>
<td>repeated</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>This example illustrates HE plots using the classic <code>iris</code> data set. How do the means of the flower variables differ by <code>Species</code>? This dataset was the impetus for R. A. Fisher (1936) to propose a method of discriminant analysis using data collected by Edgar Anderson (1928). Though some may rightly deprecate Fisher for being a supporter of eugenics, Andersonâ€™s <code>iris</code> dataset should not be blamed.</p>
<p>A basic HE plot shows the <strong>H</strong> and <strong>E</strong> ellipses for the first two response variables (here: <code>Sepal.Length</code> and <code>Sepal.Width</code>). The multivariate test is significant (by Royâ€™s test) <em>iff</em> the <strong>H</strong> ellipse projects <em>anywhere</em> outside the <strong>E</strong> ellipse.</p>
<p>The positions of the group means show how they differ on the two response variables shown, and provide an interpretation of the orientation of the <strong>H</strong> ellipse: it is long in the directions of differences among the means.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">iris.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                 <span class="va">Species</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">iris.mod</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris1-1.png" width="70%"></p>
<div class="section level3">
<h3 id="contrasts">Contrasts<a class="anchor" aria-label="anchor" href="#contrasts"></a>
</h3>
<p>Contrasts or other linear hypotheses can be shown as well, and the ellipses look better if they are filled. We create contrasts to test the differences between <code>versacolor</code> and <code>virginca</code> and also between <code>setosa</code> and the average of the other two. Each 1 df contrast plots as degenerate 1D ellipseâ€“ a line.</p>
<p>Because these contrasts are orthogonal, they add to the total 2 df effect of <code>Species</code>. Note how the first contrast, labeled <code>V:V</code>, distinguishes the means of <em>versicolor</em> from <em>virginica</em>; the second contrast, <code>S:VV</code> distinguishes <code>setosa</code> from the other two.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, </span>
<span>                                  <span class="fl">2</span>, <span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, nrow<span class="op">=</span><span class="fl">3</span>, ncol<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1] [,2]</span></span>
<span><span class="co">#&gt; setosa        0    2</span></span>
<span><span class="co">#&gt; versicolor   -1   -1</span></span>
<span><span class="co">#&gt; virginica     1   -1</span></span>
<span><span class="va">iris.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Sepal.Length</span>, <span class="va">Sepal.Width</span>, <span class="va">Petal.Length</span>, <span class="va">Petal.Width</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                 <span class="va">Species</span>, data<span class="op">=</span><span class="va">iris</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"V:V"</span><span class="op">=</span><span class="st">"Species1"</span>,<span class="st">"S:VV"</span><span class="op">=</span><span class="st">"Species2"</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">iris.mod</span>, hypotheses<span class="op">=</span><span class="va">hyp</span>, </span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris2-1.png" width="70%"></p>
</div>
<div class="section level3">
<h3 id="all-pairwise-he-plots">All pairwise HE plots<a class="anchor" aria-label="anchor" href="#all-pairwise-he-plots"></a>
</h3>
<p>All pairwise HE plots are produced using the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> method for MLM objects.In the plot, note how the means of most pairs of variables are very highly correlated, in the order Setosa &lt; Versicolor &lt; Virginica, but this pattern doesnâ€™t hold for relations with <code>Sepal.Width</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">iris.mod</span>, hypotheses<span class="op">=</span><span class="va">hyp</span>, hyp.labels<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>      fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris3-1.png" width="100%"></p>
</div>
<div class="section level3">
<h3 id="canonical-discriminant-view">Canonical discriminant view<a class="anchor" aria-label="anchor" href="#canonical-discriminant-view"></a>
</h3>
<p>For more than two response variables, a multivariate effect can be viewed more simply by projecting the data into canonical space â€” the linear combinations of the responses which show the greatest differences among the group means relative to within-group scatter. The computations are performed with the <a href="http://github.com/friendly/candisc" class="external-link"><code>candisc</code></a> package, which has an <code>heplot.candisc()</code> method.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">candisc</span><span class="op">)</span></span>
<span><span class="va">iris.can</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candisc.html" class="external-link">candisc</a></span><span class="op">(</span><span class="va">iris.mod</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Canonical Discriminant Analysis for Species:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    CanRsq Eigenvalue Difference  Percent Cumulative</span></span>
<span><span class="co">#&gt; 1 0.96987   32.19193     31.907 99.12126     99.121</span></span>
<span><span class="co">#&gt; 2 0.22203    0.28539     31.907  0.87874    100.000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test of H0: The canonical correlations in the </span></span>
<span><span class="co">#&gt; current row and all that follow are zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LR test stat approx F numDF denDF   Pr(&gt; F)    </span></span>
<span><span class="co">#&gt; 1      0.02344  199.145     8   288 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; 2      0.77797   13.794     3   145 5.794e-08 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The HE plot in canonical space shows that the differences among species are nearly entirely one-dimensional. The weights for the variables on the first dimension show how <code>Sepal.Width</code> differs from the other size variables.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># HE plot in canonical space</span></span>
<span><span class="fu"><a href="reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">iris.can</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris-can-1.png" width="60%"></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co">#&gt; Vector scale factor set to  43.914</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="covariance-ellipses">Covariance ellipses<a class="anchor" aria-label="anchor" href="#covariance-ellipses"></a>
</h3>
<p>MANOVA relies on the assumption that within-group covariance matrices are all equal. It is useful to visualize these in the space of some of the predictors. <code><a href="reference/covEllipses.html">covEllipses()</a></code> provides this both for classical and robust (<code>method="mve"</code>) estimates. The figure below shows these for the three Iris species and the pooled covariance matrix, which is the same as the <strong>E</strong> matrix used in MANOVA tests.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">+</span><span class="fl">.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">iris</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="va">iris</span><span class="op">$</span><span class="va">Species</span>, </span>
<span>            fill<span class="op">=</span><span class="cn">TRUE</span>, method<span class="op">=</span><span class="st">"mve"</span>, add<span class="op">=</span><span class="cn">TRUE</span>, labels<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-iris4-1.png" width="80%"></p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Anderson, E. (1928). The Problem of Species in the Northern Blue Flags, Iris versicolor L. and Iris virginica L. <em>Annals of the Missouri Botanical Garden</em>, <strong>13</strong>, 241â€“313.</p>
<p>Fisher, R. A. (1936). The Use of Multiple Measurements in Taxonomic Problems. <em>Annals of Eugenics</em>, <strong>8</strong>, 379â€“388.</p>
<p>Friendly, M. (2006). <a href="https://www.jstatsoft.org/article/view/v017i06" class="external-link">Data Ellipses, HE Plots and Reduced-Rank Displays for Multivariate Linear Models: SAS Software and Examples.</a> <em>Journal of Statistical Software</em>, <strong>17</strong>, 1-42.</p>
<p>Friendly, M. (2007). <a href="http://datavis.ca/papers/jcgs-heplots.pdf" class="external-link">HE plots for Multivariate General Linear Models</a>. <em>Journal of Computational and Graphical Statistics</em>, <strong>16</strong>(2) 421-444. <a href="http://dx.doi.org/10.1198/106186007X208407" class="external-link">DOI</a>.</p>
<p>Fox, J., Friendly, M. &amp; Monette, G. (2009). <a href="http://datavis.ca/palers/FoxFriendlyMonette-2009.pdf" class="external-link">Visualizing hypothesis tests in multivariate linear models: The heplots package for R</a> <em>Computational Statistics</em>, <strong>24</strong>, 233-246.</p>
<p>Friendly, M. (2010). <a href="http://www.jstatsoft.org/v37/i04/paper" class="external-link">HE plots for repeated measures designs</a>. <em>Journal of Statistical Software</em>, <strong>37</strong>, 1â€“37.</p>
<p>Friendly, M.; Monette, G. &amp; Fox, J. (2013). <a href="http://datavis.ca/palers/ellipses-STS402.pdf" class="external-link">Elliptical Insights: Understanding Statistical Methods Through Elliptical Geometry</a> <em>Statistical Science</em>, <strong>28</strong>, 1-39.</p>
<p>Friendly, M. &amp; Sigal, M. (2017). <a href="https://doi.org/10.20982/tqmp.13.1.p020" class="external-link">Graphical Methods for Multivariate Linear Models in Psychological Research: An R Tutorial.</a> <em>The Quantitative Methods for Psychology</em>, <strong>13</strong>, 20-45.</p>
<p>Friendly, M. &amp; Sigal, M. (2018): <a href="https://www.datavis.ca/papers/EqCov-TAS.pdf" class="external-link">Visualizing Tests for Equality of Covariance Matrices</a>, <em>The American Statistician</em>, <a href="https://doi.org/10.1080/00031305.2018.1497537" class="external-link">DOI</a></p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=heplots" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/friendly/heplots/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/friendly/heplots/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing heplots</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael Friendly <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3237-0941" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>John Fox <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-1196-8012" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Georges Monette <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0003-0076-5532" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="http://cran.r-project.org/package=heplots" class="external-link"><img src="http://www.r-pkg.org/badges/version/heplots" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/friendly/heplots" class="external-link"><img src="https://img.shields.io/github/last-commit/friendly/heplots" alt="Last Commit"></a></li>
<li><a href="https://cran.r-project.org/package=heplots" class="external-link"><img src="http://cranlogs.r-pkg.org/badges/grand-total/heplots"></a></li>
<li><a href="https://zenodo.org/badge/latestdoi/13908453" class="external-link"><img src="https://zenodo.org/badge/13908453.svg" alt="DOI"></a></li>
<li><a href="https://friendly.github.io/heplots"><img src="https://img.shields.io/badge/pkgdown%20site-blue"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
