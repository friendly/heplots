<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="heplots">
<title>HE plot MANOVA Examples • heplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HE plot MANOVA Examples">
<meta property="og:description" content="heplots">
<meta property="og:image" content="https://friendly.github.io/heplots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a>
    <a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>HE plot MANOVA Examples</h1>
                        <h4 data-toc-skip class="author">Michael Friendly</h4>
            
            <h4 data-toc-skip class="date">2024-04-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/vignettes/HE_manova.Rmd" class="external-link"><code>vignettes/HE_manova.Rmd</code></a></small>
      <div class="d-none name"><code>HE_manova.Rmd</code></div>
    </div>

    
    
<!--
output:
    bookdown::html_document2:
      base_format: rmarkdown::html_vignette
    toc_float: true
      
at end:  sessioninfo::package_info()
-->
<p>Vignette built using <code>heplots</code>, version 1.6.3
and <code>candisc</code>, version 0.8-6.</p>
<div class="section level2">
<h2 id="multivariate-analysis-of-variance-designs">Multivariate Analysis of Variance Designs<a class="anchor" aria-label="anchor" href="#multivariate-analysis-of-variance-designs"></a>
</h2>
<p>This vignette provides some worked examples of the analysis of multivariate linear models
(MLMs) for MANOVA designs where all predictors are factors, and the goal is to determine
how the group means differ on several response variables in relation to the factors
and possible interactions.</p>
<p>Graphical methods for visualizing results using the <code>heplots</code> and the <code>candisc</code> packages
are illustrated.
The emphasis here is on using these methods in R, and understanding how they help reveal
aspects of these models that might not be apparent from other graphical displays.</p>
<p>No attempt is made here to describe the theory of MLMs or the statistical details behind
HE plots and their reduced-rank canonical cousins.
For that, see <span class="citation">Fox, Friendly, &amp; Monette (<a href="#ref-FoxFriendlyMonette:09:compstat">2009</a>)</span>; <span class="citation">Friendly (<a href="#ref-Friendly:07:manova">2007</a>)</span>; <span class="citation">Friendly (<a href="#ref-Friendly:06:hesoft">2006</a>)</span>.</p>
</div>
<div class="section level2" number="1">
<h2 id="adolescent-mental-health-data">
<span class="header-section-number">1</span> Adolescent Mental Health Data<a class="anchor" aria-label="anchor" href="#adolescent-mental-health-data"></a>
</h2>
<p>This is a simple example of a one-way MANOVA design with a quantitative factor.
The dataset, <code>AddHealth</code>, contains a large cross-sectional sample of participants from grades 7–12
from the National Longitudinal Study of Adolescent Health, described by <span class="citation">Warne (<a href="#ref-Warne2014">2014</a>)</span>.
It contains responses to two Likert-scale (1–5) items, <code>anxiety</code> and <code>depression</code>.
<code>grade</code> is an <em>ordered</em> factor, which means that the default contrasts are taken as
orthogonal polynomials with linear (<code>grade.L</code>), quadratic (<code>grade.Q</code>), up to 5th degree (<code>grade^5</code>)
trends, which decompose the total effect of grade.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">AddHealth</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">AddHealth</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    4344 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ grade     : Ord.factor w/ 6 levels "7"&lt;"8"&lt;"9"&lt;"10"&lt;..: 5 4 6 1 2 2 2 3 3 3 ...</span></span>
<span><span class="co">#&gt;  $ depression: int  0 0 0 0 0 0 0 0 1 2 ...</span></span>
<span><span class="co">#&gt;  $ anxiety   : int  0 0 0 1 1 0 0 1 1 0 ...</span></span></code></pre></div>
<p>The research questions are:</p>
<ol style="list-style-type: decimal">
<li>How do the means for anxiety and depression vary separately with grade? Is there evidence for linear and nonlinear trends?</li>
<li>How do anxiety and depression vary <em>jointly</em> with grade?</li>
<li>How does the association of anxiety and depression vary with age?</li>
</ol>
<p>The first question can be answered by fitting separate linear models for each response
(e.g., <code>lm(anxiety ~ grade))</code>). However the second question is more interesting because it
considers the two responses together and takes their correlation into account. This would
be fit as the MLM:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">anxiety</span>, <span class="va">depression</span><span class="op">)</span> <span class="op">~</span> <span class="va">grade</span>, data<span class="op">=</span><span class="va">AddHealth</span><span class="op">)</span></span></code></pre></div>
<div class="section level3" number="1.1">
<h3 id="exploratory-plots">
<span class="header-section-number">1.1</span> Exploratory plots<a class="anchor" aria-label="anchor" href="#exploratory-plots"></a>
</h3>
<p>Some exploratory analysis is useful before fitting and visualizing models.
As a first step, find the means, standard deviations, and standard errors of the means:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="va">AddHealth</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">grade</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    dep_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">depression</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    anx_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">anxiety</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    dep_se <span class="op">=</span> <span class="va">dep_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    anx_se <span class="op">=</span> <span class="va">anx_sd</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>,</span>
<span>    depression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">depression</span><span class="op">)</span>,</span>
<span>    anxiety <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">anxiety</span><span class="op">)</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/relocate.html" class="external-link">relocate</a></span><span class="op">(</span><span class="va">depression</span>, <span class="va">anxiety</span>, .after <span class="op">=</span> <span class="va">grade</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 8</span></span></span>
<span><span class="co">#&gt;   grade depression anxiety     n dep_sd anx_sd dep_se anx_se</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;ord&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 7          0.881   0.751   622   1.11   1.05 0.044<span style="text-decoration: underline;">7</span> 0.042<span style="text-decoration: underline;">0</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 8          1.08    0.804   664   1.19   1.06 0.046<span style="text-decoration: underline;">1</span> 0.041<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 9          1.17    0.934   778   1.19   1.08 0.042<span style="text-decoration: underline;">6</span> 0.038<span style="text-decoration: underline;">7</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 10         1.27    0.956   817   1.23   1.11 0.043<span style="text-decoration: underline;">1</span> 0.038<span style="text-decoration: underline;">8</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 11         1.37    1.12    790   1.20   1.16 0.042<span style="text-decoration: underline;">8</span> 0.041<span style="text-decoration: underline;">1</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 12         1.34    1.10    673   1.14   1.11 0.043<span style="text-decoration: underline;">9</span> 0.042<span style="text-decoration: underline;">6</span></span></span></code></pre></div>
<p>Now, plot the means with <span class="math inline">\(\pm 1\)</span> error bars. It appears that average level of both depression
and anxiety increase steadily with grade, except for grades 11 and 12 which don’t differ much.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">means</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">anxiety</span>, y <span class="op">=</span> <span class="va">depression</span>, </span>
<span>                         color <span class="op">=</span> <span class="va">grade</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_errorbarh.html" class="external-link">geom_errorbarh</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">anxiety</span> <span class="op">-</span> <span class="va">anx_se</span>, </span>
<span>                    xmax <span class="op">=</span> <span class="va">anxiety</span> <span class="op">+</span> <span class="va">anx_se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">depression</span> <span class="op">-</span> <span class="va">dep_se</span>, </span>
<span>                    ymax <span class="op">=</span> <span class="va">depression</span> <span class="op">+</span> <span class="va">dep_se</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, linewidth <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_label</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">grade</span><span class="op">)</span>, </span>
<span>             nudge_x <span class="op">=</span> <span class="op">-</span><span class="fl">0.015</span>, nudge_y <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html" class="external-link">scale_color_discrete</a></span><span class="op">(</span>guide <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:addhealth-means-plot"></span>
<img src="fig/manova-addhealth-means-plot-1.png" alt="Means of anxiety and depression by grade, with $\pm 1$ error bars"><p class="caption">
Figure 1.1: Means of anxiety and depression by grade, with <span class="math inline">\(\pm 1\)</span> error bars
</p>
</div>
<p>You can examine the within-group correlations using <code><a href="../reference/covEllipses.html">covEllipses()</a></code>. Because the variability of the
scores is so large compared to the range of the means, I show the data ellipses with coverage of
only 10%.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/covEllipses.html">covEllipses</a></span><span class="op">(</span><span class="va">AddHealth</span><span class="op">[</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, group <span class="op">=</span> <span class="va">AddHealth</span><span class="op">$</span><span class="va">grade</span>,</span>
<span>            pooled <span class="op">=</span> <span class="cn">FALSE</span>, level <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>            center.cex <span class="op">=</span> <span class="fl">2.5</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>            fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:addhealth-covellipse"></span>
<img src="fig/manova-addhealth-covellipse-1.png" alt="Within-group covariance ellipses for the `grade` groups."><p class="caption">
Figure 1.2: Within-group covariance ellipses for the <code>grade</code> groups.
</p>
</div>
</div>
<div class="section level3" number="1.2">
<h3 id="fit-the-mlm">
<span class="header-section-number">1.2</span> Fit the MLM<a class="anchor" aria-label="anchor" href="#fit-the-mlm"></a>
</h3>
<p>Now, let’s fit the MLM for both responses jointly in relation to <code>grade</code>. The null hypothesis is that
the means for anxiety and depression are the same at all six grades,
<span class="math display">\[
H_0 : \mathbf{\mu}_7 = \mathbf{\mu}_8 = \cdots = \mathbf{\mu}_{12} \; .
\]</span>
The overall test, with 5 degrees of freedom is diffuse, in that it can be rejected if any
pair of means differ.
Given that <code>grade</code> is an ordered factor, it makes sense to examine narrower hypotheses
of linear and nonlinear trends.</p>
<p><code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> gives a simple display of the multivariate test, using the Pillai trace criterion.
The <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> method for this gives all four test statistics.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">AH.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">anxiety</span>, <span class="va">depression</span><span class="op">)</span> <span class="op">~</span> <span class="va">grade</span>, data <span class="op">=</span> <span class="va">AddHealth</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># overall test of `grade`</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">AH.mlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;       Df test stat approx F num Df den Df Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; grade  5    0.0224     9.83     10   8676 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="co"># show separate multivariate tests</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">AH.mlm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>SSP <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ------------------------------------------</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Term: grade </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: grade</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            5   0.02242   9.8340     10   8676 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; Wilks             5   0.97762   9.8726     10   8674 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  5   0.02286   9.9112     10   8672 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; Roy               5   0.02119  18.3878      5   4338 &lt; 2.2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
</div>
<div class="section level3" number="1.3">
<h3 id="he-plot">
<span class="header-section-number">1.3</span> HE plot<a class="anchor" aria-label="anchor" href="#he-plot"></a>
</h3>
<p>Figure <a href="#fig:addhealth-heplot">1.3</a></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">AH.mlm</span>, </span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"grade.L"</span>, <span class="st">"grade.Q"</span><span class="op">)</span>, </span>
<span>       hyp.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"quad"</span><span class="op">)</span>,</span>
<span>       label.pos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>       fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       level <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       cex.lab <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:addhealth-heplot"></span>
<img src="fig/manova-addhealth-heplot-1.png" alt="HE plot for the model `AH.mlm`."><p class="caption">
Figure 1.3: HE plot for the model <code>AH.mlm</code>.
</p>
</div>
</div>
</div>
<div class="section level2" number="2">
<h2 id="plastic-film-data">
<span class="header-section-number">2</span> Plastic film data<a class="anchor" aria-label="anchor" href="#plastic-film-data"></a>
</h2>
<p>An experiment was conducted to determine the optimum conditions for extruding plastic film.
Three responses, <code>tear</code> resistance, film <code>gloss</code> and film <code>opacity</code>
were measured in relation to two factors, <code>rate</code> of extrusion and amount of an <code>additive</code>,
both of these being set to two values, High and Low. The data set comes from
<span class="citation">Johnson &amp; Wichern (<a href="#ref-JohnsonWichern:92">1992</a>)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Plastic</span>, package<span class="op">=</span><span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Plastic</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    20 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ tear    : num  6.5 6.2 5.8 6.5 6.5 6.9 7.2 6.9 6.1 6.3 ...</span></span>
<span><span class="co">#&gt;  $ gloss   : num  9.5 9.9 9.6 9.6 9.2 9.1 10 9.9 9.5 9.4 ...</span></span>
<span><span class="co">#&gt;  $ opacity : num  4.4 6.4 3 4.1 0.8 5.7 2 3.9 1.9 5.7 ...</span></span>
<span><span class="co">#&gt;  $ rate    : Factor w/ 2 levels "Low","High": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ additive: Factor w/ 2 levels "Low","High": 1 1 1 1 1 2 2 2 2 2 ...</span></span></code></pre></div>
<p>The design is thus a <span class="math inline">\(2\times 2\)</span> MANOVA, with <span class="math inline">\(n=5\)</span> per cell and 3 numeric response variables.
Because the effects of the factors on the responses are likely correlated, it is useful to
consider a multivariate analysis, rather than 3 separate univariate ones.</p>
<p>This example illustrates:</p>
<ul>
<li>2D and 3D HE plots,</li>
<li>the difference between “effect” scaling and “evidence” (significance) scaling, and</li>
<li>visualizing composite linear hypotheses.</li>
</ul>
<div class="section level4" number="2.0.1">
<h4 id="multivariate-tests">
<span class="header-section-number">2.0.1</span> Multivariate tests<a class="anchor" aria-label="anchor" href="#multivariate-tests"></a>
</h4>
<p>We begin with an overall MANOVA for the two-way MANOVA model. In all these analyses, we use
<code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code> for significance tests rather than <code><a href="https://rdrr.io/r/stats/anova.html" class="external-link">stats::anova()</a></code>, which only provides
so-called “Type I” (sequential) tests for terms in linear models.</p>
<p>In this example, because each effect has 1 df, all of the multivariate statistics
(Roy’s maximum root test, Pillai and Hotelling trace criteria, Wilks’ Lambda)
are equivalent, in that they give the same <span class="math inline">\(F\)</span> statistics and <span class="math inline">\(p\)</span>-values.
We specify <code>test.statistic="Roy"</code> to emphasize that Roy’s test has
a natural visual interpretation in HE plots.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plastic.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">tear</span>, <span class="va">gloss</span>, <span class="va">opacity</span><span class="op">)</span> <span class="op">~</span> <span class="va">rate</span><span class="op">*</span><span class="va">additive</span>, data<span class="op">=</span><span class="va">Plastic</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">plastic.mod</span>, test.statistic<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;               Df test stat approx F num Df den Df Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; rate           1     1.619     7.55      3     14  0.003 **</span></span>
<span><span class="co">#&gt; additive       1     0.912     4.26      3     14  0.025 * </span></span>
<span><span class="co">#&gt; rate:additive  1     0.287     1.34      3     14  0.302   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>For the three responses jointly, the main effects of <code>rate</code> and <code>additive</code>
are significant, while their interaction is not.
In some approaches to testing effects in multivariate linear models (MLMs),
significant multivariate tests are often followed by univariate tests on each
of the responses separately to determine which responses contribute to each
significant effect.</p>
<p>In R, univariate analyses are conveniently performed
using the <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code> method for the <code>mlm</code> object <code>plastic.mod</code>, which re-fits the model with
only a single outcome variable.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="va">tear</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: tear</span></span>
<span><span class="co">#&gt;               Sum Sq Df F value Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; rate            1.74  1    15.8 0.0011 **</span></span>
<span><span class="co">#&gt; additive        0.76  1     6.9 0.0183 * </span></span>
<span><span class="co">#&gt; rate:additive   0.00  1     0.0 0.9471   </span></span>
<span><span class="co">#&gt; Residuals       1.76 16                  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="va">gloss</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: gloss</span></span>
<span><span class="co">#&gt;               Sum Sq Df F value Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; rate           1.301  1    7.92  0.012 *</span></span>
<span><span class="co">#&gt; additive       0.612  1    3.73  0.071 .</span></span>
<span><span class="co">#&gt; rate:additive  0.544  1    3.32  0.087 .</span></span>
<span><span class="co">#&gt; Residuals      2.628 16                 </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="va">opacity</span> <span class="op">~</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: opacity</span></span>
<span><span class="co">#&gt;               Sum Sq Df F value Pr(&gt;F)</span></span>
<span><span class="co">#&gt; rate             0.4  1    0.10   0.75</span></span>
<span><span class="co">#&gt; additive         4.9  1    1.21   0.29</span></span>
<span><span class="co">#&gt; rate:additive    4.0  1    0.98   0.34</span></span>
<span><span class="co">#&gt; Residuals       64.9 16</span></span></code></pre></div>
<p>The results above show significant main effects for <code>tear</code>,
a significant main effect of <code>rate</code> for <code>gloss</code>,
and no significant effects for <code>opacity</code>, but they don’t shed light on the
<em>nature</em> of these effects.
Traditional univariate plots of the means for each variable separately
are useful, but they don’t allow visualization of the
<em>relations</em> among the response variables.</p>
</div>
<div class="section level4" number="2.0.2">
<h4 id="he-plots">
<span class="header-section-number">2.0.2</span> HE plots<a class="anchor" aria-label="anchor" href="#he-plots"></a>
</h4>
<p>We can visualize these
effects for pairs of variables in an HE plot, showing the “size” and
orientation of hypothesis variation (<span class="math inline">\(\mathbf{H}\)</span>) in relation to error
variation (<span class="math inline">\(\mathbf{E}\)</span>) as ellipsoids.
When, as here, the model terms have 1 degree of freedom, the
<span class="math inline">\(\mathbf{H}\)</span> ellipsoids degenerate to a line.</p>
<p>In HE plots, the <span class="math inline">\(\mathbf{H}\)</span> ellipses can be scaled relative to the
<span class="math inline">\(\mathbf{E}\)</span> to show <strong>significance</strong> of effects (<code>size="evidence"</code>),
or <strong>effect size</strong> (<code>size="effect"</code>). In the former case, a model term
is significant (using Roy’s maximum root test) <em>iff</em> the
<span class="math inline">\(\mathbf{H}\)</span> projects anywhere outside the <span class="math inline">\(\mathbf{E}\)</span> ellipse.</p>
<p>This plot overlays those for both scaling, using thicker lines for the
effect scaling.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Compare evidence and effect scaling </span></span>
<span><span class="va">colors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, size<span class="op">=</span><span class="st">"evidence"</span>, </span>
<span>       col<span class="op">=</span><span class="va">colors</span>, cex<span class="op">=</span><span class="fl">1.25</span>,</span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, size<span class="op">=</span><span class="st">"effect"</span>, </span>
<span>       add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">5</span>, term.labels<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="va">colors</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plastic1a"></span>
<img src="fig/manova-plastic1a-1.png" alt="HE plot for effects on `tear` and `gloss` according to the factors `rate`, `additive` and their interaction, `rate:additive`. The thicker lines show effect size scaling; the thinner lines show significance scaling."><p class="caption">
Figure 2.1: HE plot for effects on <code>tear</code> and <code>gloss</code> according to the factors <code>rate</code>, <code>additive</code> and their interaction, <code>rate:additive</code>. The thicker lines show effect size scaling; the thinner lines show significance scaling.
</p>
</div>
<p>The interpretation can be easily read from the plot, at least for the two response variables
(<code>tear</code> and <code>gloss</code>) that are shown in this bivariate view. The effect of <code>rate</code> of extrusion is
highly significant: high rate shows greater <code>tear</code> compared to low rate. The effect of amount of
additive is not significant in this view, but high level of additive has greater <code>tear</code> and <code>gloss</code>.</p>
<p>With effect scaling, both the <span class="math inline">\(\mathbf{H}\)</span> and <span class="math inline">\(\mathbf{E}\)</span> sums of squares and products
matrices are both divided by the error df, giving multivariate analogs of univariate
measures of effect size, e.g., <span class="math inline">\((\bar{y}_1-\bar{y}_2) / s\)</span>.
With significance scaling, the <span class="math inline">\(\mathbf{H}\)</span> ellipse is further divided by
<span class="math inline">\(\lambda_\alpha\)</span>, the critical value of Roy’s largest root statistic.
This scaling has the property that an <span class="math inline">\(\mathbf{H}\)</span> ellipse will protrude somewhere
outside the <span class="math inline">\(\mathbf{E}\)</span> ellipse <em>iff</em> the
multivariate test is significant at level <span class="math inline">\(\alpha\)</span>.
Figure <a href="#fig:plastic1">2.2</a> shows both scalings, using a thinner line for significance scaling.
Note that the (degenerate) ellipse for <code>additive</code> is significant, but
does not protrude outside the <span class="math inline">\(\mathbf{E}\)</span> ellipse in this view.
All that is guaranteed is that it will protrude somewhere in the 3D space of
the responses.</p>
<p>By design, means for the levels of interaction terms are not shown in the HE plot,
because doing so in general can lead to messy displays.
We can add them here for the term <code>rate:additive</code> as follows:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare evidence and effect scaling </span></span>
<span><span class="va">colors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, size<span class="op">=</span><span class="st">"evidence"</span>, </span>
<span>       col<span class="op">=</span><span class="va">colors</span>, cex<span class="op">=</span><span class="fl">1.25</span>,</span>
<span>       fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha<span class="op">=</span><span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, size<span class="op">=</span><span class="st">"effect"</span>, </span>
<span>       add<span class="op">=</span><span class="cn">TRUE</span>, lwd<span class="op">=</span><span class="fl">5</span>, term.labels<span class="op">=</span><span class="cn">FALSE</span>, col<span class="op">=</span><span class="va">colors</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## add interaction means</span></span>
<span><span class="va">intMeans</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/termMeans.html">termMeans</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="st">'rate:additive'</span>, abbrev.levels<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">intMeans</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">intMeans</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, pch<span class="op">=</span><span class="fl">18</span>, cex<span class="op">=</span><span class="fl">1.2</span>, col<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">intMeans</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">intMeans</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">intMeans</span><span class="op">)</span>, </span>
<span>     adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, col<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">intMeans</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">intMeans</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">intMeans</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">intMeans</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fl">2</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"brown"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plastic1"></span>
<img src="fig/manova-plastic1-1.png" alt="HE plot for effects on `tear` and `gloss` according to the factors `rate`, `additive` and their interaction, `rate:additive`. Annotations have added means for the combinations of `rate` and `additive`."><p class="caption">
Figure 2.2: HE plot for effects on <code>tear</code> and <code>gloss</code> according to the factors <code>rate</code>, <code>additive</code> and their interaction, <code>rate:additive</code>. Annotations have added means for the combinations of <code>rate</code> and <code>additive</code>.
</p>
</div>
<p>The factor means in this plot (Figure <a href="#fig:plastic1">2.2</a> have a simple interpretation:
The high <code>rate</code> level yields greater <code>tear</code> resistance but lower <code>gloss</code>
than the low level.
The high <code>additive</code> amount produces greater <code>tear</code> resistance and greater <code>gloss</code>.</p>
<p>The <code>rate:additive</code> interaction is not significant overall, though it
approaches significance for <code>gloss</code>.
The cell means for the combinations
of <code>rate</code> and <code>additive</code> shown in this figure suggest an explanation,
for tutorial purposes:
with the low level of <code>rate</code>, there is little difference in <code>gloss</code>
for the levels of <code>additive</code>. At the high level of <code>rate</code>, there is
a larger difference in <code>gloss</code>. The <span class="math inline">\(\mathbf{H}\)</span> ellipse for the interaction
of <code>rate:additive</code> therefore “points” in the direction of <code>gloss</code>
indicating that this variable contributes to the interaction in the
multivariate tests.</p>
<p>In some MANOVA models, it is of interest to test sub-hypotheses
of a given main effect or interaction, or conversely to test composite
hypotheses that pool together certain effects to test them jointly.
All of these tests (and, indeed, the tests of terms in a given model)
are carried out as tests of general linear hypotheses in the MLM.</p>
<p>In this example, it might be useful to test two composite hypotheses:
one corresponding to both main effects jointly, and another corresponding
to no difference among the means of the four groups (equivalent to
a joint test for the overall model). These tests are specified in terms
of subsets or linear combinations of the model parameters.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plastic.mod</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = cbind(tear, gloss, opacity) ~ rate * additive, data = Plastic)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                        tear   gloss  opacity</span></span>
<span><span class="co">#&gt; (Intercept)             6.30   9.56   3.74  </span></span>
<span><span class="co">#&gt; rateHigh                0.58  -0.84  -0.60  </span></span>
<span><span class="co">#&gt; additiveHigh            0.38   0.02   0.10  </span></span>
<span><span class="co">#&gt; rateHigh:additiveHigh   0.02   0.66   1.78</span></span></code></pre></div>
<p>Thus, for example, the joint test of both main effects tests the parameters
<code>rateHigh</code> and <code>additiveHigh</code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rateHigh"</span>, <span class="st">"additiveHigh"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"Main effects"</span><span class="op">)</span>, </span>
<span>      SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: Main effects</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df   Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; Pillai            2   0.71161   2.7616      6     30 0.029394 * </span></span>
<span><span class="co">#&gt; Wilks             2   0.37410   2.9632      6     28 0.022839 * </span></span>
<span><span class="co">#&gt; Hotelling-Lawley  2   1.44400   3.1287      6     26 0.019176 * </span></span>
<span><span class="co">#&gt; Roy               2   1.26253   6.3127      3     15 0.005542 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">plastic.mod</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rateHigh"</span>, <span class="st">"additiveHigh"</span>, <span class="st">"rateHigh:additiveHigh"</span><span class="op">)</span>, </span>
<span>                       title<span class="op">=</span><span class="st">"Groups"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: Groups</span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df   Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            3   1.14560   3.2948      9 48.000 0.003350 ** </span></span>
<span><span class="co">#&gt; Wilks             3   0.17802   3.9252      9 34.223 0.001663 ** </span></span>
<span><span class="co">#&gt; Hotelling-Lawley  3   2.81752   3.9654      9 38.000 0.001245 ** </span></span>
<span><span class="co">#&gt; Roy               3   1.86960   9.9712      3 16.000 0.000603 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Correspondingly, we can display these tests in the HE plot by specifying these tests in the
<code>hypothesis</code> argument to <code><a href="../reference/heplot.html">heplot()</a></code>, as shown in Figure <a href="#fig:plastic2">2.3</a>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, </span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Group"</span> <span class="op">=</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rateHigh"</span>, <span class="st">"additiveHigh"</span>, <span class="st">"rateHigh:additiveHigh "</span><span class="op">)</span><span class="op">)</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"purple"</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">plastic.mod</span>, </span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Main effects"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rateHigh"</span>, <span class="st">"additiveHigh"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>       add<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"darkgreen"</span><span class="op">)</span>, cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plastic2"></span>
<img src="fig/manova-plastic2-1.png" alt="HE plot for `tear` and `gloss`, supplemented with ellipses representing
    the joint tests of main effects and all group differences"><p class="caption">
Figure 2.3: HE plot for <code>tear</code> and <code>gloss</code>, supplemented with ellipses representing
the joint tests of main effects and all group differences
</p>
</div>
<p>Finally, a 3D HE plot can be produced with <code><a href="../reference/heplot3d.html">heplot3d()</a></code>, giving Figure <a href="#fig:plastic1-HE3D">2.4</a>.
This plot was rotated interactively to a view that shows both main effects
protruding outside the error ellipsoid.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"darkblue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"brown"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot3d.html">heplot3d</a></span><span class="op">(</span><span class="va">plastic.mod</span>, col<span class="op">=</span><span class="va">colors</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:plastic1-HE3D"></span>
<img src="fig/plastic-HE3D.png" alt="3D HE plot for the plastic MLM" width="653"><p class="caption">
Figure 2.4: 3D HE plot for the plastic MLM
</p>
</div>
</div>
</div>
<div class="section level2" number="3">
<h2 id="effects-of-physical-attractiveness-on-mock-jury-decisions">
<span class="header-section-number">3</span> Effects of physical attractiveness on mock jury decisions<a class="anchor" aria-label="anchor" href="#effects-of-physical-attractiveness-on-mock-jury-decisions"></a>
</h2>
<p>In a social psychology
study of influences on jury decisions
by <span class="citation">Plaster (<a href="#ref-Plaster:89">1989</a>)</span>,
male participants (prison inmates)
were shown a picture of one of three young women.<br>
Pilot work
had indicated that one woman was beautiful, another of average physical
attractiveness, and the third unattractive. Participants rated the woman they
saw on each of twelve attributes on scales of 1–9. These measures were used to check on the
manipulation of “attractiveness” by the photo.</p>
<p>Then the participants were told that the person in the photo had committed a
Crime, and asked to rate the seriousness of the crime and recommend a
prison sentence, in Years. The data are contained in the data frame <code>MockJury</code>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;The data were made available courtesy of Karl Wuensch, from
&lt;a href="http://core.ecu.edu/psyc/wuenschk/StatData/PLASTER.dat" class="external-link"&gt;http://core.ecu.edu/psyc/wuenschk/StatData/PLASTER.dat&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">MockJury</span>, package <span class="op">=</span> <span class="st">"heplots"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">MockJury</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    114 obs. of  17 variables:</span></span>
<span><span class="co">#&gt;  $ Attr         : Factor w/ 3 levels "Beautiful","Average",..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Crime        : Factor w/ 2 levels "Burglary","Swindle": 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ Years        : int  10 3 5 1 7 7 3 7 2 3 ...</span></span>
<span><span class="co">#&gt;  $ Serious      : int  8 8 5 3 9 9 4 4 5 2 ...</span></span>
<span><span class="co">#&gt;  $ exciting     : int  6 9 3 3 1 1 5 4 4 6 ...</span></span>
<span><span class="co">#&gt;  $ calm         : int  9 5 4 6 1 5 6 9 8 8 ...</span></span>
<span><span class="co">#&gt;  $ independent  : int  9 9 6 9 5 7 7 2 8 7 ...</span></span>
<span><span class="co">#&gt;  $ sincere      : int  8 3 3 8 1 5 6 9 7 5 ...</span></span>
<span><span class="co">#&gt;  $ warm         : int  5 5 6 8 8 8 7 6 1 7 ...</span></span>
<span><span class="co">#&gt;  $ phyattr      : int  9 9 7 9 8 8 8 5 9 8 ...</span></span>
<span><span class="co">#&gt;  $ sociable     : int  9 9 4 9 9 9 7 2 1 9 ...</span></span>
<span><span class="co">#&gt;  $ kind         : int  9 4 2 9 4 5 5 9 5 7 ...</span></span>
<span><span class="co">#&gt;  $ intelligent  : int  6 9 4 9 7 8 7 9 9 9 ...</span></span>
<span><span class="co">#&gt;  $ strong       : int  9 5 5 9 9 9 5 2 7 5 ...</span></span>
<span><span class="co">#&gt;  $ sophisticated: int  9 5 4 9 9 9 6 2 7 6 ...</span></span>
<span><span class="co">#&gt;  $ happy        : int  5 5 5 9 8 9 5 2 6 8 ...</span></span>
<span><span class="co">#&gt;  $ ownPA        : int  9 7 5 9 7 9 6 5 3 6 ...</span></span></code></pre></div>
<p>Sample sizes were roughly balanced for the independent variables
in the three conditions of the attractiveness of the photo,
and the combinations of this with <code>Crime</code>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">MockJury</span><span class="op">$</span><span class="va">Attr</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    Beautiful      Average Unattractive </span></span>
<span><span class="co">#&gt;           39           38           37</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">MockJury</span><span class="op">$</span><span class="va">Attr</span>, <span class="va">MockJury</span><span class="op">$</span><span class="va">Crime</span><span class="op">)</span></span>
<span><span class="co">#&gt;               </span></span>
<span><span class="co">#&gt;                Burglary Swindle</span></span>
<span><span class="co">#&gt;   Beautiful          21      18</span></span>
<span><span class="co">#&gt;   Average            18      20</span></span>
<span><span class="co">#&gt;   Unattractive       20      17</span></span></code></pre></div>
<p>The main questions of interest were:</p>
<ul>
<li>Does attractiveness of the “defendant” influence the sentence or perceived seriousness of the crime?<br>
</li>
<li>Does attractiveness interact with the nature of the crime?</li>
</ul>
<div class="section level3" number="3.1">
<h3 id="manipulation-check">
<span class="header-section-number">3.1</span> Manipulation check<a class="anchor" aria-label="anchor" href="#manipulation-check"></a>
</h3>
<p>But first, as a check on the manipulation of attractiveness,
we try to assess the ratings of the photos in relation to the
presumed categories of the independent variable <code>Attr</code>. The questions here
are:</p>
<ul>
<li>do the ratings of the photos on physical attractiveness
(<code>phyattr</code>) confirm the original classification?</li>
<li>how do other ratings differentiate the photos?</li>
</ul>
<p>To keep things simple, we consider only a few of the other ratings in a one-way MANOVA.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">jury.mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">phyattr</span>, <span class="va">happy</span>, <span class="va">independent</span>, <span class="va">sophisticated</span><span class="op">)</span> <span class="op">~</span> <span class="va">Attr</span>, data<span class="op">=</span><span class="va">MockJury</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = cbind(phyattr, happy, independent, sophisticated) ~ </span></span>
<span><span class="co">#&gt;     Attr, data = MockJury)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                   phyattr  happy   independent  sophisticated</span></span>
<span><span class="co">#&gt; (Intercept)        8.282    5.359   6.410        6.077       </span></span>
<span><span class="co">#&gt; AttrAverage       -4.808    0.430   0.537       -1.340       </span></span>
<span><span class="co">#&gt; AttrUnattractive  -5.390   -1.359  -1.410       -1.753</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">jury.mod1</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;      Df test stat approx F num Df den Df Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Attr  2      1.77     48.2      4    109 &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Note that <code>Beautiful</code> is the baseline category of <code>Attr</code>, so the
intercept term gives the means for this level.
We see that the means are significantly different on all four variables
collectively, by a joint multivariate test. A traditional analysis might
follow up with univariate ANOVAs for each measure separately.</p>
<p>As an aid to interpretation of the MANOVA results
We can examine the test of <code>Attr</code> in this model with an HE plot for
pairs of variables, e.g., for <code>phyattr</code> and <code>happy</code> (Figure <a href="#fig:jury-mod1-HE">3.1</a>).
The means in this plot show that Beautiful is rated higher on
physical attractiveness than the other two photos, while Unattractive
is rated less happy than the other two. Comparing the sizes of the
ellipses, differences among group means on physical attractiveness
contributes more to significance than do ratings on happy.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">jury.mod1</span>, main<span class="op">=</span><span class="st">"HE plot for manipulation check"</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jury-mod1-HE"></span>
<img src="fig/manova-jury-mod1-HE-1.png" alt="HE plot for ratings of `phyattr` and `happy` according to the classification of photos on `Attr`"><p class="caption">
Figure 3.1: HE plot for ratings of <code>phyattr</code> and <code>happy</code> according to the classification of photos on <code>Attr</code>
</p>
</div>
<p>The function <code><a href="../reference/pairs.mlm.html">pairs.mlm()</a></code> produces all pairwise HE plots.
This plot (Figure <a href="#fig:jury-mod1-pairs">3.2</a>) shows that the means for <code>happy</code>
and <code>independent</code> are highly correlated, as are the means for <code>phyattr</code>
and <code>sophisticated</code>. In most of these pairwise plots, the means form a
triangle rather than a line, suggesting that these attributes are indeed
measuring different aspects of the photos.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">jury.mod1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jury-mod1-pairs"></span>
<img src="fig/manova-jury-mod1-pairs-1.png" alt="HE plots for all pairs of ratings according to the classification of photos on `Attr`"><p class="caption">
Figure 3.2: HE plots for all pairs of ratings according to the classification of photos on <code>Attr</code>
</p>
</div>
<p>With 3 groups and 4 variables, the <span class="math inline">\(\mathbf{H}\)</span> ellipsoid has only <span class="math inline">\(s=\min(df_h, p)=2\)</span>
dimensions. <code><a href="https://rdrr.io/pkg/candisc/man/candisc.html" class="external-link">candisc()</a></code> carries out a canonical discriminant analysis
for the MLM and returns an object that can be used to show an HE plot in the
space of the canonical dimensions. This is plotted in Figure <a href="#fig:jury-can1">3.3</a>.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">jury.can</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candisc.html" class="external-link">candisc</a></span><span class="op">(</span><span class="va">jury.mod1</span><span class="op">)</span></span>
<span><span class="va">jury.can</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Canonical Discriminant Analysis for Attr:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   CanRsq Eigenvalue Difference Percent Cumulative</span></span>
<span><span class="co">#&gt; 1  0.639      1.767        1.6   91.33       91.3</span></span>
<span><span class="co">#&gt; 2  0.144      0.168        1.6    8.67      100.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test of H0: The canonical correlations in the </span></span>
<span><span class="co">#&gt; current row and all that follow are zero</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   LR test stat approx F numDF denDF Pr(&gt; F)    </span></span>
<span><span class="co">#&gt; 1        0.309    21.53     8   216 &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; 2        0.856     6.09     3   109 0.00072 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><code>heplot.candisc()</code> is the HE plot method for <code>candisc</code> objects</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">jury.can</span>, </span>
<span>       rev.axes <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>       prefix<span class="op">=</span><span class="st">"Canonical dimension"</span>, </span>
<span>       main<span class="op">=</span><span class="st">"Canonical HE plot"</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jury-can1"></span>
<img src="fig/manova-jury-can1-1.png" alt="Canonical discriminant HE plot for the MockJury data. Variable vectors show the correlations of the predictors with the canonical dimensions."><p class="caption">
Figure 3.3: Canonical discriminant HE plot for the MockJury data. Variable vectors show the correlations of the predictors with the canonical dimensions.
</p>
</div>
<pre><code><span><span class="co">#&gt; Vector scale factor set to  8.8177</span></span></code></pre>
<p>In this plot,</p>
<ul>
<li><p>the variable vectors are determined by the canonical structure
coefficients and represent the correlations of the predictor variables with
the canonical variables. Thus, an angle near zero with an axis represents a
correlation close to 1.0; an angle near 90<span class="math inline">\(^o\)</span> represent a correlation close to 0.0.
(The axes must be scaled to have equal unit lengths for angles to be interpretable.)</p></li>
<li><p>The lengths of arrows are scaled to roughly fill the plot, but relative length
represents the overall strength of the relation of the variable with the canonical dimensions.</p></li>
<li><p>Points represent the means of the canonical scores on the two dimensions for the three groups of photos.</p></li>
</ul>
<p>From this we can see that 91% of the variation among group means
is accounted for by the first dimension, and this is nearly completely
aligned with <code>phyattr</code>.
The second dimension, accounting for the remaining 9%
is determined nearly entirely by ratings on <code>happy</code> and <code>independent</code>.
This display gives a relatively simple account of the results of the MANOVA
and the relations of each of the ratings to discrimination among the photos.</p>
</div>
<div class="section level3" number="3.2">
<h3 id="main-analysis">
<span class="header-section-number">3.2</span> Main analysis<a class="anchor" aria-label="anchor" href="#main-analysis"></a>
</h3>
<p>Proceeding to the main questions of interest, we carry out a two-way MANOVA of the responses
<code>Years</code> and <code>Serious</code> in relation to the independent variables
<code>Attr</code> and <code>Crime</code>.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># influence of Attr of photo and nature of crime on Serious and Years</span></span>
<span><span class="va">jury.mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Serious</span>, <span class="va">Years</span><span class="op">)</span> <span class="op">~</span> <span class="va">Attr</span> <span class="op">*</span> <span class="va">Crime</span>, data<span class="op">=</span><span class="va">MockJury</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">jury.mod2</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;            Df test stat approx F num Df den Df Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; Attr        2    0.0756     4.08      2    108  0.020 *</span></span>
<span><span class="co">#&gt; Crime       1    0.0047     0.25      2    107  0.778  </span></span>
<span><span class="co">#&gt; Attr:Crime  2    0.0501     2.71      2    108  0.071 .</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>We see that there is a nearly significant interaction between <code>Attr</code> and <code>Crime</code>
and a strong effect of <code>Attr</code>.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">jury.mod2</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jury-mod2-HE"></span>
<img src="fig/manova-jury-mod2-HE-1.png" alt="HE plot for the two-way MANOVA for `Years` and `Serious`"><p class="caption">
Figure 3.4: HE plot for the two-way MANOVA for <code>Years</code> and <code>Serious</code>
</p>
</div>
<p>The HE plot shows that the nearly significant
interaction of <code>Attr:Crime</code> is mainly in terms of
differences among the groups on the response of <code>Years</code> of sentence,
with very little contribution of <code>Serious</code>. We explore this interaction in a bit more detail
below. The main effect of <code>Attr</code> is also dominated by differences among groups
on <code>Years</code>.</p>
<p>If we assume that <code>Years</code> of sentence is the main outcome of interest,
it also makes sense to carry out a step-down test of this variable by itself,
controlling for the rating of seriousness (<code>Serious</code>) of the crime.
The model <code>jury.mod3</code> below is equivalent to an ANCOVA for <code>Years</code>.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># stepdown test (ANCOVA), controlling for Serious</span></span>
<span><span class="va">jury.mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span> <span class="va">Years</span> <span class="op">~</span> <span class="va">Serious</span> <span class="op">+</span> <span class="va">Attr</span> <span class="op">*</span> <span class="va">Crime</span>, data<span class="op">=</span><span class="va">MockJury</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">jury.mod3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;      (Intercept) Serious AttrAverage AttrUnattractive CrimeSwindle</span></span>
<span><span class="co">#&gt; [1,]    0.011612 0.83711     0.39586          0.60285     -0.26302</span></span>
<span><span class="co">#&gt;      AttrAverage:CrimeSwindle AttrUnattractive:CrimeSwindle</span></span>
<span><span class="co">#&gt; [1,]                 -0.53701                        2.5123</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">jury.mod3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Anova Table (Type II tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: Years</span></span>
<span><span class="co">#&gt;            Sum Sq  Df F value  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Serious       379   1   41.14 3.9e-09 ***</span></span>
<span><span class="co">#&gt; Attr           74   2    4.02   0.021 *  </span></span>
<span><span class="co">#&gt; Crime           4   1    0.43   0.516    </span></span>
<span><span class="co">#&gt; Attr:Crime     49   2    2.67   0.074 .  </span></span>
<span><span class="co">#&gt; Residuals     987 107                    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Thus, even when adjusting for <code>Serious</code> rating, there is still a
significant main effect of <code>Attr</code> of the photo, but also a hint of
an interaction of <code>Attr</code> with <code>Crime</code>. The coefficient for
<code>Serious</code> indicates that participants awarded 0.84 additional
years of sentence for each 1 unit step on the scale of seriousness of crime.</p>
<p>A particularly useful
method for visualizing the fitted effects in such univariate response
models is provided by the <code>effects</code>. By default <code><a href="https://rdrr.io/pkg/effects/man/effect.html" class="external-link">allEffects()</a></code>
calculates the predicted values for all high-order terms in a given
model, and the <code>plot</code> method produces plots of these values for
each term. The statements below produce Figure <a href="#fig:jury-mod3-eff">3.5</a>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.r-project.org" class="external-link">effects</a></span><span class="op">)</span></span>
<span><span class="va">jury.eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/effects/man/effect.html" class="external-link">allEffects</a></span><span class="op">(</span><span class="va">jury.mod3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">jury.eff</span>, ask<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:jury-mod3-eff"></span>
<img src="fig/manova-jury-mod3-eff-1.png" alt="Effect plots for  `Serious` and the `Attr * Crime` interaction in the ANCOVA model `jury.mod3`."><p class="caption">
Figure 3.5: Effect plots for <code>Serious</code> and the <code>Attr * Crime</code> interaction in the ANCOVA model <code>jury.mod3</code>.
</p>
</div>
<!-- \includegraphics[width=\textwidth]{fig/plot-jury-mod3-eff} -->
<!-- \caption{Effect plots for  `Serious` and the `Attr * Crime` -->
<!--     in the ANCOVA model `jury.mod3`.} -->
<!--  {#fig:jury-mod3-eff} -->
<p>The effect plot for <code>Serious</code> shows the expected linear relation
between that variable and <code>Years</code>. Of greater interest here is the nature
of the possible interaction of <code>Attr</code> and <code>Crime</code> on <code>Years</code>
of sentence, controlling for <code>Serious</code>.
The effect plot shows that for the crime of Swindle, there is a much
greater <code>Years</code> of sentence awarded to Unattractive defendants.</p>
</div>
</div>
<div class="section level2" number="4">
<h2 id="egyptian-skulls-from-five-epochs">
<span class="header-section-number">4</span> Egyptian skulls from five epochs<a class="anchor" aria-label="anchor" href="#egyptian-skulls-from-five-epochs"></a>
</h2>
<p>This example examines physical measurements of size and shape made on
150 Egyptian skulls from five epochs ranging from
4000 BC to 150 AD.
The measures are: maximal breadth (<code>mb</code>), basibregmatic height (<code>bh</code>),
basialiveolar length (<code>bl</code>), and nasal height (<code>nh</code>) of each skull.
<!-- See [http://www.redwoods.edu/instruct/agarwin/anth_6_measurements.htm] -->
<!-- for the definitions of these measures, and Figure \@ref(fig:skulls) for a diagram. -->
See Figure <a href="#fig:skulls">4.1</a> for a diagram.
The question of interest is whether and how these measurements change over time.
Systematic changes over time is of interest because this
would indicate interbreeding with immigrant populations.</p>
<div class="figure">
<span style="display:block;" id="fig:skulls"></span>
<img src="fig/skulls.jpg" alt='Diagram of the skull measurements. Maximal breadth and basibregmatic height are the basic measures of "size" of a skull.  Basialveolar length and nasal height are important anthropometric measures of "shape".' width="60%"><p class="caption">
Figure 4.1: Diagram of the skull measurements. Maximal breadth and basibregmatic height are the basic measures of “size” of a skull. Basialveolar length and nasal height are important anthropometric measures of “shape”.
</p>
</div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    150 obs. of  5 variables:</span></span>
<span><span class="co">#&gt;  $ epoch: Ord.factor w/ 5 levels "c4000BC"&lt;"c3300BC"&lt;..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span><span class="co">#&gt;  $ mb   : num  131 125 131 119 136 138 139 125 131 134 ...</span></span>
<span><span class="co">#&gt;  $ bh   : num  138 131 132 132 143 137 130 136 134 134 ...</span></span>
<span><span class="co">#&gt;  $ bl   : num  89 92 99 96 100 89 108 93 102 99 ...</span></span>
<span><span class="co">#&gt;  $ nh   : num  49 48 50 44 54 56 48 48 51 51 ...</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; c4000BC c3300BC c1850BC  c200BC  cAD150 </span></span>
<span><span class="co">#&gt;      30      30      30      30      30</span></span></code></pre></div>
<p>Note that <code>epoch</code> is an ordered factor, so the default contrasts
will be orthogonal polynomials. This assumes that <code>epoch</code>
values are equally spaced, which they are not. However, examining
the linear and quadratic trends is useful to a first approximation.</p>
<p>For ease of labeling various outputs, it is useful to trim the
<code>epoch</code> values and assign more meaningful variable labels.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make shorter labels for epochs</span></span>
<span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"c"</span>,<span class="st">""</span>,<span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># assign better variable labels</span></span>
<span><span class="va">vlab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"maxBreadth"</span>, <span class="st">"basibHeight"</span>, <span class="st">"basialLength"</span>, <span class="st">"nasalHeight"</span><span class="op">)</span></span></code></pre></div>
<p>We start with some simple displays of the means by epoch. From the numbers,
the means don’t seem to vary much.<br>
A <code>pairs</code> plot, Figure <a href="#fig:skulls4">4.2</a>, joining points
by <code>epoch</code> is somewhat more revealing for the bivariate relations among means.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mb</span>, <span class="va">bh</span>, <span class="va">bl</span>, <span class="va">nh</span><span class="op">)</span> <span class="op">~</span> <span class="va">epoch</span>, data<span class="op">=</span><span class="va">Skulls</span>, FUN<span class="op">=</span><span class="va">mean</span><span class="op">)</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">means</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span><span class="op">)</span></span>
<span><span class="va">means</span></span>
<span><span class="co">#&gt;            mb     bh     bl     nh</span></span>
<span><span class="co">#&gt; 4000BC 131.37 133.60 99.167 50.533</span></span>
<span><span class="co">#&gt; 3300BC 132.37 132.70 99.067 50.233</span></span>
<span><span class="co">#&gt; 1850BC 134.47 133.80 96.033 50.567</span></span>
<span><span class="co">#&gt; 200BC  135.50 132.30 94.533 51.967</span></span>
<span><span class="co">#&gt; AD150  136.17 130.33 93.500 51.367</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">means</span>, <span class="va">vlab</span>,</span>
<span>      panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Skulls</span><span class="op">$</span><span class="va">epoch</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:skulls4"></span>
<img src="fig/manova-skulls4-1.png" alt="Pairs plot of means of Skulls data, by epoch."><p class="caption">
Figure 4.2: Pairs plot of means of Skulls data, by epoch.
</p>
</div>
<p>Perhaps better for visualizing the trends over time is a set of boxplots,
joining means over <code>epoch</code>. Using <code><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot()</a></code> from the <code>lattice</code>
package requires reshaping the data from wide to long format. The following
code produces Figure <a href="#fig:skulls-bwplot">4.3</a>.</p>
<!-- TODO: do this with ggplot2 -->
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lattice.r-forge.r-project.org/" class="external-link">lattice</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape" class="external-link">reshape2</a></span><span class="op">)</span></span>
<span><span class="va">sklong</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">Skulls</span>, id<span class="op">=</span><span class="st">"epoch"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/xyplot.html" class="external-link">bwplot</a></span><span class="op">(</span><span class="va">value</span> <span class="op">~</span> <span class="va">epoch</span> <span class="op">|</span> <span class="va">variable</span>, data<span class="op">=</span><span class="va">sklong</span>, scales<span class="op">=</span><span class="st">"free"</span>, </span>
<span>    ylab<span class="op">=</span><span class="st">"Variable value"</span>, xlab<span class="op">=</span><span class="st">"Epoch"</span>,</span>
<span>    strip<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/lattice/man/strip.default.html" class="external-link">strip.custom</a></span><span class="op">(</span>factor.levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">vlab</span>,</span>
<span>                                           <span class="st">" ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">sklong</span><span class="op">$</span><span class="va">variable</span><span class="op">)</span>, <span class="st">")"</span>,</span>
<span>                                           sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    panel <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.bwplot.html" class="external-link">panel.bwplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">...</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/pkg/lattice/man/panel.functions.html" class="external-link">panel.linejoin</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span>, col<span class="op">=</span><span class="st">"red"</span>, <span class="va">...</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span> </span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:skulls-bwplot"></span>
<img src="fig/manova-skulls-bwplot-1.png" alt="Boxplots of Skulls data, by epoch, for each variable."><p class="caption">
Figure 4.3: Boxplots of Skulls data, by epoch, for each variable.
</p>
</div>
<p>The trend lines aren’t linear, but neither are they random, so something systematic has been going
on!</p>
<p>Now, fit the MANOVA model, and test the effect of <code>epoch</code> with <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">car::Anova()</a></code>.
We see that the multivariate means differ substantially.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># fit manova model</span></span>
<span><span class="va">sk.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mb</span>, <span class="va">bh</span>, <span class="va">bl</span>, <span class="va">nh</span><span class="op">)</span> <span class="op">~</span> <span class="va">epoch</span>, data<span class="op">=</span><span class="va">Skulls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">sk.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;       Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; epoch  4     0.353     3.51     16    580 4.7e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Perhaps of greater interest are the more focused tests of trends over time.
These are based on tests of the coefficients in the model <code>sk.mod</code>
being jointly equal to zero, for subsets of the
(polynomial) contrasts in <code>epoch</code>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sk.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    mb        bh        bl       nh</span></span>
<span><span class="co">#&gt; (Intercept) 133.97333 132.54667 96.460000 50.93333</span></span>
<span><span class="co">#&gt; epoch.L       4.02663  -2.19251 -5.017481  1.07517</span></span>
<span><span class="co">#&gt; epoch.Q      -0.46325  -1.26504 -0.089087  0.12472</span></span>
<span><span class="co">#&gt; epoch.C      -0.46380  -0.78003  1.075174 -0.83273</span></span>
<span><span class="co">#&gt; epoch^4       0.34263   0.80479 -0.661360 -0.41833</span></span></code></pre></div>
<p>We use <code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> for a multivariate test of the
<code>epoch.L</code> linear effect.
The linear trend is highly significant. It is not obvious from
Figure <a href="#fig:skulls4">4.2</a> that maximal breadth and nasal are increasing
over time, while the other two measurements have negative slopes.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sk.mod</span><span class="op">)</span><span class="op">[</span><span class="st">"epoch.L"</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;      mb      bh      bl      nh </span></span>
<span><span class="co">#&gt;  4.0266 -2.1925 -5.0175  1.0752</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">sk.mod</span>, <span class="st">"epoch.L"</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># linear component</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            1   0.29138   14.597      4    142 5.195e-10 ***</span></span>
<span><span class="co">#&gt; Wilks             1   0.70862   14.597      4    142 5.195e-10 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  1   0.41119   14.597      4    142 5.195e-10 ***</span></span>
<span><span class="co">#&gt; Roy               1   0.41119   14.597      4    142 5.195e-10 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> can also be used to test composite hypotheses.
Here we test all non-linear coefficients jointly. The result indicates
that, collectively, all non-linear terms are not significantly different
from zero.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">sk.mod</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"epoch.Q"</span>, <span class="st">"epoch.C"</span>, <span class="st">"epoch^4"</span><span class="op">)</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df Pr(&gt;F)</span></span>
<span><span class="co">#&gt; Pillai            3   0.06819  0.83726     12 432.00 0.6119</span></span>
<span><span class="co">#&gt; Wilks             3   0.93296  0.83263     12 375.99 0.6167</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  3   0.07063  0.82791     12 422.00 0.6216</span></span>
<span><span class="co">#&gt; Roy               3   0.04519  1.62676      4 144.00 0.1707</span></span></code></pre></div>
<p>Again, HE plots can show the patterns of these tests of multivariate hypotheses.
With four response variables, it is easiest to look at all pairwise
HE plots with the <code><a href="../reference/pairs.mlm.html">pairs.mlm()</a></code> function.
The statement below produces Figure <a href="#fig:skulls-HE-pairs">4.4</a>.
In this plot, we show the hypothesis ellipsoids for the overall
effect of <code>epoch</code>, as well as those for the tests just shown
for the linear trend component <code>epoch.L</code>
as well as the joint test of all non-linear terms.</p>
<!-- TODO: shorten labels -->
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">sk.mod</span>, variables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>    hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Lin<span class="op">=</span><span class="st">"epoch.L"</span>, </span>
<span>                    NonLin<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"epoch.Q"</span>, <span class="st">"epoch.C"</span>, <span class="st">"epoch^4"</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    var.labels<span class="op">=</span><span class="va">vlab</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<span style="display:block;" id="fig:skulls-HE-pairs"></span>
<img src="fig/manova-skulls-HE-pairs-1.png" alt="Pairs HE plot of Skulls data, showing multivariate tests of `epoch`, as well as tests of linear and nonlinear trends." width="100%"><p class="caption">
Figure 4.4: Pairs HE plot of Skulls data, showing multivariate tests of <code>epoch</code>, as well as tests of linear and nonlinear trends.
</p>
</div>
<!--    \includegraphics[width=.8\textwidth]{fig/plot-skulls-HE-pairs} -->
<!-- \caption{Pairs HE plot of Skulls data, showing multivariate tests of -->
<!--    `epoch`, as well as tests of linear and nonlinear trends.} -->
<!--  {#fig:skulls-HE-pairs} -->
<p>These plots have an interesting geometric interpretation:
the <span class="math inline">\(\mathbf{H}\)</span> ellipses for the overall effect of <code>epoch</code>
are representations of the additive decomposition of this effect into<br><span class="math inline">\(\mathbf{H}\)</span> ellipses for the linear and nonlinear linear
hypothesis tests according to</p>
<p><span class="math display">\[\mathbf{H}_{\textrm{epoch}} = \mathbf{H}_{\textrm{linear}} + \mathbf{H}_{\textrm{nonlinear}}\]</span></p>
<p>where the linear term has rank 1 (and so plots as a line), while the nonlinear
term has rank 3. In each panel, it can be seen that the large direction of
the <span class="math inline">\(\mathbf{H}_{\textrm{epoch}}\)</span> leading to significance of this effect corresponds
essentially to the linear contrast. <span class="math inline">\(\mathbf{H}_{\textrm{nonlinear}}\)</span> is the orthogonal
complement of <span class="math inline">\(\mathbf{H}_{\textrm{linear}}\)</span> in the space of <span class="math inline">\(\mathbf{H}_{\textrm{epoch}}\)</span>,
but nowhere does it protrude beyond the boundary of the <span class="math inline">\(\mathbf{E}\)</span> ellipsoid.</p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-FoxFriendlyMonette:09:compstat" class="csl-entry">
Fox, J., Friendly, M., &amp; Monette, G. (2009). Visualizing hypothesis tests in multivariate linear models: The <em>heplots</em> package for <span>R</span>. <em>Computational Statistics</em>, <em>24</em>(2), 233–246.
</div>
<div id="ref-Friendly:06:hesoft" class="csl-entry">
Friendly, M. (2006). Data ellipses, <span>HE</span> plots and reduced-rank displays for multivariate linear models: <span>SAS</span> software and examples. <em>Journal of Statistical Software</em>, <em>17</em>(6), 1–42.
</div>
<div id="ref-Friendly:07:manova" class="csl-entry">
Friendly, M. (2007). <span>HE</span> plots for multivariate general linear models. <em>Journal of Computational and Graphical Statistics</em>, <em>16</em>(2), 421–444.
</div>
<div id="ref-JohnsonWichern:92" class="csl-entry">
Johnson, R., &amp; Wichern, D. (1992). <em>Applied multivariate statistical analysis</em>. Englewood Cliffs, N.J: Prentice Hall.
</div>
<div id="ref-Plaster:89" class="csl-entry">
Plaster, M. E. (1989). <em>The effect of defendent physical attractiveness on juridic decisions using felon inmates as mock jurors</em> (Unpublished master's thesis). East Carolina University, Greenville, NC.
</div>
<div id="ref-Warne2014" class="csl-entry">
Warne, F. T. (2014). A primer on multivariate analysis of variance(MANOVA) for behavioral scientists. <em>Practical Assessment, Research &amp; Evaluation</em>, <em>19</em>(1). Retrieved from <a href="https://scholarworks.umass.edu/pare/vol19/iss1/17/" class="external-link">https://scholarworks.umass.edu/pare/vol19/iss1/17/</a>
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.8.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
