<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="heplots">
<title>HE plot MMRA Examples • heplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.7/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="HE plot MMRA Examples">
<meta property="og:description" content="heplots">
<meta property="og:image" content="https://friendly.github.io/heplots/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a>
    <a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>HE plot MMRA Examples</h1>
                        <h4 data-toc-skip class="author">Michael Friendly</h4>
            
            <h4 data-toc-skip class="date">2023-12-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/vignettes/HE_mmra.Rmd" class="external-link"><code>vignettes/HE_mmra.Rmd</code></a></small>
      <div class="d-none name"><code>HE_mmra.Rmd</code></div>
    </div>

    
    
<!--
  bookdown::html_document2:
  rmarkdown::html_vignette:

    theme: flatly
    toc: yes
    toc_depth: 1
bibliography: lib.bib
-->
<p>Vignette built using <code>heplots</code>, version 1.6.1
and <code>candisc</code>, version 0.8-6.</p>
<div class="section level2">
<h2 id="multivariate-multiple-regression-designs">Multivariate Multiple Regression Designs<a class="anchor" aria-label="anchor" href="#multivariate-multiple-regression-designs"></a>
</h2>
<p>The ideas behind HE plots extend naturally to multivariate multiple
regression (MMRA) and multivariate analysis of covariance (MANCOVA).
In MMRA designs, the <span class="math inline">\(\mathbf{X}\)</span> matrix contains only quantitative predictors, while
in MANCOVA designs, it contains a mixture of
factors and quantitative predictors (covariates), but typically there is just
one “group” factor.</p>
<p>In the MANCOVA case,
there is often a subtle difference in emphasis: true MANCOVA analyses focus on
the differences among groups defined by the factors, <strong>adjusting for</strong>
(or controlling for) the quantitative covariates. Analyses concerned
with <strong>homogeneity of regression</strong> focus on quantitative predictors
and attempt to test whether the regression relations are the same for
all groups defined by the factors.</p>
</div>
<div class="section level2" number="1">
<h2 id="rohwer-data-aptitude-and-achievement">
<span class="header-section-number">1</span> Rohwer data: Aptitude and achievement<a class="anchor" aria-label="anchor" href="#rohwer-data-aptitude-and-achievement"></a>
</h2>
<p>To illustrate the homogeneity of regression flavor,
we use data
from a study by Rohwer (given in <span class="citation">Timm (<a href="#ref-Timm:75">1975</a>)</span>, Ex. 4.3, 4.7, and 4.23)
on kindergarten children, designed to determine how well a set of
paired-associate (PA) tasks predicted performance on measures of achievement:</p>
<ul>
<li>the Peabody Picture Vocabulary test (<code>PPVT</code>),</li>
<li>a student achievement test (<code>SAT</code>), and</li>
<li>the Raven Progressive matrices test (<code>Raven</code>).</li>
</ul>
<p>The PA tasks were considered measures of learning aptitude and
varied in how the stimuli were presented, and are called <em>named</em> (<code>n</code>), <em>still</em> (<code>s</code>), <em>named still</em> (<code>ns</code>),
<em>named action</em> (<code>na</code>), and <em>sentence still</em> (<code>ss</code>).</p>
<p>Two groups were tested: a group of <span class="math inline">\(n=37\)</span> children from a low socioeconomic
status (SES) school, and a group of <span class="math inline">\(n=32\)</span> high SES children from an
upper-class, white residential school. The data are in the data frame
<code>Rohwer</code> in the <code>heplots</code> package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Rohwer</span><span class="op">)</span></span>
<span><span class="va">Rohwer</span> <span class="op">|&gt;</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html" class="external-link">sample_n</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;    group SES SAT PPVT Raven n  s ns na ss</span></span>
<span><span class="co">#&gt; 31     1  Lo   9   63    11 2 12  5 25 14</span></span>
<span><span class="co">#&gt; 7      1  Lo   6   71    21 0  1 20 23 18</span></span>
<span><span class="co">#&gt; 18     1  Lo  45   54    10 0  6  6 14 16</span></span>
<span><span class="co">#&gt; 17     1  Lo  19   66    13 7 12 21 35 27</span></span>
<span><span class="co">#&gt; 50     2  Hi   4   87    14 1  4 14 25 19</span></span>
<span><span class="co">#&gt; 59     2  Hi  36   89    15 1  6 15 23 28</span></span></code></pre></div>
<div class="section level3" number="1.1">
<h3 id="preliminary-plots">
<span class="header-section-number">1.1</span> Preliminary plots<a class="anchor" aria-label="anchor" href="#preliminary-plots"></a>
</h3>
<p>Before fitting models, it is usually useful to do some data exploration and graphing.
With multivariate multiple regression data, among the most helpful plots are scatterplots
of each response variable, Y, against each predictor, X, and we can get a better sense of
the relationships by adding linear regression lines, loess smooths or other enhancements.</p>
<p>A scatterplot matrix, using <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">graphics::pairs()</a></code> or <code><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">GGally::ggpairs()</a></code> is easy to do.
However, with 3 response variables, 4 predictors and a group factor (<code>SES</code>), this can
be overwhelming. An alternative is to compose a rectangular matrix of plots for
only the Y variables against the Xs.</p>
<p>This turned out to be not as easy as it might seem, because none of the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> methods
allow for this possibility. The trick is to reshape the data from wide to long format
and use facets in <code>ggplot2</code> to compose the pairwise scatterplots into the desired
rectangular matrix format.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This solution was suggested in an answer to a Stackoverflow question, &lt;a href="https://stackoverflow.com/questions/73859139/how-to-make-a-scatterplot-rectangular-matrix-y1-y2-x1-x2-in-r" class="external-link uri"&gt;https://stackoverflow.com/questions/73859139/how-to-make-a-scatterplot-rectangular-matrix-y1-y2-x1-x2-in-r&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a></p>
<!-- TODO: retain original variable order -->
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">yvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SAT"</span>, <span class="st">"PPVT"</span>, <span class="st">"Raven"</span> <span class="op">)</span>      <span class="co"># outcome variables</span></span>
<span><span class="va">xvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span>   <span class="co"># predictors</span></span>
<span><span class="va">xvars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span><span class="op">)</span>               <span class="co"># make a smaller example</span></span>
<span></span>
<span><span class="va">Rohwer_long</span> <span class="op">&lt;-</span> <span class="va">Rohwer</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">group</span>, <span class="op">-</span><span class="va">na</span>, <span class="op">-</span><span class="va">ss</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">xvars</span><span class="op">)</span>, </span>
<span>                      names_to <span class="op">=</span> <span class="st">"xvar"</span>, values_to <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/all_of.html" class="external-link">all_of</a></span><span class="op">(</span><span class="va">yvars</span><span class="op">)</span>, </span>
<span>                      names_to <span class="op">=</span> <span class="st">"yvar"</span>, values_to <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>xvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">xvar</span>, levels <span class="op">=</span> <span class="va">xvars</span><span class="op">)</span>,</span>
<span>                yvar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">yvar</span>, levels <span class="op">=</span> <span class="va">yvars</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Rohwer_long</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 621 × 5</span></span></span>
<span><span class="co">#&gt;    SES   xvar      x yvar      y</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Lo    n         1 SAT      49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Lo    n         1 PPVT     48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Lo    n         1 Raven     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Lo    s         2 SAT      49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Lo    s         2 PPVT     48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Lo    s         2 Raven     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Lo    ns        6 SAT      49</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Lo    ns        6 PPVT     48</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Lo    ns        6 Raven     8</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Lo    n         5 SAT      47</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 611 more rows</span></span></span></code></pre></div>
<p>Then, we can use <code>ggplot2</code> to make produce the pairwise plots for each combination of <code>x</code> and <code>y</code> variables. Using <code>color=SES</code> in the aesthetic results in a separate regression line for
the two SES groups produced by <code><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth()</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">Rohwer_long</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, color <span class="op">=</span> <span class="va">SES</span>, shape <span class="op">=</span> <span class="va">SES</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, </span>
<span>              se <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>              formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, </span>
<span>              size<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="external-link">facet_grid</a></span><span class="op">(</span><span class="va">yvar</span> <span class="op">~</span> <span class="va">xvar</span>,            <span class="co"># plot matrix of Y by X</span></span>
<span>             scales <span class="op">=</span> <span class="st">"free"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">16</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-long-ggplot"></span>
<img src="fig/mmra-rohwer-long-ggplot-1.png" alt="Plot matrix of the response variables (`SAT`, `PPVT` and `Raven`) against each of three predictors (`n`, `s`, `ns`). The lines show separate linear regressions for each SES group."><p class="caption">
Figure 1.1: Plot matrix of the response variables (<code>SAT</code>, <code>PPVT</code> and <code>Raven</code>) against each of three predictors (<code>n</code>, <code>s</code>, <code>ns</code>). The lines show separate linear regressions for each SES group.
</p>
</div>
<p>Such plots form a framework for understanding model fits and statistical tests we turn to now.</p>
</div>
<div class="section level3" number="1.2">
<h3 id="separate-models">
<span class="header-section-number">1.2</span> Separate models<a class="anchor" aria-label="anchor" href="#separate-models"></a>
</h3>
<p>As one approach, we might be tempted to fit separate regression models for each
of the High and Low SES groups. This approach is <em>not</em> generally recommended because it
lacks power (smaller sample sizes in each group than a combined analysis)
and does not allow hypotheses about equality of slopes and intercepts
to be tested directly.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rohwer.ses1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, data<span class="op">=</span><span class="va">Rohwer</span>, </span>
<span>                  subset<span class="op">=</span><span class="va">SES</span><span class="op">==</span><span class="st">"Hi"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">rohwer.ses1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; n   1     0.202     2.02      3     24 0.1376   </span></span>
<span><span class="co">#&gt; s   1     0.310     3.59      3     24 0.0284 * </span></span>
<span><span class="co">#&gt; ns  1     0.358     4.46      3     24 0.0126 * </span></span>
<span><span class="co">#&gt; na  1     0.465     6.96      3     24 0.0016 **</span></span>
<span><span class="co">#&gt; ss  1     0.089     0.78      3     24 0.5173   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span></span>
<span><span class="va">rohwer.ses2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, data<span class="op">=</span><span class="va">Rohwer</span>, </span>
<span>                  subset<span class="op">=</span><span class="va">SES</span><span class="op">==</span><span class="st">"Lo"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">rohwer.ses2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;    Df test stat approx F num Df den Df Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; n   1    0.0384     0.39      3     29  0.764  </span></span>
<span><span class="co">#&gt; s   1    0.1118     1.22      3     29  0.321  </span></span>
<span><span class="co">#&gt; ns  1    0.2252     2.81      3     29  0.057 .</span></span>
<span><span class="co">#&gt; na  1    0.2675     3.53      3     29  0.027 *</span></span>
<span><span class="co">#&gt; ss  1    0.1390     1.56      3     29  0.220  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>This fits separate slopes and intercepts for each of the two groups, but it is difficult
to compare the coefficients numerically.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">rohwer.ses1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  SAT     PPVT    Raven</span></span>
<span><span class="co">#&gt; (Intercept) -28.4675 39.69709 13.24384</span></span>
<span><span class="co">#&gt; n             3.2571  0.06728  0.05935</span></span>
<span><span class="co">#&gt; s             2.9966  0.36998  0.49244</span></span>
<span><span class="co">#&gt; ns           -5.8591 -0.37438 -0.16402</span></span>
<span><span class="co">#&gt; na            5.6662  1.52301  0.11898</span></span>
<span><span class="co">#&gt; ss           -0.6227  0.41016 -0.12116</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">rohwer.ses2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  SAT     PPVT    Raven</span></span>
<span><span class="co">#&gt; (Intercept)  4.15106 33.00577 11.17338</span></span>
<span><span class="co">#&gt; n           -0.60887 -0.08057  0.21100</span></span>
<span><span class="co">#&gt; s           -0.05016 -0.72105  0.06457</span></span>
<span><span class="co">#&gt; ns          -1.73240 -0.29830  0.21358</span></span>
<span><span class="co">#&gt; na           0.49456  1.47042 -0.03732</span></span>
<span><span class="co">#&gt; ss           2.24772  0.32396 -0.05214</span></span></code></pre></div>
<p>The function <code><a href="../reference/coefplot.html">heplots::coefplot()</a></code> makes this a bit easier, by plotting bivariate confidence ellipses for the
coefficients in a multivariate linear model. In this problem, with three response variables,
the 95% confidence regions are 3D ellipsoids, but we only plot them in 2D.
The 3D versions have the property that a given predictor is significant by a multivariate test if
the ellipsoid excludes the point (0, 0, 0).</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">rohwer.ses1</span>, fill<span class="op">=</span><span class="cn">TRUE</span>, cex.label<span class="op">=</span><span class="fl">1.5</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">3</span>, <span class="st">"High SES group"</span>, pos<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/coefplot.html">coefplot</a></span><span class="op">(</span><span class="va">rohwer.ses2</span>, fill<span class="op">=</span><span class="cn">TRUE</span>, cex.label<span class="op">=</span><span class="fl">1.5</span>, cex.lab<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4.7</span>, <span class="fl">2.5</span>, <span class="st">"Low SES group"</span>, pos<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.4</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-coefplot"></span>
<img src="fig/mmra-rohwer-coefplot-1.png" alt="Coefficient plots for the separate models for the High and Low SES groups in the Rohwer data. The ellipses are 95% confidence regions for the pairs of regression coefficients of (SAT, PPVT) for each predictor in the model." width="47%" height="50%"><img src="fig/mmra-rohwer-coefplot-2.png" alt="Coefficient plots for the separate models for the High and Low SES groups in the Rohwer data. The ellipses are 95% confidence regions for the pairs of regression coefficients of (SAT, PPVT) for each predictor in the model." width="47%" height="50%"><p class="caption">
Figure 1.2: Coefficient plots for the separate models for the High and Low SES groups in the Rohwer data. The ellipses are 95% confidence regions for the pairs of regression coefficients of (SAT, PPVT) for each predictor in the model.
</p>
</div>
<p>Alternatively, we can visualize the results of the multivariate tests for the predictors
with HE plots. Here we make use of the fact
that several HE plots can be overlaid using the option <code>add=TRUE</code>
as shown in Figure <a href="#fig:rohwer-HE1">1.3</a>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">rohwer.ses1</span>, </span>
<span>       ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">40</span>,<span class="fl">110</span><span class="op">)</span>,                        <span class="co"># allow more room for 2nd plot</span></span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>, </span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       lwd<span class="op">=</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">rohwer.ses2</span>, </span>
<span>       add<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>       col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"brown"</span>, <span class="st">"black"</span><span class="op">)</span>, </span>
<span>       grand.mean<span class="op">=</span><span class="cn">TRUE</span>, error.ellipse<span class="op">=</span><span class="cn">TRUE</span>,   <span class="co"># not shown by default when add=TRUE</span></span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       lwd<span class="op">=</span><span class="fl">2</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="co"># label the groups at their centroid</span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/aggregate.html" class="external-link">aggregate</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>,<span class="va">PPVT</span><span class="op">)</span><span class="op">~</span><span class="va">SES</span>, data<span class="op">=</span><span class="va">Rohwer</span>,  <span class="va">mean</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">means</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="va">means</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>, labels<span class="op">=</span><span class="va">means</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, pos<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">2</span>, col<span class="op">=</span><span class="st">"black"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-HE1"></span>
<img src="fig/mmra-rohwer-HE1-1.png" alt="HE plot for `SAT` and `PPVT`, showing the effects for the PA predictors   for the High and Low SES groups separately" width="60%"><p class="caption">
Figure 1.3: HE plot for <code>SAT</code> and <code>PPVT</code>, showing the effects for the PA predictors for the High and Low SES groups separately
</p>
</div>
<p>We can readily see the difference in means for the two SES groups (<code>Hi</code> has greater scores on both variables)
and it also appears that the slopes of the predictor ellipses are shallower for the High
than the Low group, indicating greater relation with the <code>SAT</code> score.</p>
</div>
<div class="section level3" number="1.3">
<h3 id="mancova-model">
<span class="header-section-number">1.3</span> MANCOVA model<a class="anchor" aria-label="anchor" href="#mancova-model"></a>
</h3>
<p>Alternatively (and optimistically), we can fit a MANCOVA model
that allows different means for the two SES groups on the responses, but constrains the
slopes for the PA covariates to be equal.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MANCOVA, assuming equal slopes</span></span>
<span><span class="va">rohwer.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">SES</span> <span class="op">+</span> <span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span>, </span>
<span>                 data<span class="op">=</span><span class="va">Rohwer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">rohwer.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;     Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; SES  1     0.379    12.18      3     60 2.5e-06 ***</span></span>
<span><span class="co">#&gt; n    1     0.040     0.84      3     60  0.4773    </span></span>
<span><span class="co">#&gt; s    1     0.093     2.04      3     60  0.1173    </span></span>
<span><span class="co">#&gt; ns   1     0.193     4.78      3     60  0.0047 ** </span></span>
<span><span class="co">#&gt; na   1     0.231     6.02      3     60  0.0012 ** </span></span>
<span><span class="co">#&gt; ss   1     0.050     1.05      3     60  0.3770    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Note that, although the
multivariate tests for two of the covariates (<code>ns</code> and <code>na</code>)
are highly significant, univariate multiple regression tests for the
separate responses [from <code>summary(rohwer.mod)</code>] are relatively weak.</p>
<p>We can also test the global 5 df hypothesis, <span class="math inline">\(\mathbf{B}=\mathbf{0}\)</span>,
that <em>all</em> covariates have null effects
for all responses as a linear hypothesis.
First, extract the names
of the PA tests predictors from the model.
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">car::linearHypothesis()</a></code> takes a vector of the names coefficients to be tested simultaneously.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">covariates</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span></span>
<span><span class="co"># or: covariates &lt;- rownames(coef(rohwer.mod))[-(1:2)]</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Regr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">rohwer.mod</span>, <span class="va">covariates</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Regr</span>, digits<span class="op">=</span><span class="fl">4</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df   Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            5    0.6658    3.537     15    186 2.31e-05 ***</span></span>
<span><span class="co">#&gt; Wilks             5    0.4418    3.812     15    166 8.28e-06 ***</span></span>
<span><span class="co">#&gt; Hotelling-Lawley  5    1.0309    4.032     15    176 2.79e-06 ***</span></span>
<span><span class="co">#&gt; Roy               5    0.7574    9.392      5     62 1.06e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Then 2D views of the
additive MANCOVA model <code>rohwer.mod</code> and the overall test for all covariates
are produced as follows, giving the plots in Figure <a href="#fig:rohwer-HE2">1.4</a>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"#969696"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">rohwer.mod</span>, </span>
<span>       col<span class="op">=</span><span class="va">colors</span>, variables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>,</span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="va">covariates</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">1.5</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>       main<span class="op">=</span><span class="st">"(SAT, PPVT) in Rohwer MANCOVA model"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">rohwer.mod</span>, </span>
<span>       col<span class="op">=</span><span class="va">colors</span>,  variables<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>,</span>
<span>       hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="va">covariates</span><span class="op">)</span>,</span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>       cex<span class="op">=</span><span class="fl">1.5</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>       main<span class="op">=</span><span class="st">"(SAT, Raven) in Rohwer MANCOVA model"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-HE2"></span>
<img src="fig/mmra-rohwer-HE2-1.png" alt="HE plot for `SAT` and `PPVT` (left) and for   `SAT` and `Raven` (right) using the MANCOVA model. The ellipses labeled 'Regr' show the test of the overall model, including all predictors." width="47%" height="50%"><img src="fig/mmra-rohwer-HE2-2.png" alt="HE plot for `SAT` and `PPVT` (left) and for  `SAT` and `Raven` (right) using the MANCOVA model. The ellipses labeled 'Regr' show the test of the overall model, including all predictors." width="47%" height="50%"><p class="caption">
Figure 1.4: HE plot for <code>SAT</code> and <code>PPVT</code> (left) and for <code>SAT</code> and <code>Raven</code> (right) using the MANCOVA model. The ellipses labeled ‘Regr’ show the test of the overall model, including all predictors.
</p>
</div>
<p>The positive orientation of the <code>Regr</code> ellipses shows that the predicted
values for all three responses are positively correlated (more so for
<code>SAT</code> and <code>PPVT</code>). As well, the High SES group
is higher on all responses than the Low SES group.</p>
<p>Alternatively, all pairwise plots among these responses could be drawn using
the <code><a href="../reference/pairs.mlm.html">pairs.mlm()</a></code> function,</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">rohwer.mod</span>, col<span class="op">=</span><span class="va">colors</span>,</span>
<span>      hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      cex<span class="op">=</span><span class="fl">1.3</span>, lwd<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="fig/mmra-rohwer-HE3-1.png" style="display: block; margin: auto;"></p>
<p>or as a 3D plot, using <code><a href="../reference/heplot3d.html">heplot3d()</a></code> as shown in Figure <a href="#fig:rohwer-HE3D">1.5</a>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pink"</span>, <span class="st">"blue"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"#969696"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot3d.html">heplot3d</a></span><span class="op">(</span><span class="va">rohwer.mod</span>, col<span class="op">=</span><span class="va">colors</span>,</span>
<span>    hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-HE3D"></span>
<img src="fig/mmra-rohwer-HE3D.png" alt="3D HE plot for the MANCOVA model fit to the Rohwer data." width="60%"><p class="caption">
Figure 1.5: 3D HE plot for the MANCOVA model fit to the Rohwer data.
</p>
</div>
</div>
<div class="section level3" number="1.4">
<h3 id="testing-homogeneity-of-regression">
<span class="header-section-number">1.4</span> Testing homogeneity of regression<a class="anchor" aria-label="anchor" href="#testing-homogeneity-of-regression"></a>
</h3>
<p>The MANCOVA model, <code>rohwer.mod</code>, has relatively simple interpretations
(large effect of <code>SES</code>, with <code>ns</code> and <code>na</code> as the major predictors)
but the test of relies on the assumption of homogeneity of slopes for the predictors.
We can test this assumption as follows, by adding interactions of <code>SES</code>
with each of the covariates:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rohwer.mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">SAT</span>, <span class="va">PPVT</span>, <span class="va">Raven</span><span class="op">)</span> <span class="op">~</span> <span class="va">SES</span> <span class="op">*</span> <span class="op">(</span><span class="va">n</span> <span class="op">+</span> <span class="va">s</span> <span class="op">+</span> <span class="va">ns</span> <span class="op">+</span> <span class="va">na</span> <span class="op">+</span> <span class="va">ss</span><span class="op">)</span>,</span>
<span>                  data<span class="op">=</span><span class="va">Rohwer</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">rohwer.mod2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;        Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; SES     1     0.391    11.78      3     55 4.5e-06 ***</span></span>
<span><span class="co">#&gt; n       1     0.079     1.57      3     55 0.20638    </span></span>
<span><span class="co">#&gt; s       1     0.125     2.62      3     55 0.05952 .  </span></span>
<span><span class="co">#&gt; ns      1     0.254     6.25      3     55 0.00100 ***</span></span>
<span><span class="co">#&gt; na      1     0.307     8.11      3     55 0.00015 ***</span></span>
<span><span class="co">#&gt; ss      1     0.060     1.17      3     55 0.32813    </span></span>
<span><span class="co">#&gt; SES:n   1     0.072     1.43      3     55 0.24417    </span></span>
<span><span class="co">#&gt; SES:s   1     0.099     2.02      3     55 0.12117    </span></span>
<span><span class="co">#&gt; SES:ns  1     0.118     2.44      3     55 0.07383 .  </span></span>
<span><span class="co">#&gt; SES:na  1     0.148     3.18      3     55 0.03081 *  </span></span>
<span><span class="co">#&gt; SES:ss  1     0.057     1.12      3     55 0.35094    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>It appears from the above that there is only weak evidence of unequal slopes
from the separate <code>SES:</code> terms. The evidence for heterogeneity is
stronger, however, when these terms are tested collectively using the
<code><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis()</a></code> function:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">rohwer.mod2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "(Intercept)" "SESLo"       "n"           "s"           "ns"         </span></span>
<span><span class="co">#&gt;  [6] "na"          "ss"          "SESLo:n"     "SESLo:s"     "SESLo:ns"   </span></span>
<span><span class="co">#&gt; [11] "SESLo:na"    "SESLo:ss"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">rohwer.mod2</span>, <span class="va">coefs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">":"</span>, <span class="va">coefs</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df  Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; Pillai            5    0.4179    1.845     15  171.0 0.03209 * </span></span>
<span><span class="co">#&gt; Wilks             5    0.6236    1.894     15  152.2 0.02769 * </span></span>
<span><span class="co">#&gt; Hotelling-Lawley  5    0.5387    1.927     15  161.0 0.02396 * </span></span>
<span><span class="co">#&gt; Roy               5    0.3846    4.385      5   57.0 0.00191 **</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>This model (<code>rohwer.mod2</code>) is similar in spirit to the two models
(<code>rohwer.ses1</code> and <code>rohwer.ses2</code>)
fit for the two SES groups separately and show in Figure <a href="#fig:rohwer-HE1">1.3</a>,
except that model <code>rohwer.mod2</code> assumes a common within-groups error covariance matrix
and allows overall tests.</p>
<p>To illustrate model <code>rohwer.mod2</code>, we construct an HE plot for
<code>SAT</code> and <code>PPVT</code> shown in Figure <a href="#fig:rohwer-HE4">1.6</a>.
To simplify this display, we show the hypothesis ellipses
for the overall effects of the PA tests in the baseline high-SES group, and
a single combined ellipse for all the <code>SESLo:</code> interaction terms that
we tested previously, representing differences in slopes between the low and
high-SES groups.</p>
<p>Because SES is “treatment-coded” in this model, the ellipse for each
covariate represents the hypothesis that the slopes for that covariate are
zero in the high-SES baseline category. With this parameterization, the ellipse for
<code>Slopes</code> represents the joint hypothesis that slopes for the covariates do not differ
in the low-SES group.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">5</span><span class="op">)</span>, <span class="st">"#969696"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">rohwer.mod2</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">colors</span>, <span class="st">"brown"</span><span class="op">)</span>, </span>
<span>      terms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SES"</span>, <span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span>, </span>
<span>      hypotheses<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"n"</span>, <span class="st">"s"</span>, <span class="st">"ns"</span>, <span class="st">"na"</span>, <span class="st">"ss"</span><span class="op">)</span>,</span>
<span>                      <span class="st">"Slopes"</span> <span class="op">=</span> <span class="va">coefs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">":"</span>, <span class="va">coefs</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:rohwer-HE4"></span>
<img src="fig/mmra-rohwer-HE4-1.png" alt="HE plot for `SAT` and `PPVT`, fitting the model `rohwer.mod2` that allows unequal slopes for the covariates." width="70%"><p class="caption">
Figure 1.6: HE plot for <code>SAT</code> and <code>PPVT</code>, fitting the model <code>rohwer.mod2</code> that allows unequal slopes for the covariates.
</p>
</div>
<p>Comparing Figure <a href="#fig:rohwer-HE4">1.6</a> for the heterogeneous slopes model
with Figure <a href="#fig:rohwer-HE2">1.4</a> (left) for the homogeneous slopes model,
it can be seen that most of the covariates have ellipses of similar
size and orientation, reflecting similar evidence against the respective
null hypotheses, as does the effect of <code>SES</code>, showing the
greater performance of the high-SES group on all response measures.
Somewhat more subtle, the error ellipse is noticeably smaller in
Figure <a href="#fig:rohwer-HE4">1.6</a>, reflecting the additional variation accounted
for by differences in slopes.</p>
</div>
</div>
<div class="section level2" number="2">
<h2 id="recovery-from-hernia-repair">
<span class="header-section-number">2</span> Recovery from hernia repair<a class="anchor" aria-label="anchor" href="#recovery-from-hernia-repair"></a>
</h2>
<p>This example uses the <code>Hernior</code> data (from <span class="citation">Mosteller &amp; Tukey (<a href="#ref-MostellerTukey:1977">1977</a>)</span>, Data Exhibit 8, p. 567-568),
comprising
data on measures of post-operative recovery of 32 patients undergoing an
elective herniorrhaphy operation, in relation to pre-operative measures.</p>
<p>The outcome measures are:</p>
<ul>
<li>
<code>leave</code>, the patient’s condition upon leaving the recovery room (a 1-4 scale, 1=best),</li>
<li>
<code>nurse</code>, level of nursing required one week after operation (a 1-5 scale, 1=worst) and</li>
<li>
<code>los</code>, length of stay in hospital after operation (in days)</li>
</ul>
<p>The predictor variables are:</p>
<ul>
<li>patient <code>age</code>, <code>sex</code>,</li>
<li>`pstat, physical status ( a 1-5 scale, with 1=perfect health, …, 5=very poor health),</li>
<li>
<code>build</code>, body build (a 1-5 scale, with 1=emaciated, …, 5=obese), and</li>
<li>preoperative complications with (<code>cardiac</code>) heart and respiration (<code>resp</code>), 1-4 scales, 1=none, …, 4=severe.
<!-- The ordinal predictors could be treated as factors, but we use them here as numeric variables. -->
</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Hernior</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Hernior</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    32 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;  $ age    : int  78 60 68 62 76 76 64 74 68 79 ...</span></span>
<span><span class="co">#&gt;  $ sex    : Factor w/ 2 levels "f","m": 2 2 2 2 2 2 2 1 2 1 ...</span></span>
<span><span class="co">#&gt;  $ pstat  : int  2 2 2 3 3 1 1 2 3 2 ...</span></span>
<span><span class="co">#&gt;  $ build  : int  3 3 3 5 4 3 2 3 4 2 ...</span></span>
<span><span class="co">#&gt;  $ cardiac: int  1 2 1 3 3 1 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ resp   : int  1 2 1 1 2 1 2 2 1 1 ...</span></span>
<span><span class="co">#&gt;  $ leave  : int  2 2 1 1 2 1 1 1 1 2 ...</span></span>
<span><span class="co">#&gt;  $ los    : int  9 4 7 35 9 7 5 16 7 11 ...</span></span>
<span><span class="co">#&gt;  $ nurse  : num  3 5 4 3 4 5 5 3 5 3 ...</span></span></code></pre></div>
<div class="section level3" number="2.1">
<h3 id="all-predictors-model">
<span class="header-section-number">2.1</span> All predictors model<a class="anchor" aria-label="anchor" href="#all-predictors-model"></a>
</h3>
<p>We begin with a model fitting all predictors. Note that the ordinal predictors,
<code>pstat</code>, <code>build</code>, <code>cardiac</code> and <code>resp</code> could arguably be treated as
factors, rather than linear, regression terms. Doing so would give tests for
nonlinear effects of their relations with the responses.
We ignore this possibility in this example.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hern.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">leave</span>, <span class="va">nurse</span>, <span class="va">los</span><span class="op">)</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span>  <span class="va">pstat</span> <span class="op">+</span>  <span class="va">build</span> <span class="op">+</span> <span class="va">cardiac</span> <span class="op">+</span> <span class="va">resp</span>, </span>
<span>               data<span class="op">=</span><span class="va">Hernior</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">Hern.mod</span><span class="op">)</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;         Df test stat approx F num Df den Df Pr(&gt;F)  </span></span>
<span><span class="co">#&gt; age      1     0.143     1.27      3     23  0.307  </span></span>
<span><span class="co">#&gt; sex      1     0.026     0.21      3     23  0.892  </span></span>
<span><span class="co">#&gt; pstat    1     0.333     3.84      3     23  0.023 *</span></span>
<span><span class="co">#&gt; build    1     0.257     2.65      3     23  0.073 .</span></span>
<span><span class="co">#&gt; cardiac  1     0.228     2.26      3     23  0.108  </span></span>
<span><span class="co">#&gt; resp     1     0.248     2.53      3     23  0.082 .</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>The results of the multivariate tests above are somewhat disappointing. Only the physical status
predictor (<code>pstat</code>) appears to be significant at conventional levels.</p>
<p>The univariate models for each response are implicit in the MLM <code>Hern.mod</code>.
These can be printed using <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, or we can use <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> to extract
certain statistics for each univariate response model, as we do here.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hern.summary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">Hern.mod</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">Hern.summary</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">r.squared</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Response leave Response nurse   Response los </span></span>
<span><span class="co">#&gt;         0.5918         0.2474         0.3653</span></span></code></pre></div>
<p>More conveniently, the function <code><a href="../reference/glance.mlm.html">heplots::glance.mlm()</a></code> extends <code><a href="https://broom.tidymodels.org/reference/glance.lm.html" class="external-link">broom::glance.lm()</a></code>
to give a one-line summary of statistics for each response variable in a MLM.
The <span class="math inline">\(R^2\)</span> and <span class="math inline">\(F\)</span> statistics are those for each overall model assessing the impact
of all predictors.</p>
<!-- TODO: use glance.mlm() here -->
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/glance.mlm.html">glance.mlm</a></span><span class="op">(</span><span class="va">Hern.mod</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">#&gt;   response r.squared adj.r.squared sigma fstatistic numdf dendf  p.value  nobs</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> leave        0.592        0.494  0.388       6.04     6    25 0.000<span style="text-decoration: underline;">519</span>    32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> nurse        0.247        0.066<span style="text-decoration: underline;">8</span> 0.841       1.37     6    25 0.265       32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> los          0.365        0.213  5.62        2.40     6    25 0.057<span style="text-decoration: underline;">3</span>      32</span></span></code></pre></div>
<p>Univariate tests for predictors in each of these models (not shown here)
are hard to interpret, and largely show only significant effects for
the <code>leave</code> variable. Yet, the <span class="math inline">\(R^2\)</span> values for the other responses
are slightly promising. We proceed to a multivariate overall test of <span class="math inline">\(\mathbf{B} = 0\)</span>
for all predictors, whose term names can be easily extracted from the
rownames of the coefficients.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># test overall regression</span></span>
<span><span class="op">(</span><span class="va">predictors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">Hern.mod</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "age"     "sexm"    "pstat"   "build"   "cardiac" "resp"</span></span>
<span><span class="va">Regr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/linearHypothesis.html" class="external-link">linearHypothesis</a></span><span class="op">(</span><span class="va">Hern.mod</span>, <span class="va">predictors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">Regr</span>, digits<span class="op">=</span><span class="fl">5</span>, SSP<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Multivariate Tests: </span></span>
<span><span class="co">#&gt;                  Df test stat approx F num Df den Df    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Pillai            6   1.10198   2.4192     18 75.000 0.0041356 ** </span></span>
<span><span class="co">#&gt; Wilks             6   0.21734   2.6046     18 65.539 0.0025239 ** </span></span>
<span><span class="co">#&gt; Hotelling-Lawley  6   2.26797   2.7300     18 65.000 0.0016285 ** </span></span>
<span><span class="co">#&gt; Roy               6   1.55434   6.4764      6 25.000 0.0003232 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"darkgray"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>, <span class="st">"magenta"</span>, <span class="st">"brown"</span>, <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="va">vlab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LeaveCondition\n(leave)"</span>, </span>
<span>          <span class="st">"NursingCare\n(nurse)"</span>, </span>
<span>          <span class="st">"LengthOfStay\n(los)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">hyp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regr"</span> <span class="op">=</span> <span class="va">predictors</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">Hern.mod</span>, </span>
<span>      hypotheses<span class="op">=</span><span class="va">hyp</span>, </span>
<span>      col<span class="op">=</span><span class="va">clr</span>, var.labels<span class="op">=</span><span class="va">vlab</span>, </span>
<span>      fill<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>,<span class="cn">FALSE</span><span class="op">)</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span>, </span>
<span>      cex<span class="op">=</span><span class="fl">1.25</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hern-pairs"></span>
<img src="fig/mmra-hern-pairs-1.png" alt="HE pairs plot for Hernior data"><p class="caption">
Figure 2.1: HE pairs plot for Hernior data
</p>
</div>
<p>A <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> plot for the MLM gives the set of plots shown in Figure <a href="#fig:hern-pairs">2.1</a>
helps to interpret the relations among the predictors which lead to the highly significant
overall test.
Among the predictors, age and sex have small and insignificant effects on the outcome measures
jointly. The other predictors all contribute to the overall test of <span class="math inline">\(\mathbf{B} = 0\)</span>,
though in different ways for the various responses.
For example, in the panel for (<code>leave</code>, <code>los</code>) in Figure <a href="#fig:hern-pairs">2.1</a>,
it can be seen that while only <code>pstat</code> individually is outside the
<span class="math inline">\(\mathbf{E}\)</span> ellipse, <code>build</code> and <code>resp</code> contribute to the overall test in
an opposite direction.</p>
</div>
<div class="section level3" number="2.2">
<h3 id="canonical-analysis">
<span class="header-section-number">2.2</span> Canonical analysis<a class="anchor" aria-label="anchor" href="#canonical-analysis"></a>
</h3>
<p>In this multivariate regression example, all of the terms in the model <code>Hern.mod</code>
have 1 df, and so plot as lines in HE plots. An alternative view of these effects
can be seen in canonical discriminant space, which, for each predictor shows the
scores on the linear combination of the responses that contributes most to
the multivariate test of that effect, together with the weights for the responses.</p>
<p>We use <code><a href="https://rdrr.io/pkg/candisc/man/candiscList.html" class="external-link">candiscList()</a></code> to calculate the canonical analyses for all predictor terms in
<code>Hern.mod</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Hern.canL</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candiscList.html" class="external-link">candiscList</a></span><span class="op">(</span><span class="va">Hern.mod</span><span class="op">)</span></span></code></pre></div>
<p>1D canonical discriminant plots for all terms can be obtained interactively
with a menu, simply by plotting the <code>Hern.canL</code> object.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Hern.canL</span><span class="op">)</span></span></code></pre></div>
<p>Plots for separate terms are produced by the lines below, and shown in
Figure <a href="#fig:hern-can1">2.2</a> and Figure <a href="#fig:hern-can2">2.3</a>.</p>
<p>For <code>pstat</code> and <code>build</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Hern.canL</span>, term<span class="op">=</span><span class="st">"pstat"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Hern.canL</span>, term<span class="op">=</span><span class="st">"build"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hern-can1"></span>
<img src="fig/mmra-hern-can1-1.png" alt="1D Canonical discriminant plots for physical status (`pstat`) and `build`. The canonical scores are such that better outcomes are associated with smaller scores. Arrows show the correlations of the  responses with the 1D canonical scores." width="47%" height="50%"><img src="fig/mmra-hern-can1-2.png" alt="1D Canonical discriminant plots for physical status (`pstat`) and `build`. The canonical scores are such that better outcomes are associated with smaller scores. Arrows show the correlations of the  responses with the 1D canonical scores." width="47%" height="50%"><p class="caption">
Figure 2.2: 1D Canonical discriminant plots for physical status (<code>pstat</code>) and <code>build</code>. The canonical scores are such that better outcomes are associated with smaller scores. Arrows show the correlations of the responses with the 1D canonical scores.
</p>
</div>
<p>For <code>age</code> and <code>cardiac</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Hern.canL</span>, term<span class="op">=</span><span class="st">"age"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">Hern.canL</span>, term<span class="op">=</span><span class="st">"cardiac"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:hern-can2"></span>
<img src="fig/mmra-hern-can2-1.png" alt="1D Canonical discriminant plots for `age` and `cardiac`. The canonical scores are such that better outcomes are associated with smaller scores." width="47%" height="50%"><img src="fig/mmra-hern-can2-2.png" alt="1D Canonical discriminant plots for `age` and `cardiac`. The canonical scores are such that better outcomes are associated with smaller scores." width="47%" height="50%"><p class="caption">
Figure 2.3: 1D Canonical discriminant plots for <code>age</code> and <code>cardiac</code>. The canonical scores are such that better outcomes are associated with smaller scores.
</p>
</div>
<p>In these plots, the canonical scores panel shows
the linear combinations of the
response variables which have the largest possible <span class="math inline">\(R^2\)</span>.
Better outcomes correspond to numerically smaller canonical scores.
The arrows in the structure panel are proportional to
the canonical weights.</p>
<p>These plots provide simple interpretations of the results for the
canonical combinations of the responses.
Better physical status, smaller body build, lower age and absence
of cardiac complications are all positively related to better outcomes.</p>
</div>
</div>
<div class="section level2" number="3">
<h2 id="grades-in-a-sociology-course">
<span class="header-section-number">3</span> Grades in a Sociology Course<a class="anchor" aria-label="anchor" href="#grades-in-a-sociology-course"></a>
</h2>
<p>The data set <code>SocGrades</code> contains four outcome measures on student performance
in an introductory sociology course together with six potential predictors.
These data were used by <span class="citation">Marascuilo &amp; Levin (<a href="#ref-MarascuiloLevin:1983">1983</a>)</span> for an example of
canonical correlation analysis, but are also suitable as examples of
multivariate multiple regression, MANOVA, MANCOVA
and step-down analysis in multivariate linear models.</p>
<p>The outcome measures used here are three test scores during the course,
<code>midterm1</code>, <code>midterm2</code>, <code>final</code>,
and a course evaluation (<code>eval</code>).<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;It is arguable that the students’ course evaluation should not
be considered a response variable here. It could be used as a
predictor in a follow-up, step-down analysis, which would address the separate
question of whether the effects on exam grades remain, when &lt;code&gt;eval&lt;/code&gt; is controlled for.&lt;/p&gt;"><sup>2</sup></a></p>
<p>Predictor variables are:</p>
<ul>
<li>
<code>class</code>, the student’s social class (an ordered factor with levels <code>1</code> &gt; <code>2</code> &gt; <code>3</code>)</li>
<li>
<code>sex</code>,</li>
<li>
<code>gpa</code>, grade point average,</li>
<li>
<code>boards</code>, College Board test scores,</li>
<li>
<code>hssoc</code>, previous high school unit in sociology? (with values <code>no</code>, <code>yes</code>), and</li>
<li>
<code>pretest</code>, score on a course pretest.</li>
</ul>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">SocGrades</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    40 obs. of  10 variables:</span></span>
<span><span class="co">#&gt;  $ class   : Ord.factor w/ 3 levels "3"&lt;"2"&lt;"1": 2 2 2 1 2 1 3 2 1 2 ...</span></span>
<span><span class="co">#&gt;  $ sex     : Factor w/ 2 levels "F","M": 2 2 2 2 2 2 1 2 2 1 ...</span></span>
<span><span class="co">#&gt;  $ gpa     : num  3.55 2.7 3.5 2.91 3.1 3.49 3.17 3.57 3.76 3.81 ...</span></span>
<span><span class="co">#&gt;  $ boards  : int  410 390 510 430 600 610 610 560 700 460 ...</span></span>
<span><span class="co">#&gt;  $ hssoc   : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ pretest : int  17 20 22 13 16 28 14 10 28 30 ...</span></span>
<span><span class="co">#&gt;  $ midterm1: int  43 50 47 24 47 57 42 42 69 48 ...</span></span>
<span><span class="co">#&gt;  $ midterm2: int  61 47 79 40 60 59 61 79 83 67 ...</span></span>
<span><span class="co">#&gt;  $ final   : int  129 60 119 100 79 99 92 107 156 110 ...</span></span>
<span><span class="co">#&gt;  $ eval    : int  3 1 1 1 2 1 3 2 1 1 ...</span></span></code></pre></div>
<div class="section level3" number="3.1">
<h3 id="models">
<span class="header-section-number">3.1</span> Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<p>The basic MLM is fit below as <code>grades.mod</code> with all predictor variables.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">SocGrades</span><span class="op">)</span></span>
<span><span class="va">grades.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">midterm1</span>, <span class="va">midterm2</span>, <span class="va">final</span>, <span class="va">eval</span><span class="op">)</span> <span class="op">~</span> </span>
<span>                         <span class="va">class</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">gpa</span> <span class="op">+</span> <span class="va">boards</span> <span class="op">+</span> <span class="va">hssoc</span> <span class="op">+</span> <span class="va">pretest</span>, </span>
<span>                 data<span class="op">=</span><span class="va">SocGrades</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">grades.mod</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;         Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; class    2     1.567    11.75      4     30 7.3e-06 ***</span></span>
<span><span class="co">#&gt; sex      1     0.553     4.01      4     29  0.0104 *  </span></span>
<span><span class="co">#&gt; gpa      1     1.208     8.76      4     29 9.2e-05 ***</span></span>
<span><span class="co">#&gt; boards   1     0.731     5.30      4     29  0.0025 ** </span></span>
<span><span class="co">#&gt; hssoc    1     0.035     0.25      4     29  0.9052    </span></span>
<span><span class="co">#&gt; pretest  1     0.313     2.27      4     29  0.0859 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<div class="section level4" number="3.1.1">
<h4 id="screening-for-interactions">
<span class="header-section-number">3.1.1</span> Screening for interactions<a class="anchor" aria-label="anchor" href="#screening-for-interactions"></a>
</h4>
<p>In both univariate and multivariate
response models, it is often useful to screen for higher-order
terms (interactions, non-linear predictors). This can most easily be
done using <code><a href="https://rdrr.io/r/stats/update.html" class="external-link">update()</a></code>, as we do below. First, try the extended
model with all pairwise interactions of the predictors.
In the model formula, <code>~.^2</code>, the <code>.</code> represents all terms in the model,
and the <code>^2</code> generates all products of terms, such as <code>class:sex</code>, <code>class:gpa</code>, and so forth.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grades.mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">grades.mod</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">grades.mod2</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;                Df test stat approx F num Df den Df Pr(&gt;F)   </span></span>
<span><span class="co">#&gt; class           2     2.817     7.04      4     10 0.0058 **</span></span>
<span><span class="co">#&gt; sex             1     0.487     1.09      4      9 0.4152   </span></span>
<span><span class="co">#&gt; gpa             1     1.998     4.49      4      9 0.0286 * </span></span>
<span><span class="co">#&gt; boards          1     2.338     5.26      4      9 0.0183 * </span></span>
<span><span class="co">#&gt; hssoc           1     0.281     0.63      4      9 0.6522   </span></span>
<span><span class="co">#&gt; pretest         1     0.510     1.15      4      9 0.3946   </span></span>
<span><span class="co">#&gt; class:sex       2     2.039     5.10      4     10 0.0168 * </span></span>
<span><span class="co">#&gt; class:gpa       2     0.982     2.45      4     10 0.1137   </span></span>
<span><span class="co">#&gt; class:boards    2     0.522     1.31      4     10 0.3321   </span></span>
<span><span class="co">#&gt; class:hssoc     2     0.356     0.89      4     10 0.5041   </span></span>
<span><span class="co">#&gt; class:pretest   2     1.005     2.51      4     10 0.1082   </span></span>
<span><span class="co">#&gt; sex:gpa         1     0.269     0.60      4      9 0.6694   </span></span>
<span><span class="co">#&gt; sex:boards      1     0.184     0.41      4      9 0.7944   </span></span>
<span><span class="co">#&gt; sex:hssoc       1     0.909     2.04      4      9 0.1714   </span></span>
<span><span class="co">#&gt; sex:pretest     1     0.885     1.99      4      9 0.1795   </span></span>
<span><span class="co">#&gt; gpa:boards      1     0.447     1.00      4      9 0.4537   </span></span>
<span><span class="co">#&gt; gpa:hssoc       1     0.596     1.34      4      9 0.3269   </span></span>
<span><span class="co">#&gt; gpa:pretest     1     0.472     1.06      4      9 0.4291   </span></span>
<span><span class="co">#&gt; boards:hssoc    1     0.353     0.80      4      9 0.5573   </span></span>
<span><span class="co">#&gt; boards:pretest  1     0.705     1.59      4      9 0.2593   </span></span>
<span><span class="co">#&gt; hssoc:pretest   1     1.464     3.29      4      9 0.0635 . </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>In the results above, only the interaction of <code>class:sex</code> is significant,
and the main effects of <code>hssoc</code> and <code>pretest</code> remain insignificant.
A revised model to explore is <code>grades.mod3</code>,</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grades.mod3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">grades.mod</span>, <span class="va">.</span> <span class="op">~</span> <span class="va">.</span> <span class="op">+</span> <span class="va">class</span><span class="op">:</span><span class="va">sex</span> <span class="op">-</span> <span class="va">hssoc</span> <span class="op">-</span> <span class="va">pretest</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">grades.mod3</span>, test<span class="op">=</span><span class="st">"Roy"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Roy test statistic</span></span>
<span><span class="co">#&gt;           Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; class      2     1.588    11.91      4     30 6.5e-06 ***</span></span>
<span><span class="co">#&gt; sex        1     0.575     4.17      4     29 0.00864 ** </span></span>
<span><span class="co">#&gt; gpa        1     1.434    10.40      4     29 2.4e-05 ***</span></span>
<span><span class="co">#&gt; boards     1     0.895     6.49      4     29 0.00074 ***</span></span>
<span><span class="co">#&gt; class:sex  2     0.450     3.38      4     30 0.02143 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>A pairwise HE plot for all responses (Figure <a href="#fig:grades-pairs">3.1</a> shows that nearly all
effects are in the expected directions: higher <code>gpa</code>, <code>boards</code>, <code>class</code>
leads to better performance on most outcomes. The interaction of
<code>class:sex</code> seems to be confined largely to <code>midterm1</code>.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">grades.mod3</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:grades-pairs"></span>
<img src="fig/mmra-grades-pairs-1.png" alt="HE pairs plot for SocGrade, model `grades.mod3`." width="90%"><p class="caption">
Figure 3.1: HE pairs plot for SocGrade, model <code>grades.mod3</code>.
</p>
</div>
<p>These effects are easier to appreciate for the three exam grades jointly in a
3D HE plot when you can rotate it interactively. A snapshot is shown in Figure <a href="#fig:grades-HE3D">3.2</a>.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/heplot3d.html">heplot3d</a></span><span class="op">(</span><span class="va">grades.mod3</span>, wire<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:grades-HE3D"></span>
<img src="fig/grades-HE3D.png" alt="3D HE plot for SocGrades, model `grades.mod3`" width="70%"><p class="caption">
Figure 3.2: 3D HE plot for SocGrades, model <code>grades.mod3</code>
</p>
</div>
<!--    \includegraphics[width=.7\textwidth]{grades-HE3D} -->
<!-- \caption{3D HE plot for SocGrades, model `grades.mod3`} -->
<!--  {#fig:grades-HE3D} -->
<p>Interactive
rotation of this plot shows that the effect of <code>class</code> is only two dimensional,
and of these, one dimension is very small. The major axis of the <code>class</code> ellipsoid
is aligned with increasing performance on all three grades, with the expected
ordering of the three social classes.</p>
</div>
</div>
<div class="section level3" number="3.2">
<h3 id="canonical-analysis-1">
<span class="header-section-number">3.2</span> Canonical analysis<a class="anchor" aria-label="anchor" href="#canonical-analysis-1"></a>
</h3>
<p>The representation of these effects in canonical space is particularly useful here.
Again, use <code><a href="https://rdrr.io/pkg/candisc/man/candiscList.html" class="external-link">candiscList()</a></code> to compute the canonical decompositions for all terms
in the model, and extract the canonical <span class="math inline">\(R^2\)</span> from the terms in the result.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate canonical results for all terms</span></span>
<span><span class="va">grades.can</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/candisc/man/candiscList.html" class="external-link">candiscList</a></span><span class="op">(</span><span class="va">grades.mod3</span><span class="op">)</span></span>
<span><span class="co"># extract canonical R^2s</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">grades.can</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">canrsq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     class1     class2        sex        gpa     boards class:sex1 class:sex2 </span></span>
<span><span class="co">#&gt;    0.61362    0.02419    0.36527    0.58915    0.47227    0.31046    0.13293</span></span></code></pre></div>
<p>We use <code><a href="../reference/heplot.html">heplot()</a></code> on the <code>"candiscList"</code> object to show
the effects of <code>class</code> in canonical space, giving Figure <a href="#fig:grades-can-class">3.3</a>.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot class effect in canonical space</span></span>
<span> <span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">grades.can</span>, term<span class="op">=</span><span class="st">"class"</span>, </span>
<span>        scale<span class="op">=</span><span class="fl">4</span>, fill<span class="op">=</span><span class="cn">TRUE</span>, var.col<span class="op">=</span><span class="st">"black"</span>, var.lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:grades-can-class"></span>
<img src="fig/mmra-grades-can-class-1.png" alt="Canonical HE plot for `class` effect in  `grades.mod3`" width="80%"><p class="caption">
Figure 3.3: Canonical HE plot for <code>class</code> effect in <code>grades.mod3</code>
</p>
</div>
<p>It can be seen in Figure <a href="#fig:grades-can-class">3.3</a> that nearly all variation
in exam performance due to class is aligned with the first canonical dimension.
The three tests and course evaluation all have similar weights on this dimension,
but the course evaluation differs from the rest along a second, very small
dimension.</p>
<p>1D plots of the canonical scores for other effects in the model are also of
interest, and provide simple interpretations of these effects on the response
variables. The statements below produce the plots shown in Figure <a href="#fig:grades-can-all">3.4</a>.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">grades.can</span>, term<span class="op">=</span><span class="st">"sex"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">grades.can</span>, term<span class="op">=</span><span class="st">"gpa"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:grades-can-all"></span>
<img src="fig/mmra-grades-can-all-1.png" alt="1D Canonical discriminant plots for `sex` and `gpa`. Higher canonical scores reflect better course performance." width="47%" height="50%"><img src="fig/mmra-grades-can-all-2.png" alt="1D Canonical discriminant plots for `sex` and `gpa`. Higher canonical scores reflect better course performance." width="47%" height="50%"><p class="caption">
Figure 3.4: 1D Canonical discriminant plots for <code>sex</code> and <code>gpa</code>. Higher canonical scores reflect better course performance.
</p>
</div>
<p>It is readily seen that males perform better overall, but the effect of
<code>sex</code> is strongest for the <code>midterm2</code>.
As well, increasing course performance on tests is strongly associated with
<code>gpa</code>.</p>
</div>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-MarascuiloLevin:1983" class="csl-entry">
Marascuilo, L. A., &amp; Levin, J. R. (1983). <em>Multivariate statistics in the social sciences: A researcher’s guide</em>. Brooks/Cole Publishing Company.
</div>
<div id="ref-MostellerTukey:1977" class="csl-entry">
Mosteller, F., &amp; Tukey, J. W. (1977). <em>Data analysis and regression: A second course in statistics</em>. Reading: Addison-Wesley.
</div>
<div id="ref-Timm:75" class="csl-entry">
Timm, N. H. (1975). <em>Multivariate analysis with applications in education and psychology</em>. Belmont, CA: Wadsworth (Brooks/Cole).
</div>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
