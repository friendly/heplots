<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Robust Multivariate Linear Models • heplots</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.10/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Robust Multivariate Linear Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">heplots</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.7.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/datasets.html">Data sets in the heplots package</a></li>
    <li><a class="dropdown-item" href="../articles/HE_manova.html">HE plot MANOVA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/HE_mmra.html">HE plot MMRA Examples</a></li>
    <li><a class="dropdown-item" href="../articles/Robust.html">Robust Multivariate Linear Models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/friendly/heplots/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">


<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Robust Multivariate Linear Models</h1>
                        <h4 data-toc-skip class="author">Michael Friendly</h4>
            
            <h4 data-toc-skip class="date">2025-08-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/friendly/heplots/blob/HEAD/vignettes/Robust.Rmd" class="external-link"><code>vignettes/Robust.Rmd</code></a></small>
      <div class="d-none name"><code>Robust.Rmd</code></div>
    </div>

    
    
<p><strong>Abstract</strong></p>
<p>This vignette describes the theory behind, and demonstrates the use of, the <code><a href="../reference/robmlm.html">robmlm()</a></code> function from the <code>heplots</code> package, which provides robust estimation for multivariate linear models (MLMs) using iteratively reweighted least squares (IRLS).</p>
<p>It illustrates the central ideas behind robust estimation for MLMs, how the IRLS algorithm works, and presents examples of
plots that help understand how robust models can contribute to data analysis.</p>
<p><strong>Load packages</strong></p>
<p>I use the following packages here:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots" class="external-link">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/candisc/" class="external-link">candisc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/friendly/mvinfluence" class="external-link">mvinfluence</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Multivariate linear models (MLMs) extend the familiar univariate linear regression framework to situations where multiple response variables are modeled simultaneously as linear functions of a common set of predictor variables. While classical multivariate least squares estimation provides optimal results under ideal conditions (multivariate normality and absence of outliers), real-world data often violate these assumptions. The presence of outliers, heavy-tailed distributions, or other departures from normality can severely compromise the reliability of classical estimators, leading to biased parameter estimates and inflated error rates in hypothesis testing.</p>
<p>The need for robust estimation in <em>multivariate</em> regression has been recognized since the early development of robust statistical methods <span class="citation">(<a href="#ref-Huber1964">Huber, 1964</a>; <a href="#ref-Tukey1960">Tukey, 1960</a>)</span>.
Outliers in multivariate data can be particularly problematic because they may not be readily apparent when examining univariate marginal distributions, yet can exert substantial leverage on the fitted model. Furthermore, the <em>curse of dimensionality</em> means that as the number of response variables increases, the probability of encountering at least one outlying observation grows rapidly.</p>
<p>Robust multivariate regression methods aim to provide reliable parameter estimates and inference procedures that remain stable in the presence of outlying observations. As noted by <span class="citation">Rousseeuw, Van Aelst, Van Driessen, &amp; Gulló (<a href="#ref-Rousseeuw2004">2004</a>)</span>, “<em>The main advantage of robust regression is that it provides reliable results even when some of the assumptions of classical regression are violated.</em>”</p>
<p>Several approaches have been developed for robust multivariate regression, including M-estimators, S-estimators <span class="citation">(<a href="#ref-Rousseeuw1984">Rousseeuw &amp; Yohai, 1984</a>)</span>, and MM-estimators <span class="citation">(<a href="#ref-Yohai1987">Yohai, 1987</a>)</span>. Each approach offers different trade-offs between robustness properties, computational efficiency, and statistical efficiency under ideal conditions. See the <a href="https://cran.r-project.org/view=Robust" class="external-link">CRAN Task View: Robust Statistical Methods</a> for an extensive list of
robust methods in R. The vignette for the <a href="https://cran.r-project.org/package=rrcov" class="external-link">rrcov package</a>, obtained by <code>vignette(package = "rrcov")</code>,
contains a general overview of multivariate robust methods.</p>
<p>The method implemented in the <code><a href="../reference/robmlm.html">robmlm()</a></code> function belongs to the class of <strong>M-estimators</strong>, which generalize maximum likelihood estimation by replacing the likelihood function with a more robust objective function.</p>
<p>The key idea is to relax the least squares criterion of minimizing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐞</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>Σ</mi><msubsup><mi>e</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><mi>Σ</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo>−</mo><msub><mover><mi>y</mi><mo accent="true">̂</mo></mover><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">Q(\mathbf{e}) = \Sigma e_i^2 = \Sigma (y_i - \hat{y}_i)^2</annotation></semantics></math> by considering more general functions <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>𝐞</mi><mo>,</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Q(\mathbf{e}, \rho)</annotation></semantics></math>, where the function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho (e_i)</annotation></semantics></math> can be chosen to reduce the impact of large outliers. In these terms,</p>
<ul>
<li>OLS uses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mi>e</mi><mi>i</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\rho(e_i) = e_i^2</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>L</mi><mn>1</mn></msub><annotation encoding="application/x-tex">L_1</annotation></semantics></math> estimation uses <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo stretchy="false" form="postfix">|</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">|</mo></mrow><annotation encoding="application/x-tex">\rho(e_i) = \vert e_i \vert</annotation></semantics></math>, the least absolute values</li>
<li>A bit more complicated, the <strong>biweight</strong> function uses a squared measure of error up to some value <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math> and then
levels off thereafter,</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><msub><mi>e</mi><mi>i</mi></msub><mi>c</mi></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">]</mo></mrow><mn>2</mn></msup></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>≤</mo><mi>c</mi><mo>,</mo></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">|</mo></mrow><mo>&gt;</mo><mi>c</mi><mi>.</mi></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\rho(e_i) =
\begin{cases} 
\left[ 1 - \left( \frac{e_i}{c} \right)^2 \right]^2 &amp; |e_i| \leq c, \\
1 &amp; |e_i| &gt; c.
\end{cases}
</annotation></semantics></math></p>
<p>These functions look like this in a graph. The biweight function has a property
like Windsorizing— the squared error remains constant for residuals <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>e</mi><mi>i</mi></msub><mo>&gt;</mo><mi>c</mi></mrow><annotation encoding="application/x-tex">e_i &gt; c</annotation></semantics></math>,
with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>=</mo><mn>4.685</mn></mrow><annotation encoding="application/x-tex">c = 4.685</annotation></semantics></math> for <code><a href="https://rdrr.io/pkg/MASS/man/rlm.html" class="external-link">MASS::psi.bisquare()</a></code>.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:fig-weight-fns"></span>
<img src="../reference/figures/weight-functions.jpg" alt="Diagram ploting the function $\rho(e_i)$ of the contributions of the residuals $e_i$ to what is minimized in various fitting methods." width="70%"><p class="caption">
Figure 1: Diagram ploting the function <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>e</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho(e_i)</annotation></semantics></math> of the contributions of the residuals <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>e</mi><mi>i</mi></msub><annotation encoding="application/x-tex">e_i</annotation></semantics></math> to what is minimized in various fitting methods.
</p>
</div>
</div>
<div class="section level2">
<h2 id="methodology-iteratively-reweighted-least-squares-irls">Methodology: Iteratively Reweighted Least Squares (IRLS)<a class="anchor" aria-label="anchor" href="#methodology-iteratively-reweighted-least-squares-irls"></a>
</h2>
<p>The <code><a href="../reference/robmlm.html">robmlm()</a></code> function implements robust multivariate linear model fitting using Iteratively Reweighted Least Squares (IRLS), a flexible and computationally efficient approach that belongs to the family of M-estimators. The core idea behind IRLS is to iteratively downweight observations that appear to be outliers based on their residual distances from the fitted model.</p>
<div class="section level3">
<h3 id="the-irls-algorithm">The IRLS Algorithm<a class="anchor" aria-label="anchor" href="#the-irls-algorithm"></a>
</h3>
<p>The IRLS algorithm for robust multivariate regression is shown in the figure below.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="../reference/figures/IRWLS-flowchart.jpg" alt="Flowchart for the iteratively reweighted least squares algorithm" width="70%"><p class="caption">
Figure 2: Flowchart for the iteratively reweighted least squares algorithm
</p>
</div>
<p>The method proceeds as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Initialization</strong>: Begin with an initial estimate of the regression coefficients, typically obtained from ordinary least squares (OLS).</p></li>
<li><p><strong>Residual calculation</strong>: Compute the multivariate residuals for each observation:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>𝐫</mi><mi>i</mi></msub><mo>=</mo><msub><mi>𝐲</mi><mi>i</mi></msub><mo>−</mo><msub><mi>𝐗</mi><mi>i</mi></msub><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover></mrow><annotation encoding="application/x-tex">\mathbf{r}_i = \mathbf{y}_i - \mathbf{X}_i\hat{\boldsymbol{\beta}}</annotation></semantics></math>
where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐲</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{y}_i</annotation></semantics></math> is the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p \times 1</annotation></semantics></math> response vector for observation <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐗</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathbf{X}_i</annotation></semantics></math> is the corresponding row of the design matrix, and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}</annotation></semantics></math> is the current estimate of the coefficient matrix.</p></li>
<li><p><strong>Distance computation</strong>: Calculate the squared Mahalanobis distance of each residual vector from the origin:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>d</mi><mi>i</mi><mn>2</mn></msubsup><mo>=</mo><msubsup><mi>𝐫</mi><mi>i</mi><mi>T</mi></msubsup><msup><mi>𝐒</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><msub><mi>𝐫</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">d_i^2 = \mathbf{r}_i^T \mathbf{S}^{-1} \mathbf{r}_i</annotation></semantics></math>
where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐒</mi><annotation encoding="application/x-tex">\mathbf{S}</annotation></semantics></math> is a robust estimate of the residual covariance matrix, computed using <code><a href="https://rdrr.io/pkg/MASS/man/cov.trob.html" class="external-link">MASS::cov.trob()</a></code>.</p></li>
<li><p><strong>Weight assignment</strong>: Assign weights to each observation based on their residual distances. Observations with larger distances receive smaller weights, effectively downweighting potential outliers:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub><mo>=</mo><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>i</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">w_i = \rho(d_i^2)</annotation></semantics></math>
where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>⋅</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho(\cdot)</annotation></semantics></math> is a weight function that decreases as the distance increases.</p></li>
<li><p><strong>Weighted Least Squares</strong>: Update the coefficient estimates using weighted least squares:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover><mi>𝛃</mi><mo accent="true">̂</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mi>e</mi><mi>w</mi><mo stretchy="true" form="postfix">)</mo></mrow></msup><mo>=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>𝐗</mi><mi>T</mi></msup><mi>𝐖</mi><mi>𝐗</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>−</mi><mn>1</mn></mrow></msup><msup><mi>𝐗</mi><mi>T</mi></msup><mi>𝐖</mi><mi>𝐘</mi></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{\beta}}^{(new)} = (\mathbf{X}^T\mathbf{W}\mathbf{X})^{-1}\mathbf{X}^T\mathbf{W}\mathbf{Y}</annotation></semantics></math>
where <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>𝐖</mi><annotation encoding="application/x-tex">\mathbf{W}</annotation></semantics></math> is a diagonal matrix of weights.</p></li>
<li><p><strong>Convergence check</strong>: Repeat steps 2-5 until convergence, typically assessed by monitoring changes in the coefficient estimates or weights between iterations.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="features-of-the-implementation">Features of the Implementation<a class="anchor" aria-label="anchor" href="#features-of-the-implementation"></a>
</h3>
<p>The <code><a href="../reference/robmlm.html">robmlm()</a></code> implementation incorporates several important features:</p>
<ul>
<li><p><strong>Robust covariance estimation</strong>: The use of <code><a href="https://rdrr.io/pkg/MASS/man/cov.trob.html" class="external-link">MASS::cov.trob()</a></code> provides a robust estimate of the residual covariance matrix, which is crucial for computing meaningful Mahalanobis distances in the presence of outliers.
This uses the multivariate <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math> distribution that allows for longer tails.
(There are other robust covariance estimators, such as Minimum Covariance Determinant (MCD) and Minimum Volume Ellipse (MVE), which have a high tolerance—breakdown-bound– for outliers. These might come to a future version of <code><a href="../reference/robmlm.html">robmlm()</a></code>.)</p></li>
<li><p><strong>Inheritance Structure</strong>: The returned object inherits from both <code>"mlm"</code> and <code>"lm"</code> classes, ensuring compatibility with existing R infrastructure for linear models while adding robust-specific methods.</p></li>
<li><p><strong>Weight Preservation</strong>: The final weights are preserved in the fitted object, allowing users to identify influential observations and assess the impact of the robust fitting procedure.</p></li>
<li><p><strong>Diagnostic Capabilities</strong>: The <code><a href="../reference/plot.robmlm.html">plot.robmlm()</a></code> method provides immediate visual feedback on the weighting scheme, plotting final weights against case numbers to highlight observations that were down-weighted during the fitting process.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="theoretical-properties">Theoretical Properties<a class="anchor" aria-label="anchor" href="#theoretical-properties"></a>
</h3>
<p>The IRLS approach offers several desirable theoretical properties:</p>
<ul>
<li><p><strong>Breakdown Point</strong>: While not achieving the highest possible breakdown point, M-estimators like those implemented in IRLS can handle a reasonable proportion of outliers before completely breaking down.</p></li>
<li><p><strong>Influence Function</strong>: The bounded influence function of M-estimators ensures that no single observation can have unlimited impact on the final estimates.</p></li>
<li><p><strong>Asymptotic Efficiency</strong>: Under ideal conditions (no outliers, multivariate normality), robust M-estimators achieve high efficiency relative to classical least squares estimators.</p></li>
<li><p><strong>Equivariance</strong>: The robust estimates maintain appropriate equivariance properties under linear transformations of the data.</p></li>
</ul>
<!--
## Structure of This Vignette

In the following sections, we will demonstrate the practical application of `robmlm()` through several illustrative examples:

1. **Basic Usage**: Simple examples showing how to fit robust multivariate linear models and interpret the results.

2. **Comparison with Classical Methods**: Side-by-side comparisons highlighting the differences between robust and classical estimates in the presence of outliers.

3. **Diagnostic Tools**: Detailed exploration of diagnostic methods, including weight plots and residual analysis.

4. **Real Data Applications**: Examples using datasets from the `heplots` package and other sources that demonstrate the practical utility of robust estimation.

5. **Advanced Topics**: Discussion of model selection, hypothesis testing, and confidence intervals in the robust multivariate regression context.

Each example will include both the R code and interpretation of results, with particular attention to how robust methods can provide more reliable insights when data quality is questionable.
-->
</div>
</div>
<div class="section level2">
<h2 id="example-pottery-data">Example: Pottery Data<a class="anchor" aria-label="anchor" href="#example-pottery-data"></a>
</h2>
<p>We begin with a simple but illustrative example using the pottery composition data from the <code>carData</code> package. This dataset contains measurements of five chemical elements (<code>Al</code>, <code>Fe</code>, <code>Mg</code>, <code>Ca</code>, <code>Na</code>) in pottery samples from four different archaeological sites. The goal is to determine whether the chemical composition differs significantly across sites, a classic one-way MANOVA problem. Alternatively, it can be framed as a problem in discriminant analysis, asking whether
these chemical elements can be used to distinguish among the sites.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://friendly.github.io/heplots" class="external-link">heplots</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">carData</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-forge.r-project.org/projects/car/" class="external-link">car</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load the pottery data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Pottery</span>, package <span class="op">=</span> <span class="st">"carData"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">Pottery</span><span class="op">)</span></span>
<span><span class="co">#&gt;        Site   Al   Fe   Mg   Ca   Na</span></span>
<span><span class="co">#&gt; 1 Llanedyrn 14.4 7.00 4.30 0.15 0.51</span></span>
<span><span class="co">#&gt; 2 Llanedyrn 13.8 7.08 3.43 0.12 0.17</span></span>
<span><span class="co">#&gt; 3 Llanedyrn 14.6 7.09 3.88 0.13 0.20</span></span>
<span><span class="co">#&gt; 4 Llanedyrn 11.5 6.37 5.64 0.16 0.14</span></span>
<span><span class="co">#&gt; 5 Llanedyrn 13.8 7.06 5.34 0.20 0.20</span></span>
<span><span class="co">#&gt; 6 Llanedyrn 10.9 6.26 3.47 0.17 0.22</span></span></code></pre></div>
<p>The pottery dataset contains 26 observations with measurements of five response variables representing chemical concentrations. Let’s examine the basic structure:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">Pottery</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    26 obs. of  6 variables:</span></span>
<span><span class="co">#&gt;  $ Site: Factor w/ 4 levels "AshleyRails",..: 4 4 4 4 4 4 4 4 4 4 ...</span></span>
<span><span class="co">#&gt;  $ Al  : num  14.4 13.8 14.6 11.5 13.8 10.9 10.1 11.6 11.1 13.4 ...</span></span>
<span><span class="co">#&gt;  $ Fe  : num  7 7.08 7.09 6.37 7.06 6.26 4.26 5.78 5.49 6.92 ...</span></span>
<span><span class="co">#&gt;  $ Mg  : num  4.3 3.43 3.88 5.64 5.34 3.47 4.26 5.91 4.52 7.23 ...</span></span>
<span><span class="co">#&gt;  $ Ca  : num  0.15 0.12 0.13 0.16 0.2 0.17 0.2 0.18 0.29 0.28 ...</span></span>
<span><span class="co">#&gt;  $ Na  : num  0.51 0.17 0.2 0.14 0.2 0.22 0.18 0.16 0.3 0.2 ...</span></span></code></pre></div>
<p>The pottery samples are not evenly distributed across the sites. The most come from Llanedyrn; there are only two from
Caldicot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">Pottery</span><span class="op">$</span><span class="va">Site</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; AshleyRails    Caldicot  IsleThorns   Llanedyrn </span></span>
<span><span class="co">#&gt;           5           2           5          14</span></span></code></pre></div>
<div class="section level3">
<h3 id="classical-manova">Classical MANOVA<a class="anchor" aria-label="anchor" href="#classical-manova"></a>
</h3>
<p>We begin with the standard MANOVA model, and then examine some diagnostic plots.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classical MANOVA model</span></span>
<span><span class="va">pottery.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Al</span>, <span class="va">Fe</span>, <span class="va">Mg</span>, <span class="va">Ca</span>, <span class="va">Na</span><span class="op">)</span> <span class="op">~</span> <span class="va">Site</span>, data <span class="op">=</span> <span class="va">Pottery</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">pottery.mlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;      Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Site  3      1.55      4.3     15     60 2.4e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p><strong>Chisquare QQ plot</strong>:
As an initial check, a <code><a href="../reference/cqplot.html">cqplot()</a></code> of the model gives a <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>χ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\chi^2</annotation></semantics></math> QQ plot of the residuals from the model,
which would identify badly fit observations. None seem particularly large here.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/cqplot.html">cqplot</a></span><span class="op">(</span><span class="va">pottery.mlm</span>, id.n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pottery-cqplot"></span>
<img src="fig/robust-pottery-cqplot-1.png" alt="Chisquare QQ plot for the Pottery model."><p class="caption">
Figure 3: Chisquare QQ plot for the Pottery model.
</p>
</div>
<p><strong>Influence plot</strong>:
An <em>influence plot</em> for this model, done using <code>mvinfluence::influencePlot()</code> plots the leverage multivariate hat-values for the predictors (<code>site</code>) against squared multivariate studentized residuals, using the size of the point symbol proportional to a multivariate generalization of Cook’s D statistic.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/car/man/influencePlot.html" class="external-link">influencePlot</a></span><span class="op">(</span><span class="va">pottery.mlm</span>, id.n <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pottery-inflplot"></span>
<img src="fig/robust-pottery-inflplot-1.png" alt="Influence plot for the Pottery model."><p class="caption">
Figure 4: Influence plot for the Pottery model.
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">CookD</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;          H        Q   CookD       L       R</span></span>
<span><span class="co">#&gt; 25 0.20000 0.621766 0.68394 0.25000 0.77721</span></span>
<span><span class="co">#&gt; 18 0.20000 0.355067 0.39057 0.25000 0.44383</span></span>
<span><span class="co">#&gt; 11 0.07143 0.587152 0.23067 0.07692 0.63232</span></span>
<span><span class="co">#&gt; 16 0.50000 0.006379 0.01754 1.00000 0.01276</span></span>
<span><span class="co">#&gt; 15 0.50000 0.006379 0.01754 1.00000 0.01276</span></span></code></pre></div>
<p>Because <code>site</code> is a factor, the hat-values are inversely proportional to the sample size. Points for Llanedryn (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>14</mn></mrow><annotation encoding="application/x-tex">n=14</annotation></semantics></math>) are in the
left-most column, followed by AshleyRails and IsleThorns (each with <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>5</mn></mrow><annotation encoding="application/x-tex">n=5</annotation></semantics></math>) and then Caldicot (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>=</mo><mn>14</mn></mrow><annotation encoding="application/x-tex">n=14</annotation></semantics></math>).</p>
<p>Here, case 25 stands out with the largest value of Cook’s D, followed by 18 and 11.</p>
</div>
<div class="section level3">
<h3 id="robust-manova">Robust MANOVA<a class="anchor" aria-label="anchor" href="#robust-manova"></a>
</h3>
<p>Now, fit the robust model using <code><a href="../reference/robmlm.html">robmlm()</a></code>. Because this uses an interative IRLS method, points that might not seem unusual
in the initial model can become more noteworthy when the extreme observations are down-weighted in a subsequent iteration.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Robust MANOVA model</span></span>
<span><span class="va">pottery.rlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/robmlm.html">robmlm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">Al</span>, <span class="va">Fe</span>, <span class="va">Mg</span>, <span class="va">Ca</span>, <span class="va">Na</span><span class="op">)</span> <span class="op">~</span> <span class="va">Site</span>, data <span class="op">=</span> <span class="va">Pottery</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova</a></span><span class="op">(</span><span class="va">pottery.rlm</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Type II MANOVA Tests: Pillai test statistic</span></span>
<span><span class="co">#&gt;      Df test stat approx F num Df den Df  Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Site  3      1.98     6.55     15     51 1.7e-07 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span></code></pre></div>
<p>Let’s compare the results. From the results of <code><a href="https://rdrr.io/pkg/car/man/Anova.html" class="external-link">Anova()</a></code> above, you can see that
the <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> statistic for the robust model is greater than that for OLS,
which suggests that possible outliers may have reduced the strength of evidence for differences among the sites.</p>
<p>It is useful to compare the coefficients of the two models, and for this, their relative difference is
a useful metric. The simple function <code>reldiff()</code> expresses these as the signed percent of difference
between the classical and robust estimatges</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">b.mlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pottery.mlm</span><span class="op">)</span></span>
<span><span class="va">b.rlm</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">pottery.rlm</span><span class="op">)</span></span>
<span></span>
<span><span class="va">reldiff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">pct</span><span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="va">y</span><span class="op">)</span> <span class="op">/</span> <span class="va">x</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">pct</span><span class="op">)</span> <span class="va">res</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="op">*</span> <span class="va">res</span></span>
<span>  <span class="va">res</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">reldiff</span><span class="op">(</span><span class="va">b.mlm</span>, <span class="va">b.rlm</span><span class="op">)</span></span>
<span><span class="co">#&gt;                     Al      Fe      Mg      Ca      Na</span></span>
<span><span class="co">#&gt; (Intercept)      3.616  20.480  2.5908  10.333  0.6925</span></span>
<span><span class="co">#&gt; SiteCaldicot   -11.145   7.934  0.4832   2.211 16.6192</span></span>
<span><span class="co">#&gt; SiteIsleThorns  64.510 136.881 25.1469 -21.792  1.9605</span></span>
<span><span class="co">#&gt; SiteLlanedyrn  -11.559   9.969  2.0078   6.241 22.7443</span></span></code></pre></div>
<p>Among these, the coefficients for IsleThorns are quite different for most of the variables.</p>
</div>
<div class="section level3">
<h3 id="examining-the-robust-weights">Examining the Robust Weights<a class="anchor" aria-label="anchor" href="#examining-the-robust-weights"></a>
</h3>
<p>The robust fitting procedure assigns weights to each observation based on their deviation from the fitted model. Observations that appear to be outliers receive lower weights. The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method for a <code>"roblm"</code> object gives an index plot of the weight values.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot the weights from robust fitting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">pottery.rlm</span>, col<span class="op">=</span><span class="va">Pottery</span><span class="op">$</span><span class="va">Site</span>, segments<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">xloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7.5</span>, <span class="fl">15.5</span>, <span class="fl">19.5</span>, <span class="fl">24</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">xloc</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">1.05</span><span class="op">)</span>, length<span class="op">=</span><span class="fl">5</span><span class="op">)</span>, </span>
<span>     <span class="fu"><a href="https://rdrr.io/r/base/levels.html" class="external-link">levels</a></span><span class="op">(</span><span class="va">Pottery</span><span class="op">$</span><span class="va">Site</span><span class="op">)</span>, pos <span class="op">=</span><span class="fl">3</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pottery-weights"></span>
<img src="fig/robust-pottery-weights-1.png" alt="Weights from robust MANOVA fitting showing potential outliers"><p class="caption">
Figure 5: Weights from robust MANOVA fitting showing potential outliers
</p>
</div>
<p>The weight plot reveals which observations were considered potentially problematic during the robust fitting process. Observations with weights substantially below 1.0 were down-weighted, indicating they may be outliers in the multivariate space defined by the five chemical measurements.</p>
</div>
<div class="section level3">
<h3 id="hypothesis-error-he-plots">Hypothesis-Error (HE) plots<a class="anchor" aria-label="anchor" href="#hypothesis-error-he-plots"></a>
</h3>
<p>HE plots provide a visual representation of the multivariate hypothesis test by showing the relationship between hypothesis and error variation in a reduced dimensional space. We’ll create HE plots for the first two variables (Al and Fe) and compare the classical and robust fits.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Classical HE plot for Al and Fe</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">pottery.mlm</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Al"</span>, <span class="st">"Fe"</span><span class="op">)</span>, </span>
<span>       main <span class="op">=</span> <span class="st">"Classical vs Robust MANOVA: Al vs Fe"</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"blue"</span><span class="op">)</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Overlay robust HE plot</span></span>
<span><span class="fu"><a href="../reference/heplot.html">heplot</a></span><span class="op">(</span><span class="va">pottery.rlm</span>, variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Al"</span>, <span class="st">"Fe"</span><span class="op">)</span>, </span>
<span>       add <span class="op">=</span> <span class="cn">TRUE</span>, error.ellipse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span>, <span class="st">"red"</span><span class="op">)</span>, </span>
<span>       fill <span class="op">=</span> <span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add legend</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Classical"</span>, <span class="st">"Robust"</span><span class="op">)</span>, </span>
<span>       col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span>, </span>
<span>       lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, </span>
<span>       fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span></span>
<span>       <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pottery-heplot"></span>
<img src="fig/robust-pottery-heplot-1.png" alt="HE plot comparing classical (blue) and robust (red) MANOVA for Al vs Fe"><p class="caption">
Figure 6: HE plot comparing classical (blue) and robust (red) MANOVA for Al vs Fe
</p>
</div>
<p>The <strong>H</strong> and <strong>E</strong> ellipses have approximately the same shape and orientation for the classical and robust models, indicating
that the pattern of differences among the group means is quite similar for both models. However, the <strong>E</strong> ellipse for the robust
model is noticeably smaller. This goes into the greater <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>F</mi><annotation encoding="application/x-tex">F</annotation></semantics></math> statistic for the robust model.</p>
<p>For a more complete interpretation of robust model, a scatterplot matrix of HE plots is shown below, using the <code><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs()</a></code> method
for a MLM.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/pairs.html" class="external-link">pairs</a></span><span class="op">(</span><span class="va">pottery.rlm</span>, </span>
<span>      fill<span class="op">=</span><span class="cn">TRUE</span>, fill.alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:pottery-pairs"></span>
<img src="fig/robust-pottery-pairs-1.png" alt="Pairwise HE plots for all response variables in the robust model `pottery.rlm`"><p class="caption">
Figure 7: Pairwise HE plots for all response variables in the robust model <code>pottery.rlm</code>
</p>
</div>
</div>
<div class="section level3">
<h3 id="interpretation-and-discussion">Interpretation and Discussion<a class="anchor" aria-label="anchor" href="#interpretation-and-discussion"></a>
</h3>
<p>Several important insights emerge from this analysis of the Pottery data</p>
<ul>
<li>
<strong>Model evaluation</strong>: The comparison of MANOVA results shows …</li>
</ul>
<!--
|r ifelse(abs(log10(robust_anova$"Pr(>F)"[1]) - log10(classical_anova$"Pr(>F)"[1])) > 0.5, "substantial differences", "similar patterns")| between classical and robust approaches. 
This indicates |r ifelse(abs(log10(robust_anova$"Pr(>F)"[1]) - log10(classical_anova$"Pr(>F)"[1])) > 0.5, "that outliers are influencing the classical analysis", "that the data are relatively well-behaved with respect to outliers")|.
--><ul>
<li><p><strong>Outlier detection</strong>: The weight plot identifies specific observations that deviate from the typical pattern. In archaeological studies, such outliers might represent pottery from different time periods, contaminated samples, or measurement errors that warrant further investigation.</p></li>
<li><p><strong>Geometric interpretation</strong>: The HE plot comparison reveals how outliers affect the geometric representation of the hypothesis test. The hypothesis ellipse (representing the Site effect) and error ellipse (representing within-group variation) may differ substantially between classical and robust fits when influential outliers are present.</p></li>
<li><p><strong>Practical implications</strong>: For archaeologists studying pottery composition, the robust analysis provides more reliable conclusions about site differences by reducing the influence of potentially problematic observations. This is particularly important when making inferences about ancient trade routes, cultural practices, or chronological relationships based on chemical composition data.</p></li>
</ul>
<p>The robust approach demonstrates its value by providing a more stable analysis that is less susceptible to the influence of outlying observations, while still maintaining high efficiency when the data conform to standard assumptions.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Huber1964" class="csl-entry">
Huber, P. J. (1964). Robust estimation of a location parameter. <em>The Annals of Mathematical Statistics</em>, <em>35</em>(1), 73–101.
</div>
<div id="ref-Rousseeuw2004" class="csl-entry">
Rousseeuw, P. J., Van Aelst, S., Van Driessen, K., &amp; Gulló, J. A. (2004). Robust multivariate regression. <em>Technometrics</em>, <em>46</em>(3), 293–305. http://doi.org/<a href="https://doi.org/10.1198/004017004000000329" class="external-link">10.1198/004017004000000329</a>
</div>
<div id="ref-Rousseeuw1984" class="csl-entry">
Rousseeuw, P. J., &amp; Yohai, V. J. (1984). Robust regression by means of <span>S</span>-estimators. In J. Franke, W. Härdle, &amp; D. Martin (Eds.), <em>Robust and nonlinear time series analysis</em> (Vol. 26, pp. 256–272). New York: Springer.
</div>
<div id="ref-Tukey1960" class="csl-entry">
Tukey, J. W. (1960). A survey of sampling from contaminated distributions.
</div>
<div id="ref-Yohai1987" class="csl-entry">
Yohai, V. J. (1987). High breakdown-point and high efficiency robust estimates for regression. <em>The Annals of Statistics</em>, <em>15</em>(2), 642–656.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Michael Friendly, John Fox, Georges Monette.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
