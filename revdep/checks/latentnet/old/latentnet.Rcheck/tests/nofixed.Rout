
R version 4.5.1 (2025-06-13 ucrt) -- "Great Square Root"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #  File tests/nofixed.R in package latentnet, part of the
> #  Statnet suite of packages for network analysis, https://statnet.org .
> #
> #  This software is distributed under the GPL-3 license.  It is free,
> #  open source, and has the attribution requirements (GPL Section 7) at
> #  https://statnet.org/attribution .
> #
> #  Copyright 2003-2024 Statnet Commons
> ################################################################################
> library(latentnet)
Loading required package: network

'network' 1.19.0 (2024-12-08), part of the Statnet Project
* 'news(package="network")' for changes since last version
* 'citation("network")' for citation information
* 'https://statnet.org' for help, support, and other information

Loading required package: ergm

'ergm' 4.9.0 (2025-06-09), part of the Statnet Project
* 'news(package="ergm")' for changes since last version
* 'citation("ergm")' for citation information
* 'https://statnet.org' for help, support, and other information

'ergm' 4 is a major update that introduces some backwards-incompatible
changes. Please type 'news(package="ergm")' for a list of major
changes.


'latentnet' 2.11.0 (2024-02-19), part of the Statnet Project
* 'news(package="latentnet")' for changes since last version
* 'citation("latentnet")' for citation information
* 'https://statnet.org' for help, support, and other information
NOTE: BIC calculation prior to latentnet 2.7.0 had a bug in the calculation of the effective number of parameters. See help(summary.ergmm) for details.
NOTE: Prior to version 2.8.0, handling of fixed effects for directed networks had a bug: the covariate matrix was transposed.
> 
> data(sampson)
> 
> monks.nf<-ergmm(samplike~euclidean(d=2)+rreceiver-1)
> mcmc.diagnostics(monks.nf)
Chain 1 
Lag 0 
                   lpY       Z.1.1       Z.1.2 receiver.1
lpY         1.00000000 -0.05709638  0.23727427  0.5577590
Z.1.1      -0.05709638  1.00000000 -0.02483103 -0.1220924
Z.1.2       0.23727427 -0.02483103  1.00000000  0.3358570
receiver.1  0.55775898 -0.12209242  0.33585697  1.0000000

Lag 10 
                   lpY       Z.1.1       Z.1.2  receiver.1
lpY         0.62003986 -0.04215089  0.19321176  0.48545452
Z.1.1      -0.03273411  0.41106110 -0.01142003 -0.08129454
Z.1.2       0.20742813 -0.01972762  0.43718352  0.22287156
receiver.1  0.47434032 -0.08922087  0.21201452  0.58398138

[[1]]

Quantile (q) = 0.025
Accuracy (r) = +/- 0.0125
Probability (s) = 0.95 
                                                  
            Burn-in  Total Lower bound  Dependence
            (M)      (N)   (Nmin)       factor (I)
 lpY        80       13250 600          22.1      
 Z.1.1      50       9440  600          15.7      
 Z.1.2      50       9050  600          15.1      
 receiver.1 80       13570 600          22.6      


> plot(gof(monks.nf))
> predict(monks.nf)
           [,1]      [,2]       [,3]       [,4]      [,5]       [,6]      [,7]
 [1,] 0.8962735 0.7565976 0.17510147 0.17156684 0.3652247 0.07632886 0.5094282
 [2,] 0.7477035 0.8958151 0.15904285 0.09771219 0.2304742 0.04195682 0.5678317
 [3,] 0.5047720 0.4804638 0.61795630 0.09532197 0.2347941 0.03944722 0.2629100
 [4,] 0.3684155 0.2410173 0.05718025 0.74418770 0.6625702 0.28769643 0.1178702
 [5,] 0.4727365 0.3259803 0.09004058 0.52886006 0.8424311 0.24744983 0.1669861
 [6,] 0.3969296 0.2653689 0.06348078 0.53813405 0.6273725 0.49152963 0.1342926
 [7,] 0.7258207 0.7759920 0.16058493 0.11130796 0.2526313 0.04825306 0.7596093
 [8,] 0.5490830 0.4050163 0.08718859 0.46292407 0.6206073 0.23269756 0.2255737
 [9,] 0.4801870 0.3430062 0.07627317 0.45883144 0.6449483 0.24083247 0.1848400
[10,] 0.4577921 0.3202074 0.08317991 0.53041400 0.6574361 0.24153854 0.1658801
[11,] 0.5069236 0.3748253 0.07723327 0.48876671 0.6495744 0.21006919 0.1996524
[12,] 0.7287069 0.7759404 0.11334037 0.10588336 0.2364922 0.04630126 0.5433339
[13,] 0.4380646 0.3737802 0.33729211 0.15326476 0.3343902 0.06409494 0.2023479
[14,] 0.7494441 0.7380482 0.11221344 0.15575653 0.3134462 0.06656550 0.4646647
[15,] 0.7459253 0.7748901 0.12337811 0.12843639 0.2791983 0.05547570 0.5242982
[16,] 0.7192753 0.7194454 0.12554057 0.15217007 0.3137709 0.06670887 0.5406496
[17,] 0.4459143 0.4260495 0.43982974 0.08766261 0.2158257 0.03596469 0.2241003
[18,] 0.4992825 0.4740677 0.44909006 0.09935379 0.2435164 0.04093085 0.2609943
           [,8]       [,9]      [,10]      [,11]     [,12]     [,13]     [,14]
 [1,] 0.2530564 0.17364942 0.08696356 0.14821777 0.5923847 0.2400966 0.5321734
 [2,] 0.1538528 0.10286039 0.04881300 0.09028122 0.6420977 0.1909274 0.5093467
 [3,] 0.1145123 0.08262801 0.04810584 0.06356584 0.2442449 0.4975291 0.1819272
 [4,] 0.4013223 0.35210898 0.26120119 0.31221702 0.1469594 0.1679177 0.1590872
 [5,] 0.4140505 0.39679658 0.25005393 0.33136199 0.2007776 0.2434208 0.2087456
 [6,] 0.4076816 0.37217740 0.22467416 0.26750720 0.1663548 0.1768833 0.1754723
 [7,] 0.1739134 0.11891131 0.05564619 0.09986561 0.6184670 0.2095751 0.4562002
 [8,] 0.6937182 0.43280364 0.26639356 0.30384395 0.2710724 0.2075562 0.2779180
 [9,] 0.4816537 0.64739727 0.24738903 0.27693578 0.2274742 0.1955584 0.2289561
[10,] 0.4767570 0.40358205 0.46540469 0.29014782 0.1999416 0.2220842 0.2100955
[11,] 0.4199249 0.34199423 0.21382092 0.57173578 0.2544848 0.1901343 0.2765238
[12,] 0.1636257 0.11376537 0.05150979 0.10113808 0.8105993 0.1486028 0.5380400
[13,] 0.1545035 0.12171738 0.07706885 0.09049728 0.1838848 0.7645120 0.1476878
[14,] 0.2231401 0.15483759 0.07501932 0.15009964 0.6223767 0.1590647 0.7530923
[15,] 0.1917736 0.13346858 0.06183942 0.12043667 0.6327138 0.1662969 0.5662710
[16,] 0.2215786 0.16352481 0.07417686 0.14120287 0.5836178 0.1825493 0.4690233
[17,] 0.1014718 0.07473980 0.04385504 0.05596495 0.2054399 0.5025923 0.1501872
[18,] 0.1171324 0.08553618 0.05003956 0.06569528 0.2392235 0.5276771 0.1789074
           [,15]      [,16]      [,17]      [,18]
 [1,] 0.30993960 0.28918203 0.10556767 0.16866759
 [2,] 0.33952805 0.28635051 0.09708235 0.15117737
 [3,] 0.09513472 0.09968232 0.35771443 0.44582092
 [4,] 0.05862684 0.07288195 0.03720129 0.05897666
 [5,] 0.08439511 0.10197664 0.05938292 0.09256263
 [6,] 0.06766131 0.08265643 0.04214680 0.06452195
 [7,] 0.30388883 0.32702170 0.09944906 0.15677801
 [8,] 0.11537519 0.13822675 0.05612566 0.08837175
 [9,] 0.09387784 0.11890858 0.05005474 0.07773972
[10,] 0.08265271 0.10059554 0.05549921 0.08532262
[11,] 0.11007263 0.13065953 0.04974927 0.07943122
[12,] 0.33237957 0.29668026 0.06779719 0.10935179
[13,] 0.07184782 0.08196437 0.27224309 0.36092309
[14,] 0.34755441 0.27039670 0.06634476 0.10813322
[15,] 0.54821023 0.30662645 0.07343777 0.11924892
[16,] 0.30069729 0.55378450 0.07632344 0.12241991
[17,] 0.07720786 0.08185831 0.53300109 0.44106820
[18,] 0.09271594 0.09828430 0.36300379 0.61563656
> simulate(monks.nf)
 Network attributes:
  vertices = 18 
  directed = TRUE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 67 
    missing edges= 0 
    non-missing edges= 67 

 Vertex attribute names: 
    vertex.names 

No edge attributes
> print(summary(monks.nf))
NOTE: It is not certain whether it is appropriate to use latentnet's BIC to select latent space dimension, whether or not to include actor-specific random effects, and to compare clustered models with the unclustered model.

==========================
Summary of model fit
==========================

Formula:   samplike ~ euclidean(d = 2) + rreceiver - 1
Attribute: edges
Model:     Bernoulli 
MCMC sample of size 4000, draws are 10 iterations apart, after burnin of 10000 iterations.
Receiver effect variance: 2.064052.
Overall BIC:        383.7178 
Likelihood BIC:     243.4487 
Latent space/clustering BIC:     98.75324 
Receiver effect BIC:     41.51585 

> 
> proc.time()
   user  system elapsed 
  28.01    1.60   30.21 
