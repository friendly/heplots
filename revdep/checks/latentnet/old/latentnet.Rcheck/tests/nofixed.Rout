
R version 4.3.2 (2023-10-31 ucrt) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> #  File tests/nofixed.R in package latentnet, part of the
> #  Statnet suite of packages for network analysis, https://statnet.org .
> #
> #  This software is distributed under the GPL-3 license.  It is free,
> #  open source, and has the attribution requirements (GPL Section 7) at
> #  https://statnet.org/attribution .
> #
> #  Copyright 2003-2022 Statnet Commons
> ################################################################################
> library(latentnet)
Loading required package: network

'network' 1.18.2 (2023-12-04), part of the Statnet Project
* 'news(package="network")' for changes since last version
* 'citation("network")' for citation information
* 'https://statnet.org' for help, support, and other information

Loading required package: ergm

'ergm' 4.6.0 (2023-12-17), part of the Statnet Project
* 'news(package="ergm")' for changes since last version
* 'citation("ergm")' for citation information
* 'https://statnet.org' for help, support, and other information

'ergm' 4 is a major update that introduces some backwards-incompatible
changes. Please type 'news(package="ergm")' for a list of major
changes.


'latentnet' 2.10.6 (2022-05-11), part of the Statnet Project
* 'news(package="latentnet")' for changes since last version
* 'citation("latentnet")' for citation information
* 'https://statnet.org' for help, support, and other information
NOTE: BIC calculation prior to latentnet 2.7.0 had a bug in the calculation of the effective number of parameters. See help(summary.ergmm) for details.
NOTE: Prior to version 2.8.0, handling of fixed effects for directed networks had a bug. See help("ergmm-terms") for details.
> 
> data(sampson)
> 
> monks.nf<-ergmm(samplike~euclidean(d=2)+rreceiver-1)
> mcmc.diagnostics(monks.nf)
Chain 1 
Lag 0 
                  lpY       Z.1.1       Z.1.2 receiver.1
lpY         1.0000000 -0.17244810  0.10925282  0.5491131
Z.1.1      -0.1724481  1.00000000 -0.01875322 -0.2692550
Z.1.2       0.1092528 -0.01875322  1.00000000  0.2119505
receiver.1  0.5491131 -0.26925502  0.21195054  1.0000000

Lag 10 
                  lpY       Z.1.1       Z.1.2 receiver.1
lpY         0.6046851 -0.14628282  0.09792786  0.4662383
Z.1.1      -0.1609460  0.42009614 -0.03429345 -0.1794167
Z.1.2       0.0843620 -0.01392527  0.42189323  0.1164259
receiver.1  0.4639112 -0.17621913  0.13290118  0.5306179

[[1]]

Quantile (q) = 0.025
Accuracy (r) = +/- 0.0125
Probability (s) = 0.95 
                                                  
            Burn-in  Total Lower bound  Dependence
            (M)      (N)   (Nmin)       factor (I)
 lpY        80       16440 600          27.4      
 Z.1.1      40       7970  600          13.3      
 Z.1.2      40       8310  600          13.8      
 receiver.1 50       9440  600          15.7      


> plot(gof(monks.nf))
> predict(monks.nf)
           [,1]      [,2]       [,3]       [,4]      [,5]       [,6]      [,7]
 [1,] 0.8988418 0.7570868 0.18049500 0.17199832 0.3684792 0.07467310 0.5121387
 [2,] 0.7490825 0.8976938 0.16073339 0.09588350 0.2289867 0.03946643 0.5664024
 [3,] 0.5106570 0.4787046 0.63055157 0.09364716 0.2376753 0.03848788 0.2594374
 [4,] 0.3777461 0.2412818 0.05851721 0.74368315 0.6664967 0.29422795 0.1181949
 [5,] 0.4794140 0.3246887 0.09291261 0.52837602 0.8446400 0.24959526 0.1674866
 [6,] 0.3979297 0.2583216 0.06331833 0.54337023 0.6325782 0.49342882 0.1306912
 [7,] 0.7338164 0.7784346 0.16269001 0.11062505 0.2552383 0.04687000 0.7604104
 [8,] 0.5554047 0.4038923 0.08934709 0.46592053 0.6262453 0.23663472 0.2237249
 [9,] 0.4843206 0.3404116 0.07747778 0.45446701 0.6440051 0.24466159 0.1835461
[10,] 0.4708434 0.3243548 0.08606853 0.52545271 0.6571404 0.24439539 0.1686012
[11,] 0.5128016 0.3732199 0.07847507 0.48738466 0.6445330 0.21241719 0.1986293
[12,] 0.7319259 0.7741421 0.11255047 0.10408211 0.2342080 0.04414158 0.5409701
[13,] 0.4388663 0.3640831 0.34504194 0.14803148 0.3335106 0.06133754 0.1938211
[14,] 0.7502994 0.7378648 0.11383539 0.15446740 0.3126258 0.06383770 0.4597277
[15,] 0.7491937 0.7781758 0.12674015 0.12843098 0.2790191 0.05338519 0.5250039
[16,] 0.7223629 0.7220160 0.12696625 0.15113023 0.3104609 0.06503834 0.5400517
[17,] 0.4457178 0.4189378 0.44957186 0.08313748 0.2147217 0.03408262 0.2173408
[18,] 0.5033190 0.4690984 0.46458504 0.09648718 0.2453547 0.03972879 0.2569767
            [,8]       [,9]      [,10]      [,11]     [,12]     [,13]     [,14]
 [1,] 0.25744468 0.17414182 0.08827235 0.14786397 0.6002818 0.2436203 0.5361430
 [2,] 0.15472942 0.10150681 0.04802157 0.08744854 0.6453371 0.1867288 0.5134414
 [3,] 0.11597175 0.08236162 0.04866384 0.06091140 0.2438419 0.5042103 0.1835730
 [4,] 0.41019751 0.34847819 0.25562608 0.31002172 0.1509675 0.1687951 0.1643981
 [5,] 0.42134532 0.39264097 0.24479128 0.32319443 0.2028840 0.2471381 0.2127055
 [6,] 0.41692909 0.37230364 0.22486049 0.26544922 0.1657946 0.1751222 0.1737578
 [7,] 0.17671720 0.11854333 0.05583379 0.09822105 0.6249867 0.2059831 0.4587858
 [8,] 0.69906611 0.43584248 0.26795079 0.29900890 0.2752577 0.2076084 0.2795214
 [9,] 0.48993755 0.64849769 0.24579091 0.26649636 0.2297756 0.1948139 0.2294824
[10,] 0.48872779 0.40463648 0.46099337 0.28471719 0.2062958 0.2242935 0.2174801
[11,] 0.42371564 0.33396826 0.20838791 0.56926284 0.2584633 0.1851997 0.2850598
[12,] 0.16615038 0.11283073 0.05107039 0.09976681 0.8172615 0.1427526 0.5405656
[13,] 0.15259586 0.11984148 0.07588053 0.08418933 0.1789074 0.7708970 0.1470097
[14,] 0.22423108 0.15267601 0.07442829 0.15032571 0.6248984 0.1564871 0.7592452
[15,] 0.19556774 0.13244947 0.06206620 0.11905290 0.6404509 0.1651485 0.5717767
[16,] 0.22485729 0.16100293 0.07356403 0.13869236 0.5939537 0.1789199 0.4740462
[17,] 0.09951805 0.07256178 0.04329388 0.05222431 0.2001669 0.5062915 0.1490827
[18,] 0.11868770 0.08565153 0.05035553 0.06304973 0.2372206 0.5384647 0.1784607
           [,15]      [,16]      [,17]      [,18]
 [1,] 0.30779210 0.29327159 0.10677106 0.16645631
 [2,] 0.34015806 0.29152967 0.09677856 0.14726060
 [3,] 0.09454738 0.09848527 0.36303842 0.44773644
 [4,] 0.05960249 0.07509368 0.03791168 0.05682184
 [5,] 0.08381374 0.10118262 0.06089023 0.09142554
 [6,] 0.06586330 0.08317625 0.04157620 0.06197267
 [7,] 0.30315913 0.32996324 0.09978852 0.15495035
 [8,] 0.11493709 0.14173350 0.05657300 0.08702734
 [9,] 0.09280089 0.12002761 0.04976370 0.07637063
[10,] 0.08381479 0.10356316 0.05680345 0.08511152
[11,] 0.10958371 0.13402146 0.04946066 0.07581781
[12,] 0.33107603 0.30326259 0.06673861 0.10379530
[13,] 0.06957725 0.07826349 0.27439263 0.36209939
[14,] 0.34563650 0.27429852 0.06666435 0.10450026
[15,] 0.54758229 0.31571898 0.07463314 0.11702826
[16,] 0.30272899 0.55959858 0.07679953 0.11952449
[17,] 0.07494344 0.07929326 0.53936683 0.43874866
[18,] 0.09113534 0.09693031 0.36845937 0.61422209
> simulate(monks.nf)
 Network attributes:
  vertices = 18 
  directed = TRUE 
  hyper = FALSE 
  loops = FALSE 
  multiple = FALSE 
  bipartite = FALSE 
  total edges= 115 
    missing edges= 0 
    non-missing edges= 115 

 Vertex attribute names: 
    vertex.names 

No edge attributes
> print(summary(monks.nf))
NOTE: It is not certain whether it is appropriate to use latentnet's BIC to select latent space dimension, whether or not to include actor-specific random effects, and to compare clustered models with the unclustered model.

==========================
Summary of model fit
==========================

Formula:   samplike ~ euclidean(d = 2) + rreceiver - 1
Attribute: edges
Model:     Bernoulli 
MCMC sample of size 4000, draws are 10 iterations apart, after burnin of 10000 iterations.
Receiver effect variance: 2.10973.
Overall BIC:        384.2944 
Likelihood BIC:     243.2364 
Latent space/clustering BIC:     99.42813 
Receiver effect BIC:     41.62985 

> 
> proc.time()
   user  system elapsed 
   5.93    0.31    6.26 
