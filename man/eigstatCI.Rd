% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/eigstatCI.R
\name{eigstatCI}
\alias{eigstatCI}
\alias{eigstatCI_boxM}
\title{Bootstrap Confidence Intervals for Eigenvalue Statistics}
\usage{
eigstatCI(
  Y,
  group,
  which = c("product", "sum", "precision", "max"),
  R = 1000,
  conf = 0.95,
  type = c("perc", "bca", "norm", "basic"),
  parallel = FALSE,
  ncpus = 2,
  seed = NULL,
  ...
)

eigstatCI_boxM(boxm, Y, group, ...)
}
\arguments{
\item{Y}{Original data matrix used in \code{boxM()}}

\item{group}{Original grouping variable used in \code{boxM()}}

\item{which}{The eigenvalue-based statistic to compute. One of:
\describe{
\item{product}{Product of eigenvalues (= determinant)}
\item{sum}{Sum of eigenvalues (= trace)}
\item{precision}{Harmonic mean of eigenvalues}
\item{max}{Maximum eigenvalue}
}}

\item{R}{Number of bootstrap replicates. Default is 1000.}

\item{conf}{Confidence level for intervals (0 < conf < 1). Default is 0.95.}

\item{type}{Type of bootstrap confidence interval. Options:
\describe{
\item{perc}{Percentile method (default, most robust)}
\item{bca}{Bias-corrected and accelerated}
\item{norm}{Normal approximation}
\item{basic}{Basic bootstrap}
}}

\item{parallel}{Logical or character string. If TRUE, use parallel processing
via the boot package. Can also be "multicore" or "snow". Default is FALSE.}

\item{ncpus}{Number of CPUs to use if parallel=TRUE. Default is 2.}

\item{seed}{Random seed for reproducibility. If NULL, no seed is set.}

\item{...}{Additional arguments passed to \code{eigstatCI()}}

\item{boxm}{A "boxM" object from \code{boxM()}}
}
\value{
A data frame with one row for each group plus the pooled data.
Columns include:
\describe{
\item{group}{Group name (factor level)}
\item{statistic}{Observed value of the statistic}
\item{lower}{Lower confidence limit}
\item{upper}{Upper confidence limit}
\item{bias}{Bootstrap estimate of bias (if available)}
\item{se}{Bootstrap standard error (if available)}
}

A data frame with bootstrap confidence intervals
}
\description{
Computes bootstrap confidence intervals for statistics based on eigenvalues
of grouped covariance matrices. This is intended for use with \code{plot.boxM()}
to provide confidence intervals for measures beyond the default "logDet".

This is a convenience wrapper that extracts the necessary information
from a boxM object, but still requires the original data and grouping
variable since these are not stored in the boxM object.
}
\details{
For each group (and the pooled data), this function performs nonparametric
bootstrap resampling to estimate the sampling distribution of the specified
eigenvalue-based statistic. Confidence intervals are computed using the
percentile method or bias-corrected and accelerated (BCa) method.

Unlike \code{logdetCI()} which uses analytic approximations based on asymptotic
theory, this function makes no distributional assumptions and can handle
small to moderate sample sizes, though computational cost increases with
the number of bootstrap replicates.
}
\examples{
\dontrun{
library(boot)
data(iris)

# Bootstrap CI for product of eigenvalues
CI_prod <- eigstatCI(iris[,1:4], iris$Species, which="product", R=500)
CI_prod

# Bootstrap CI for sum of eigenvalues (= trace)
CI_sum <- eigstatCI(iris[,1:4], iris$Species, which="sum", R=500)
CI_sum

# Use with parallel processing for speed
CI_max <- eigstatCI(iris[,1:4], iris$Species, which="max",
                    R=1000, parallel=TRUE, ncpus=4)
}

\dontrun{
library(boot)
data(iris)

# Fit boxM
res <- boxM(iris[,1:4], iris$Species)

# Get bootstrap CIs (must provide original data again)
CI <- eigstatCI_boxM(res, Y = iris[,1:4], group = iris$Species,
                     which = "sum", R = 500)
}

}
\references{
Efron, B., & Tibshirani, R. J. (1994).
\emph{An Introduction to the Bootstrap}. CRC Press.
}
\seealso{
\code{\link{boxM}}, \code{\link{plot.boxM}}, \code{\link{logdetCI}}

Other diagnostic plots: 
\code{\link{cqplot}()},
\code{\link{distancePlot}()},
\code{\link{plot.boxM}()}
}
\author{
Michael Friendly
}
\concept{diagnostic plots}
